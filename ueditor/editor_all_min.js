(function(){UEDITOR_CONFIG=window.UEDITOR_CONFIG||{};var c=window.baidu||{};window.baidu=c;window.UE=c.editor={};UE.plugins={};UE.commands={};UE.version="1.2.0.0";var g=UE.dom={};var i=UE.browser=function(){var t=navigator.userAgent.toLowerCase(),r=window.opera,s={ie:!!window.ActiveXObject,opera:(!!r&&r.version),webkit:(t.indexOf(" applewebkit/")>-1),mac:(t.indexOf("macintosh")>-1),quirks:(document.compatMode=="BackCompat")};s.gecko=(navigator.product=="Gecko"&&!s.webkit&&!s.opera);var q=0;if(s.ie){q=parseFloat(t.match(/msie (\d+)/)[1]);s.ie8=!!document.documentMode;s.ie8Compat=document.documentMode==8;s.ie7Compat=((q==7&&!document.documentMode)||document.documentMode==7);s.ie6Compat=(q<7||s.quirks)}if(s.gecko){var u=t.match(/rv:([\d\.]+)/);if(u){u=u[1].split(".");q=u[0]*10000+(u[1]||0)*100+(u[2]||0)*1}}if(/chrome\/(\d+\.\d)/i.test(t)){s.chrome=+RegExp["\x241"]}if(/(\d+\.\d)?(?:\.\d)?\s+safari\/?(\d+\.\d+)?/i.test(t)&&!/chrome/i.test(t)){s.safari=+(RegExp["\x241"]||RegExp["\x242"])}if(s.opera){q=parseFloat(r.version())}if(s.webkit){q=parseFloat(t.match(/ applewebkit\/(\d+)/)[1])}s.version=q;s.isCompatible=!s.mobile&&((s.ie&&q>=6)||(s.gecko&&q>=10801)||(s.opera&&q>=9.5)||(s.air&&q>=1)||(s.webkit&&q>=522)||false);return s}();var b=i.ie,m=i.webkit,d=i.gecko;var n=UE.utils={makeInstance:function(r){var q=new Function();q.prototype=r;r=new q;q.prototype=null;return r},extend:function(u,v,q){if(v){for(var r in v){if(!q||!u.hasOwnProperty(r)){u[r]=v[r]}}}return u},isArray:function(q){return Object.prototype.toString.apply(q)==="[object Array]"},isString:function(q){return typeof q=="string"||q.constructor==String},inherits:function(t,r){var q=t.prototype,s=n.makeInstance(r.prototype);n.extend(s,q,true);t.prototype=s;return(s.constructor=t)},bind:function(q,r){return function(){return q.apply(r,arguments)}},defer:function(r,q,s){var t;return function(){if(s){clearTimeout(t)}t=setTimeout(r,q)}},indexOf:function(u,t,q){for(var s=q||0,r=u.length;s<r;s++){if(u[s]===t){return s}}return -1},findNode:function(r,q,u){for(var t=0,s;s=r[t++];){if(u?u(s):this.indexOf(q,s.tagName.toLowerCase())!=-1){return s}}},removeItem:function(t,s){for(var r=0,q=t.length;r<q;r++){if(t[r]===s){t.splice(r,1);r--}}},trim:function(q){return q.replace(/(^[ \t\n\r]+)|([ \t\n\r]+$)/g,"")},listToMap:function(s){if(!s){return{}}s=n.isArray(s)?s:s.split(",");for(var r=0,q,t={};q=s[r++];){t[q.toUpperCase()]=t[q]=1}return t},unhtml:function(q){return q?q.replace(/[&<">]/g,function(r){return{"<":"&lt;","&":"&amp",'"':"&quot;",">":"&gt;"}[r]}):""},cssStyleToDomStyle:function(){var r=document.createElement("div").style,q={"float":r.cssFloat!=undefined?"cssFloat":r.styleFloat!=undefined?"styleFloat":"float"};return function(s){return q[s]||(q[s]=s.toLowerCase().replace(/-./g,function(t){return t.charAt(1).toUpperCase()}))}}(),loadFile:function(u,t,q){if(t.id&&u.getElementById(t.id)){return}var r=u.createElement(t.tag);delete t.tag;for(var s in t){r.setAttribute(s,t[s])}r.onload=r.onreadystatechange=function(){if(!this.readyState||/loaded|complete/.test(this.readyState)){q&&q();r.onload=r.onreadystatechange=null}};u.getElementsByTagName("head")[0].appendChild(r)},isEmptyObject:function(r){for(var q in r){return false}return true},fixColor:function(r,t){if(/color/i.test(r)&&/rgba?/.test(t)){var u=t.split(",");if(u.length>3){return""}t="#";for(var s=0,q;q=u[s++];){q=parseInt(q.replace(/[^\d]/gi,""),10).toString(16);t+=q.length==1?"0"+q:q}t=t.toUpperCase()}return t},optCss:function(u){var t,s,q;u=u.replace(/(padding|margin|border)\-([^:]+):([^;]+);?/gi,function(y,w,v,x){if(x.split(" ").length==1){switch(w){case"padding":!t&&(t={});t[v]=x;return"";case"margin":!s&&(s={});s[v]=x;return"";case"border":return x=="initial"?"":y}}return y});function r(B,x){if(!B){return""}var y=B.top,v=B.bottom,w=B.left,z=B.right,C="";if(!y||!w||!v||!z){for(var A in B){C+=";"+x+"-"+A+":"+B[A]+";"}}else{C+=";"+x+":"+(y==v&&v==w&&w==z?y:y==v&&w==z?(y+" "+w):w==z?(y+" "+w+" "+v):(y+" "+z+" "+v+" "+w))+";"}return C}u+=r(t,"padding")+r(s,"margin");return u.replace(/^[ \n\r\t;]*|[ \n\r\t]*$/,"").replace(/;([ \n\r\t]+)|\1;/g,";").replace(/(&((l|g)t|quot|#39))?;{2,}/g,function(w,v){return v?v+";;":";"})}};var h=UE.EventBase=function(){};h.prototype={addListener:function(q,r){k(this,q,true).push(r)},removeListener:function(r,s){var q=k(this,r);q&&n.removeItem(q,s)},fireEvent:function(v){var u=k(this,v),w,s,q;if(u){q=u.length;while(q--){s=u[q].apply(this,arguments);if(s!==undefined){w=s}}}if(s=this["on"+v.toLowerCase()]){w=s.apply(this,arguments)}return w}};function k(t,r,s){var q;r=r.toLowerCase();return((q=(t.__allListeners||s&&(t.__allListeners={})))&&(q[r]||s&&(q[r]=[])))}var a=g.dtd=(function(){function am(B){for(var A in B){B[A.toUpperCase()]=B[A]}return B}function q(E){var B=arguments;for(var D=1;D<B.length;D++){var A=B[D];for(var C in A){if(!E.hasOwnProperty(C)){E[C]=A[C]}}}return E}var al=am({isindex:1,fieldset:1}),ak=am({input:1,button:1,select:1,textarea:1,label:1}),aj=q(am({a:1}),ak),ai=q({iframe:1},aj),ah=am({hr:1,ul:1,menu:1,div:1,blockquote:1,noscript:1,table:1,center:1,address:1,dir:1,pre:1,h5:1,dl:1,h4:1,noframes:1,h6:1,ol:1,h1:1,h3:1,h2:1}),ag=am({ins:1,del:1,script:1,style:1}),af=q(am({b:1,acronym:1,bdo:1,"var":1,"#":1,abbr:1,code:1,br:1,i:1,cite:1,kbd:1,u:1,strike:1,s:1,tt:1,strong:1,q:1,samp:1,em:1,dfn:1,span:1}),ag),ae=q(am({sub:1,img:1,embed:1,object:1,sup:1,basefont:1,map:1,applet:1,font:1,big:1,small:1}),af),ad=q(am({p:1}),ae),ac=q(am({iframe:1}),ae,ak),aa=am({img:1,embed:1,noscript:1,br:1,kbd:1,center:1,button:1,basefont:1,h5:1,h4:1,samp:1,h6:1,ol:1,h1:1,h3:1,h2:1,form:1,font:1,"#":1,select:1,menu:1,ins:1,abbr:1,label:1,code:1,table:1,script:1,cite:1,input:1,iframe:1,strong:1,textarea:1,noframes:1,big:1,small:1,span:1,hr:1,sub:1,bdo:1,"var":1,div:1,object:1,sup:1,strike:1,dir:1,map:1,dl:1,applet:1,del:1,isindex:1,fieldset:1,ul:1,b:1,acronym:1,a:1,blockquote:1,i:1,u:1,s:1,tt:1,address:1,q:1,pre:1,p:1,em:1,dfn:1}),Z=q(am({a:0}),ac),W=am({tr:1}),z=am({"#":1}),y=q(am({param:1}),aa),x=q(am({form:1}),al,ai,ah,ad),w=am({li:1}),v=am({style:1,script:1}),u=am({base:1,link:1,meta:1,title:1}),t=q(u,v),s=am({head:1,body:1}),r=am({html:1});var Y=am({address:1,blockquote:1,center:1,dir:1,div:1,dl:1,fieldset:1,form:1,h1:1,h2:1,h3:1,h4:1,h5:1,h6:1,hr:1,isindex:1,menu:1,noframes:1,ol:1,p:1,pre:1,table:1,ul:1}),ab=am({area:1,base:1,br:1,col:1,hr:1,img:1,input:1,link:1,meta:1,param:1,embed:1});return am({$nonBodyContent:q(r,s,u),$block:Y,$inline:Z,$body:q(am({script:1,style:1}),Y),$cdata:am({script:1,style:1}),$empty:ab,$nonChild:am({iframe:1}),$listItem:am({dd:1,dt:1,li:1}),$list:am({ul:1,ol:1,dl:1}),$isNotEmpty:am({table:1,ul:1,ol:1,dl:1,iframe:1,area:1,base:1,col:1,hr:1,img:1,embed:1,input:1,link:1,meta:1,param:1}),$removeEmpty:am({a:1,abbr:1,acronym:1,address:1,b:1,bdo:1,big:1,cite:1,code:1,del:1,dfn:1,em:1,font:1,i:1,ins:1,label:1,kbd:1,q:1,s:1,samp:1,small:1,span:1,strike:1,strong:1,sub:1,sup:1,tt:1,u:1,"var":1}),$removeEmptyBlock:am({p:1,div:1}),$tableContent:am({caption:1,col:1,colgroup:1,tbody:1,td:1,tfoot:1,th:1,thead:1,tr:1,table:1}),$notTransContent:am({pre:1,script:1,style:1,textarea:1}),html:s,head:t,style:z,script:z,body:x,base:{},link:{},meta:{},title:z,col:{},tr:am({td:1,th:1}),img:{},embed:{},colgroup:am({thead:1,col:1,tbody:1,tr:1,tfoot:1}),noscript:x,td:x,br:{},th:x,center:x,kbd:Z,button:q(ad,ah),basefont:{},h5:Z,h4:Z,samp:Z,h6:Z,ol:w,h1:Z,h3:Z,option:z,h2:Z,form:q(al,ai,ah,ad),select:am({optgroup:1,option:1}),font:Z,ins:Z,menu:w,abbr:Z,label:Z,table:am({thead:1,col:1,tbody:1,tr:1,colgroup:1,caption:1,tfoot:1}),code:Z,tfoot:W,cite:Z,li:x,input:{},iframe:x,strong:Z,textarea:z,noframes:x,big:Z,small:Z,span:am({"#":1,br:1}),hr:Z,dt:Z,sub:Z,optgroup:am({option:1}),param:{},bdo:Z,"var":Z,div:x,object:y,sup:Z,dd:x,strike:Z,area:{},dir:w,map:q(am({area:1,form:1,p:1}),al,ag,ah),applet:y,dl:am({dt:1,dd:1}),del:Z,isindex:{},fieldset:q(am({legend:1}),aa),thead:W,ul:w,acronym:Z,b:Z,a:q(am({a:1}),ac),blockquote:q(am({td:1,tr:1,tbody:1,li:1}),x),caption:Z,i:Z,u:Z,tbody:W,s:Z,address:q(ai,ad),tt:Z,legend:Z,q:Z,pre:q(af,aj),p:q(am({a:1}),Z),em:Z,dfn:Z})})();function f(w,x,r,q,u,v){var t=q&&w[x],s;!t&&(t=w[r]);while(!t&&(s=(s||w).parentNode)){if(s.tagName=="BODY"||v&&!v(s)){return null}t=s[r]}if(t&&u&&!u(t)){return f(t,x,r,false,u)}return t}var l=b&&i.version<9?{tabindex:"tabIndex",readonly:"readOnly","for":"htmlFor","class":"className",maxlength:"maxLength",cellspacing:"cellSpacing",cellpadding:"cellPadding",rowspan:"rowSpan",colspan:"colSpan",usemap:"useMap",frameborder:"frameBorder"}:{tabindex:"tabIndex",readonly:"readOnly"},j=n.listToMap(["-webkit-box","-moz-box","block","list-item","table","table-row-group","table-header-group","table-footer-group","table-row","table-column-group","table-column","table-cell","table-caption"]);var e=g.domUtils={NODE_ELEMENT:1,NODE_DOCUMENT:9,NODE_TEXT:3,NODE_COMMENT:8,NODE_DOCUMENT_FRAGMENT:11,POSITION_IDENTICAL:0,POSITION_DISCONNECTED:1,POSITION_FOLLOWING:2,POSITION_PRECEDING:4,POSITION_IS_CONTAINED:8,POSITION_CONTAINS:16,fillChar:b&&i.version=="6"?"\ufeff":"\u200B",keys:{8:1,46:1,16:1,17:1,18:1,37:1,38:1,39:1,40:1,13:1},getPosition:function(v,t){if(v===t){return 0}var r,u=[v],s=[t];r=v;while(r=r.parentNode){if(r===t){return 10}u.push(r)}r=t;while(r=r.parentNode){if(r===v){return 20}s.push(r)}u.reverse();s.reverse();if(u[0]!==s[0]){return 1}var q=-1;while(q++,u[q]===s[q]){}v=u[q];t=s[q];while(v=v.nextSibling){if(v===t){return 4}}return 2},getNodeIndex:function(r){var s=r.parentNode.firstChild,q=0;while(r!==s){q++;s=s.nextSibling}return q},inDoc:function(q,r){while(q=q.parentNode){if(q===r){return true}}return false},findParent:function(s,q,r){if(!e.isBody(s)){s=r?s:s.parentNode;while(s){if(!q||q(s)||this.isBody(s)){return q&&!q(s)&&this.isBody(s)?null:s}s=s.parentNode}}return null},findParentByTagName:function(s,r,q,t){if(s&&s.nodeType&&!this.isBody(s)&&(s.nodeType==1||s.nodeType)){r=n.listToMap(n.isArray(r)?r:[r]);s=s.nodeType==3||!q?s.parentNode:s;while(s&&s.tagName&&s.nodeType!=9){if(t&&t(s)){break}if(r[s.tagName]){return s}s=s.parentNode}}return null},findParents:function(u,t,q,s){var r=t&&(q&&q(u)||!q)?[u]:[];while(u=e.findParent(u,q)){r.push(u)}return s?r:r.reverse()},insertAfter:function(r,q){return r.parentNode.insertBefore(q,r.nextSibling)},remove:function(r,s){var q=r.parentNode,t;if(q){if(s&&r.hasChildNodes()){while(t=r.firstChild){q.insertBefore(t,r)}}q.removeChild(r)}return r},getNextDomNode:function(t,q,r,s){return f(t,"firstChild","nextSibling",q,r,s)},isBookmarkNode:function(q){return q.nodeType==1&&q.id&&/^_baidu_bookmark_/i.test(q.id)},getWindow:function(q){var r=q.ownerDocument||q;return r.defaultView||r.parentWindow},getCommonAncestor:function(v,t){if(v===t){return v}var u=[v],s=[t],r=v,q=-1;while(r=r.parentNode){if(r===t){return r}u.push(r)}r=t;while(r=r.parentNode){if(r===v){return r}s.push(r)}u.reverse();s.reverse();while(q++,u[q]===s[q]){}return q==0?null:u[q-1]},clearEmptySibling:function(t,r,s){function q(w,u){var v;while(w&&!e.isBookmarkNode(w)&&(e.isEmptyInlineElement(w)||e.isWhitespace(w))){v=w[u];e.remove(w);w=v}}!r&&q(t.nextSibling,"nextSibling");!s&&q(t.previousSibling,"previousSibling")},split:function(t,v){var u=t.ownerDocument;if(i.ie&&v==t.nodeValue.length){var s=u.createTextNode("");return e.insertAfter(t,s)}var q=t.splitText(v);if(i.ie8){var r=u.createTextNode("");e.insertAfter(q,r);e.remove(r)}return q},isWhitespace:function(q){return !new RegExp("[^ \t\n\r"+e.fillChar+"]").test(q.nodeValue)},getXY:function(r){var q=0,s=0;while(r.offsetParent){s+=r.offsetTop;q+=r.offsetLeft;r=r.offsetParent}return{x:q,y:s}},on:function(v,u,t){var s=u instanceof Array?u:[u],q=s.length;if(q){while(q--){u=s[q];if(v.addEventListener){v.addEventListener(u,t,false)}else{if(!t._d){t._d={}}var r=u+t.toString();if(!t._d[r]){t._d[r]=function(w){return t.call(w.srcElement,w||window.event)};v.attachEvent("on"+u,t._d[r])}}}}v=null},un:function(v,u,t){var s=u instanceof Array?u:[u],q=s.length;if(q){while(q--){u=s[q];if(v.removeEventListener){v.removeEventListener(u,t,false)}else{var r=u+t.toString();v.detachEvent("on"+u,t._d?t._d[r]:t);if(t._d&&t._d[r]){delete t._d[r]}}}}},isSameElement:function(t,s){if(t.tagName!=s.tagName){return 0}var x=t.attributes,w=s.attributes;if(!b&&x.length!=w.length){return 0}var q,y,v=0,r=0;for(var u=0;q=x[u++];){if(q.nodeName=="style"){if(q.specified){v++}if(e.isSameStyle(t,s)){continue}else{return 0}}if(b){if(q.specified){v++;y=w.getNamedItem(q.nodeName)}else{continue}}else{y=s.attributes[q.nodeName]}if(!y.specified){return 0}if(q.nodeValue!=y.nodeValue){return 0}}if(b){for(u=0;y=w[u++];){if(y.specified){r++}}if(v!=r){return 0}}return 1},isSameStyle:function(t,s){var r=t.style.cssText.replace(/( ?; ?)/g,";").replace(/( ?: ?)/g,":"),q=s.style.cssText.replace(/( ?; ?)/g,";").replace(/( ?: ?)/g,":");if(!r||!q){return r==q?1:0}r=r.split(";");q=q.split(";");if(r.length!=q.length){return 0}for(var v=0,u;u=r[v++];){if(n.indexOf(q,u)==-1){return 0}}return 1},isBlockElm:function(q){return q.nodeType==1&&(a.$block[q.tagName]||j[e.getComputedStyle(q,"display")])&&!a.$nonChild[q.tagName]},isBody:function(q){return q&&q.nodeType==1&&q.tagName.toLowerCase()=="body"},breakParent:function(u,s){var r,w=u,v=u,q,t;do{w=w.parentNode;if(q){r=w.cloneNode(false);r.appendChild(q);q=r;r=w.cloneNode(false);r.appendChild(t);t=r}else{q=w.cloneNode(false);t=q.cloneNode(false)}while(r=v.previousSibling){q.insertBefore(r,q.firstChild)}while(r=v.nextSibling){t.appendChild(r)}v=w}while(s!==w);r=s.parentNode;r.insertBefore(q,s);r.insertBefore(t,s);r.insertBefore(u,t);e.remove(s);return u},isEmptyInlineElement:function(q){if(q.nodeType!=1||!a.$removeEmpty[q.tagName]){return 0}q=q.firstChild;while(q){if(e.isBookmarkNode(q)){return 0}if(q.nodeType==1&&!e.isEmptyInlineElement(q)||q.nodeType==3&&!e.isWhitespace(q)){return 0}q=q.nextSibling}return 1},trimWhiteTextNode:function(r){function q(s){var t;while((t=r[s])&&t.nodeType==3&&e.isWhitespace(t)){r.removeChild(t)}}q("firstChild");q("lastChild")},mergChild:function(u,r,z){var x=e.getElementsByTagName(u,u.tagName.toLowerCase());for(var w=0,B;B=x[w++];){if(!B.parentNode||e.isBookmarkNode(B)){continue}if(B.tagName.toLowerCase()=="span"){if(u===B.parentNode){e.trimWhiteTextNode(u);if(u.childNodes.length==1){u.style.cssText=B.style.cssText+";"+u.style.cssText;e.remove(B,true);continue}}B.style.cssText=u.style.cssText+";"+B.style.cssText;if(z){var q=z.style;if(q){q=q.split(";");for(var v=0,A;A=q[v++];){B.style[n.cssStyleToDomStyle(A.split(":")[0])]=A.split(":")[1]}}}if(e.isSameStyle(B,u)){e.remove(B,true)}continue}if(e.isSameElement(u,B)){e.remove(B,true)}}if(r=="span"){var t=e.getElementsByTagName(u,"a");for(var w=0,y;y=t[w++];){y.style.cssText=";"+u.style.cssText;y.style.textDecoration="underline"}}},getElementsByTagName:function(u,r){var v=u.getElementsByTagName(r),q=[];for(var t=0,s;s=v[t++];){q.push(s)}return q},mergToParent:function(r){var q=r.parentNode;while(q&&a.$removeEmpty[q.tagName]){if(q.tagName==r.tagName||q.tagName=="A"){e.trimWhiteTextNode(q);if(q.tagName=="SPAN"&&!e.isSameStyle(q,r)||(q.tagName=="A"&&r.tagName=="SPAN")){if(q.childNodes.length>1||q!==r.parentNode){r.style.cssText=q.style.cssText+";"+r.style.cssText;q=q.parentNode;continue}else{q.style.cssText+=";"+r.style.cssText;if(q.tagName=="A"){q.style.textDecoration="underline"}}}if(q.tagName!="A"){q===r.parentNode&&e.remove(r,true);break}}q=q.parentNode}},mergSibling:function(s,r,q){function t(w,x,v){var u;if((u=v[w])&&!e.isBookmarkNode(u)&&u.nodeType==1&&e.isSameElement(v,u)){while(u.firstChild){if(x=="firstChild"){v.insertBefore(u.lastChild,v.firstChild)}else{v.appendChild(u.firstChild)}}e.remove(u)}}!r&&t("previousSibling","firstChild",s);!q&&t("nextSibling","lastChild",s)},unselectable:d?function(q){q.style.MozUserSelect="none"}:m?function(q){q.style.KhtmlUserSelect="none"}:function(s){s.onselectstart=function(){return false};s.onclick=s.onkeyup=s.onkeydown=function(){return false};s.unselectable="on";s.setAttribute("unselectable","on");for(var r=0,q;q=s.all[r++];){switch(q.tagName.toLowerCase()){case"iframe":case"textarea":case"input":case"select":break;default:q.unselectable="on";s.setAttribute("unselectable","on")}}},removeAttributes:function(t,s){for(var r=0,q;q=s[r++];){q=l[q]||q;switch(q){case"className":t[q]="";break;case"style":t.style.cssText="";!i.ie&&t.removeAttributeNode(t.getAttributeNode("style"))}t.removeAttribute(q)}},setAttributes:function(s,r){for(var q in r){var t=r[q];switch(q){case"class":s.className=t;break;case"style":s.style.cssText=s.style.cssText+";"+t;break;case"innerHTML":s[q]=t;break;case"value":s.value=t;break;default:s.setAttribute(l[q]||q,t)}}return s},getComputedStyle:function(s,r){function u(x,y){if(x=="font-size"&&/pt$/.test(y)){y=Math.round(parseFloat(y)/0.75)+"px"}return y}if(s.nodeType==3){s=s.parentNode}if(i.ie&&i.version<9&&r=="font-size"&&!s.style.fontSize&&!a.$empty[s.tagName]&&!a.$nonChild[s.tagName]){var t=s.ownerDocument.createElement("span");t.style.cssText="padding:0;border:0;font-family:simsun;";t.innerHTML=".";s.appendChild(t);var q=t.offsetHeight;s.removeChild(t);t=null;return q+"px"}try{var v=e.getStyle(s,r)||(window.getComputedStyle?e.getWindow(s).getComputedStyle(s,"").getPropertyValue(r):(s.currentStyle||s.style)[n.cssStyleToDomStyle(r)])}catch(w){return null}return u(r,n.fixColor(r,v))},removeClasses:function(q,r){q.className=(" "+q.className+" ").replace(new RegExp("(?:\\s+(?:"+r.join("|")+"))+\\s+","g")," ")},removeStyle:function(r,q){r.style[n.cssStyleToDomStyle(q)]="";if(!r.style.cssText){e.removeAttributes(r,["style"])}},hasClass:function(q,r){return(" "+q.className+" ").indexOf(" "+r+" ")>-1},preventDefault:function(q){q.preventDefault?q.preventDefault():(q.returnValue=false)},getStyle:function(r,q){var s=r.style[n.cssStyleToDomStyle(q)];return n.fixColor(q,s)},setStyle:function(r,q,s){r.style[n.cssStyleToDomStyle(q)]=s},setStyles:function(r,s){for(var q in s){if(s.hasOwnProperty(q)){e.setStyle(r,q,s[q])}}},removeDirtyAttr:function(t){for(var s=0,r,q=t.getElementsByTagName("*");r=q[s++];){r.removeAttribute("_moz_dirty")}t.removeAttribute("_moz_dirty")},getChildCount:function(s,q){var r=0,t=s.firstChild;q=q||function(){return 1};while(t){if(q(t)){r++}t=t.nextSibling}return r},isEmptyNode:function(q){return !q.firstChild||e.getChildCount(q,function(r){return !e.isBr(r)&&!e.isBookmarkNode(r)&&!e.isWhitespace(r)})==0},clearSelectedArr:function(q){var r;while(r=q.pop()){e.removeAttributes(r,["class"])}},scrollToView:function(s,y,q){var r=function(){var z=y.document,A=z.compatMode=="CSS1Compat";return{width:(A?z.documentElement.clientWidth:z.body.clientWidth)||0,height:(A?z.documentElement.clientHeight:z.body.clientHeight)||0}},x=function(A){if("pageXOffset" in A){return{x:A.pageXOffset||0,y:A.pageYOffset||0}}else{var z=A.document;return{x:z.documentElement.scrollLeft||z.body.scrollLeft||0,y:z.documentElement.scrollTop||z.body.scrollTop||0}}};var v=r().height,w=v*-1+q;w+=(s.offsetHeight||0);var t=e.getXY(s);w+=t.y;var u=x(y).y;if(w>u||w<u-v){y.scrollTo(0,w+(w<0?-20:20))}},isBr:function(q){return q.nodeType==1&&q.tagName=="BR"},isFillChar:function(q){return q.nodeType==3&&!q.nodeValue.replace(new RegExp(e.fillChar),"").length},isStartInblock:function(r){var v=r.cloneRange(),q=0,w=v.startContainer,s;while(w&&e.isFillChar(w)){s=w;w=w.previousSibling}if(s){v.setStartBefore(s);w=v.startContainer}if(w.nodeType==1&&e.isEmptyNode(w)&&v.startOffset==1){v.setStart(w,0).collapse(true)}while(!v.startOffset){w=v.startContainer;if(e.isBlockElm(w)||e.isBody(w)){q=1;break}var u=v.startContainer.previousSibling,t;if(!u){v.setStartBefore(v.startContainer)}else{while(u&&e.isFillChar(u)){t=u;u=u.previousSibling}if(t){v.setStartBefore(t)}else{v.setStartBefore(v.startContainer)}}}return q&&!e.isBody(v.startContainer)?1:0},isEmptyBlock:function(r){var q=new RegExp("[ \t\r\n"+e.fillChar+"]","g");if(r[i.ie?"innerText":"textContent"].replace(q,"").length>0){return 0}for(var s in a.$isNotEmpty){if(r.getElementsByTagName(s).length){return 0}}return 1},setViewportOffset:function(q,w){var v=parseInt(q.style.left)|0;var u=parseInt(q.style.top)|0;var s=q.getBoundingClientRect();var t=w.left-s.left;var r=w.top-s.top;if(t){q.style.left=v+t+"px"}if(r){q.style.top=u+r+"px"}},fillNode:function(s,r){var q=i.ie?s.createTextNode(e.fillChar):s.createElement("br");r.innerHTML="";r.appendChild(q)},moveChild:function(s,q,r){while(s.firstChild){if(r&&q.firstChild){q.insertBefore(s.lastChild,q.firstChild)}else{q.appendChild(s.firstChild)}}},hasNoAttributes:function(q){return i.ie?/^<\w+\s*?>/.test(q.outerHTML):q.attributes.length==0}};var o=new RegExp(e.fillChar,"g");(function(){var w=0,x=e.fillChar,s;function r(z){z.collapsed=z.startContainer&&z.endContainer&&z.startContainer===z.endContainer&&z.startOffset==z.endOffset}function q(A,B,C,z){if(B.nodeType==1&&(a.$empty[B.tagName]||a.$nonChild[B.tagName])){C=e.getNodeIndex(B)+(A?0:1);B=B.parentNode}if(A){z.startContainer=B;z.startOffset=C;if(!z.endContainer){z.collapse(true)}}else{z.endContainer=B;z.endOffset=C;if(!z.startContainer){z.collapse(false)}}r(z);return z}function y(F,J){var D=F.startContainer,C=F.endContainer,L=F.startOffset,E=F.endOffset,R=F.document,z=R.createDocumentFragment(),G,I;if(D.nodeType==1){D=D.childNodes[L]||(G=D.appendChild(R.createTextNode("")))}if(C.nodeType==1){C=C.childNodes[E]||(I=C.appendChild(R.createTextNode("")))}if(D===C&&D.nodeType==3){z.appendChild(R.createTextNode(D.substringData(L,E-L)));if(J){D.deleteData(L,E-L);F.collapse(true)}return z}var H,N,P=z,O=e.findParents(D,true),A=e.findParents(C,true);for(var M=0;O[M]==A[M];M++){}for(var K=M,Q;Q=O[K];K++){H=Q.nextSibling;if(Q==D){if(!G){if(F.startContainer.nodeType==3){P.appendChild(R.createTextNode(D.nodeValue.slice(L)));if(J){D.deleteData(L,D.nodeValue.length-L)}}else{P.appendChild(!J?D.cloneNode(true):D)}}}else{N=Q.cloneNode(false);P.appendChild(N)}while(H){if(H===C||H===A[K]){break}Q=H.nextSibling;P.appendChild(!J?H.cloneNode(true):H);H=Q}P=N}P=z;if(!O[M]){P.appendChild(O[M-1].cloneNode(false));P=P.firstChild}for(var K=M,B;B=A[K];K++){H=B.previousSibling;if(B==C){if(!I&&F.endContainer.nodeType==3){P.appendChild(R.createTextNode(C.substringData(0,E)));if(J){C.deleteData(0,E)}}}else{N=B.cloneNode(false);P.appendChild(N)}if(K!=M||!O[M]){while(H){if(H===D){break}B=H.previousSibling;P.insertBefore(!J?H.cloneNode(true):H,P.firstChild);H=B}}P=N}if(J){F.setStartBefore(!A[M]?A[M-1]:!O[M]?O[M-1]:A[M]).collapse(true)}G&&e.remove(G);I&&e.remove(I);return z}var t=g.Range=function(z){var A=this;A.startContainer=A.startOffset=A.endContainer=A.endOffset=null;A.document=z;A.collapsed=true};function v(C,z){try{if(s&&e.inDoc(s,C)){if(!s.nodeValue.replace(o,"").length){var A=s.parentNode;e.remove(s);while(A&&e.isEmptyInlineElement(A)&&!A.contains(z)){s=A.parentNode;e.remove(A);A=s}}else{s.nodeValue=s.nodeValue.replace(o,"")}}}catch(B){}}function u(B,z){var A;B=B[z];while(B&&e.isFillChar(B)){A=B[z];e.remove(B);B=A}}t.prototype={cloneContents:function(){return this.collapsed?null:y(this,0)},deleteContents:function(){if(!this.collapsed){y(this,1)}if(i.webkit){var z=this.startContainer;if(z.nodeType==3&&!z.nodeValue.length){this.setStartBefore(z).collapse(true);e.remove(z)}}return this},extractContents:function(){return this.collapsed?null:y(this,2)},setStart:function(z,A){return q(true,z,A,this)},setEnd:function(z,A){return q(false,z,A,this)},setStartAfter:function(z){return this.setStart(z.parentNode,e.getNodeIndex(z)+1)},setStartBefore:function(z){return this.setStart(z.parentNode,e.getNodeIndex(z))},setEndAfter:function(z){return this.setEnd(z.parentNode,e.getNodeIndex(z)+1)},setEndBefore:function(z){return this.setEnd(z.parentNode,e.getNodeIndex(z))},selectNode:function(z){return this.setStartBefore(z).setEndAfter(z)},selectNodeContents:function(z){return this.setStart(z,0).setEnd(z,z.nodeType==3?z.nodeValue.length:z.childNodes.length)},cloneRange:function(){var A=this,z=new t(A.document);return z.setStart(A.startContainer,A.startOffset).setEnd(A.endContainer,A.endOffset)},collapse:function(z){var A=this;if(z){A.endContainer=A.startContainer;A.endOffset=A.startOffset}else{A.startContainer=A.endContainer;A.startOffset=A.endOffset}A.collapsed=true;return A},shrinkBoundary:function(A){var z=this,C,B=z.collapsed;while(z.startContainer.nodeType==1&&(C=z.startContainer.childNodes[z.startOffset])&&C.nodeType==1&&!e.isBookmarkNode(C)&&!a.$empty[C.tagName]&&!a.$nonChild[C.tagName]){z.setStart(C,0)}if(B){return z.collapse(true)}if(!A){while(z.endContainer.nodeType==1&&z.endOffset>0&&(C=z.endContainer.childNodes[z.endOffset-1])&&C.nodeType==1&&!e.isBookmarkNode(C)&&!a.$empty[C.tagName]&&!a.$nonChild[C.tagName]){z.setEnd(C,C.childNodes.length)}}return z},getCommonAncestor:function(A,B){var C=this.startContainer,z=this.endContainer;if(C===z){if(A&&C.nodeType==1&&this.startOffset==this.endOffset-1){return C.childNodes[this.startOffset]}return B&&C.nodeType==3?C.parentNode:C}return e.getCommonAncestor(C,z)},trimBoundary:function(A){this.txtToElmBoundary();var E=this.startContainer,D=this.startOffset,C=this.collapsed,z=this.endContainer;if(E.nodeType==3){if(D==0){this.setStartBefore(E)}else{if(D>=E.nodeValue.length){this.setStartAfter(E)}else{var B=e.split(E,D);if(E===z){this.setEnd(B,this.endOffset-D)}else{if(E.parentNode===z){this.endOffset+=1}}this.setStartBefore(B)}}if(C){return this.collapse(true)}}if(!A){D=this.endOffset;z=this.endContainer;if(z.nodeType==3){if(D==0){this.setEndBefore(z)}else{if(D>=z.nodeValue.length){this.setEndAfter(z)}else{e.split(z,D);this.setEndAfter(z)}}}}return this},txtToElmBoundary:function(){function z(B,D){var A=B[D+"Container"],C=B[D+"Offset"];if(A.nodeType==3){if(!C){B["set"+D.replace(/(\w)/,function(E){return E.toUpperCase()})+"Before"](A)}else{if(C>=A.nodeValue.length){B["set"+D.replace(/(\w)/,function(E){return E.toUpperCase()})+"After"](A)}}}}if(!this.collapsed){z(this,"start");z(this,"end")}return this},insertNode:function(B){var D=B,A=1;if(B.nodeType==11){D=B.firstChild;A=B.childNodes.length}this.trimBoundary(true);var E=this.startContainer,C=this.startOffset;var z=E.childNodes[C];if(z){E.insertBefore(B,z)}else{E.appendChild(B)}if(D.parentNode===this.endContainer){this.endOffset=this.endOffset+A}return this.setStartBefore(D)},setCursor:function(A,z){return this.collapse(A?false:true).select(z)},createBookmark:function(B,C){var z,A=this.document.createElement("span");A.style.cssText="display:none;line-height:0px;";A.appendChild(this.document.createTextNode("\uFEFF"));A.id="_baidu_bookmark_start_"+(C?"":w++);if(!this.collapsed){z=A.cloneNode(true);z.id="_baidu_bookmark_end_"+(C?"":w++)}this.insertNode(A);if(z){this.collapse(false).insertNode(z);this.setEndBefore(z)}this.setStartAfter(A);return{start:B?A.id:A,end:z?B?z.id:z:null,id:B}},moveToBookmark:function(A){var B=A.id?this.document.getElementById(A.start):A.start,z=A.end&&A.id?this.document.getElementById(A.end):A.end;this.setStartBefore(B);e.remove(B);if(z){this.setEndBefore(z);e.remove(z)}else{this.collapse(true)}return this},enlarge:function(A,D){var z=e.isBody,E,C,B=this.document.createTextNode("");if(A){C=this.startContainer;if(C.nodeType==1){if(C.childNodes[this.startOffset]){E=C=C.childNodes[this.startOffset]}else{C.appendChild(B);E=C=B}}else{E=C}while(1){if(e.isBlockElm(C)){C=E;while((E=C.previousSibling)&&!e.isBlockElm(E)){C=E}this.setStartBefore(C);break}E=C;C=C.parentNode}C=this.endContainer;if(C.nodeType==1){if(E=C.childNodes[this.endOffset]){C.insertBefore(B,E)}else{C.appendChild(B)}E=C=B}else{E=C}while(1){if(e.isBlockElm(C)){C=E;while((E=C.nextSibling)&&!e.isBlockElm(E)){C=E}this.setEndAfter(C);break}E=C;C=C.parentNode}if(B.parentNode===this.endContainer){this.endOffset--}e.remove(B)}if(!this.collapsed){while(this.startOffset==0){if(D&&D(this.startContainer)){break}if(z(this.startContainer)){break}this.setStartBefore(this.startContainer)}while(this.endOffset==(this.endContainer.nodeType==1?this.endContainer.childNodes.length:this.endContainer.nodeValue.length)){if(D&&D(this.endContainer)){break}if(z(this.endContainer)){break}this.setEndAfter(this.endContainer)}}return this},adjustmentBoundary:function(){if(!this.collapsed){while(!e.isBody(this.startContainer)&&this.startOffset==this.startContainer[this.startContainer.nodeType==3?"nodeValue":"childNodes"].length){this.setStartAfter(this.startContainer)}while(!e.isBody(this.endContainer)&&!this.endOffset){this.setEndBefore(this.endContainer)}}return this},applyInlineStyle:function(B,M,I){if(this.collapsed){return this}this.trimBoundary().enlarge(false,function(Q){return Q.nodeType==1&&e.isBlockElm(Q)}).adjustmentBoundary();var J=this.createBookmark(),E=J.end,O=function(Q){return Q.nodeType==1?Q.tagName.toLowerCase()!="br":!e.isWhitespace(Q)},H=e.getNextDomNode(J.start,false,O),C,D,G=this.cloneRange();while(H&&(e.getPosition(H,E)&e.POSITION_PRECEDING)){if(H.nodeType==3||a[B][H.tagName]){G.setStartBefore(H);C=H;while(C&&(C.nodeType==3||a[B][C.tagName])&&C!==E){D=C;C=e.getNextDomNode(C,C.nodeType==1,null,function(Q){return a[B][Q.tagName]})}var N=G.setEndAfter(D).extractContents(),K;if(I&&I.length>0){var z,L;L=z=I[0].cloneNode(false);for(var F=1,P;P=I[F++];){z.appendChild(P.cloneNode(false));z=z.firstChild}K=z}else{K=G.document.createElement(B)}if(M){e.setAttributes(K,M)}K.appendChild(N);G.insertNode(I?L:K);var A;if(B=="span"&&M.style&&/text\-decoration/.test(M.style)&&(A=e.findParentByTagName(K,"a",true))){e.setAttributes(A,M);e.remove(K,true);K=A}else{e.mergSibling(K);e.clearEmptySibling(K)}e.mergChild(K,B,M);H=e.getNextDomNode(K,false,O);e.mergToParent(K);if(C===E){break}}else{H=e.getNextDomNode(H,true,O)}}return this.moveToBookmark(J)},removeInlineStyle:function(A){if(this.collapsed){return this}A=n.isArray(A)?A:[A];this.shrinkBoundary().adjustmentBoundary();var G=this.startContainer,z=this.endContainer;while(1){if(G.nodeType==1){if(n.indexOf(A,G.tagName.toLowerCase())>-1){break}if(G.tagName.toLowerCase()=="body"){G=null;break}}G=G.parentNode}while(1){if(z.nodeType==1){if(n.indexOf(A,z.tagName.toLowerCase())>-1){break}if(z.tagName.toLowerCase()=="body"){z=null;break}}z=z.parentNode}var C=this.createBookmark(),F,E;if(G){E=this.cloneRange().setEndBefore(C.start).setStartBefore(G);F=E.extractContents();E.insertNode(F);e.clearEmptySibling(G,true);G.parentNode.insertBefore(C.start,G)}if(z){E=this.cloneRange().setStartAfter(C.end).setEndAfter(z);F=E.extractContents();E.insertNode(F);e.clearEmptySibling(z,false,true);z.parentNode.insertBefore(C.end,z.nextSibling)}var D=e.getNextDomNode(C.start,false,function(H){return H.nodeType==1}),B;while(D&&D!==C.end){B=e.getNextDomNode(D,true,function(H){return H.nodeType==1});if(n.indexOf(A,D.tagName.toLowerCase())>-1){e.remove(D,true)}D=B}return this.moveToBookmark(C)},getClosedNode:function(){var A;if(!this.collapsed){var z=this.cloneRange().adjustmentBoundary().shrinkBoundary();if(z.startContainer.nodeType==1&&z.startContainer===z.endContainer&&z.endOffset-z.startOffset==1){var B=z.startContainer.childNodes[z.startOffset];if(B&&B.nodeType==1&&(a.$empty[B.tagName]||a.$nonChild[B.tagName])){A=B}}}return A},select:i.ie?function(z,J){var F;if(!this.collapsed){this.shrinkBoundary()}var B=this.getClosedNode();if(B&&!J){try{F=this.document.body.createControlRange();F.addElement(B);F.select()}catch(G){}return this}var H=this.createBookmark(),A=H.start,C;F=this.document.body.createTextRange();F.moveToElementText(A);F.moveStart("character",1);if(!this.collapsed){var E=this.document.body.createTextRange();C=H.end;E.moveToElementText(C);F.setEndPoint("EndToEnd",E)}else{if(!z&&this.startContainer.nodeType!=3){var I=this.document.createTextNode(x),D=this.document.createElement("span");D.appendChild(this.document.createTextNode(x));A.parentNode.insertBefore(D,A);A.parentNode.insertBefore(I,A);v(this.document,I);s=I;u(D,"previousSibling");u(A,"nextSibling");F.moveStart("character",-1);F.collapse(true)}}this.moveToBookmark(H);D&&e.remove(D);F.select();return this}:function(z){var D=e.getWindow(this.document),C=D.getSelection(),B;i.gecko?this.document.body.focus():D.focus();if(C){C.removeAllRanges();if(this.collapsed&&!z){B=this.document.createTextNode(x);this.insertNode(B);v(this.document,B);u(B,"previousSibling");u(B,"nextSibling");s=B;this.setStart(B,i.webkit?1:0).collapse(true)}var A=this.document.createRange();A.setStart(this.startContainer,this.startOffset);A.setEnd(this.endContainer,this.endOffset);C.addRange(A)}return this},scrollToView:function(B,C){B=B?window:e.getWindow(this.document);var z=this.document.createElement("span");z.innerHTML="&nbsp;";var A=this.cloneRange();A.insertNode(z);e.scrollToView(z,B,C);e.remove(z);return this}}})();(function(){function t(D,v){var w=e.getNodeIndex;D=D.duplicate();D.collapse(v);var H=D.parentElement();if(!H.hasChildNodes()){return{container:H,offset:0}}var G=H.children,x,z=D.duplicate(),I=0,C=G.length-1,E=-1,u;while(I<=C){E=Math.floor((I+C)/2);x=G[E];z.moveToElementText(x);var B=z.compareEndPoints("StartToStart",D);if(B>0){C=E-1}else{if(B<0){I=E+1}else{return{container:H,offset:w(x)}}}}if(E==-1){z.moveToElementText(H);z.setEndPoint("StartToStart",D);u=z.text.replace(/(\r\n|\r)/g,"\n").length;G=H.childNodes;if(!u){x=G[G.length-1];return{container:x,offset:x.nodeValue.length}}var A=G.length;while(u>0){u-=G[--A].nodeValue.length}return{container:G[A],offset:-u}}z.collapse(B>0);z.setEndPoint(B>0?"StartToStart":"EndToStart",D);u=z.text.replace(/(\r\n|\r)/g,"\n").length;if(!u){return a.$empty[x.tagName]||a.$nonChild[x.tagName]?{container:H,offset:w(x)+(B>0?0:1)}:{container:x,offset:B>0?0:x.childNodes.length}}while(u>0){try{var y=x;x=x[B>0?"previousSibling":"nextSibling"];u-=x.nodeValue.length}catch(F){return{container:H,offset:w(y)}}}return{container:x,offset:B>0?-u:x.nodeValue.length+u}}function s(w,v){if(w.item){v.selectNode(w.item(0))}else{var u=t(w,true);v.setStart(u.container,u.offset);if(w.compareEndPoints("StartToEnd",w)!=0){u=t(w,false);v.setEnd(u.container,u.offset)}}return v}function r(w){var v;try{v=w.getNative().createRange()}catch(x){return null}var u=v.item?v.item(0):v.parentElement();if((u.ownerDocument||u)===w.document){return v}return null}var q=g.Selection=function(w){var v=this,u;v.document=w;if(b){u=e.getWindow(w).frameElement;e.on(u,"beforedeactivate",function(){v._bakIERange=v.getIERange()});e.on(u,"activate",function(){try{if(!r(v)&&v._bakIERange){v._bakIERange.select()}}catch(x){}v._bakIERange=null})}u=w=null};q.prototype={getNative:function(){var u=this.document;return !u?null:b?u.selection:e.getWindow(u).getSelection()},getIERange:function(){var u=r(this);if(!u){if(this._bakIERange){return this._bakIERange}}return u},cache:function(){this.clear();this._cachedRange=this.getRange();this._cachedStartElement=this.getStart();this._cachedStartElementPath=this.getStartElementPath()},getStartElementPath:function(){if(this._cachedStartElementPath){return this._cachedStartElementPath}var u=this.getStart();if(u){return e.findParents(u,true,null,true)}return[]},clear:function(){this._cachedStartElementPath=this._cachedRange=this._cachedStartElement=null},isFocus:function(){return i.ie&&r(this)||!i.ie&&this.getNative().rangeCount?true:false},getRange:function(){var x=this;function w(B){var D=x.document.body.firstChild,C=B.collapsed;while(D&&D.firstChild){B.setStart(D,0);D=D.firstChild}if(!B.startContainer){B.setStart(x.document.body,0)}if(C){B.collapse(true)}}if(x._cachedRange!=null){return this._cachedRange}var v=new c.editor.dom.Range(x.document);if(b){var z=x.getIERange();if(z){s(z,v)}else{w(v)}}else{var y=x.getNative();if(y&&y.rangeCount){var u=y.getRangeAt(0);var A=y.getRangeAt(y.rangeCount-1);v.setStart(u.startContainer,u.startOffset).setEnd(A.endContainer,A.endOffset);if(v.collapsed&&e.isBody(v.startContainer)&&!v.startOffset){w(v)}}else{if(this._bakRange&&e.inDoc(this._bakRange.startContainer,this.document)){return this._bakRange}w(v)}}return this._bakRange=v},getStart:function(){if(this._cachedStartElement){return this._cachedStartElement}var u=b?this.getIERange():this.getRange(),x,y,v,w;if(b){if(!u){return this.document.body.firstChild}if(u.item){return u.item(0)}x=u.duplicate();x.text.length>0&&x.moveStart("character",1);x.collapse(1);y=x.parentElement();w=v=u.parentElement();while(v=v.parentNode){if(v==y){y=w;break}}}else{u.shrinkBoundary();y=u.startContainer;if(y.nodeType==1&&y.hasChildNodes()){y=y.childNodes[Math.min(y.childNodes.length-1,u.startOffset)]}if(y.nodeType==3){return y.parentNode}}return y},getText:function(){if(this.isFocus()){var u=this.getNative(),v=i.ie?u.createRange():u.getRangeAt(0);return v.text||v.toString()}return""}}})();(function(){var t=0,r;function s(A){var z=A.getElementsByTagName("img"),y;for(var x=0,w;w=z[x++];){if(y=w.getAttribute("orgSrc")){w.src=y;w.removeAttribute("orgSrc")}}var v=A.getElementsByTagName("a");for(var x=0,u;u=v[x++];x++){if(u.getAttribute("data_ue_src")){u.setAttribute("href",u.getAttribute("data_ue_src"))}}}var q=UE.Editor=function(u){var v=this;v.uid=t++;h.call(v);v.commands={};v.options=n.extend(u||{},UEDITOR_CONFIG,true);for(var w in UE.plugins){UE.plugins[w].call(v)}};q.prototype={destroy:function(){this.fireEvent("destroy");this.container.innerHTML="";e.remove(this.container)},render:function(u){if(u.constructor===String){u=document.getElementById(u)}if(u){u.innerHTML='<iframe id="baidu_editor_'+this.uid+'"width="100%" height="100%"  frameborder="0"></iframe>';u.style.overflow="hidden";this._setup(u.firstChild.contentWindow.document)}},_setup:function(z){var v=this.options,y=this;!i.webkit&&z.open();var u=b&&i.version<9;z.write((b&&i.version<9?"":"<!DOCTYPE html>")+'<html xmlns="http://www.w3.org/1999/xhtml"'+(!u?' class="view"':"")+"><head>"+(v.iframeCssUrl?'<link rel="stylesheet" type="text/css" href="'+n.unhtml(/^http/.test(v.iframeCssUrl)?v.iframeCssUrl:(v.UEDITOR_HOME_URL+v.iframeCssUrl))+'"/>':"")+'<style type="text/css">'+(v.initialStyle||" ")+"</style></head><body"+(u?' class="view"':"")+"></body></html>");!i.webkit&&z.close();if(b){z.body.disabled=true;z.body.contentEditable=true;z.body.disabled=false}else{z.body.contentEditable=true;z.body.spellcheck=false}this.document=z;this.window=z.defaultView||z.parentWindow;this.iframe=this.window.frameElement;this.body=z.body;if(this.options.minFrameHeight){this.setHeight(this.options.minFrameHeight);this.body.style.height=this.options.minFrameHeight}this.selection=new g.Selection(z);if(i.gecko){this.selection.getNative().removeAllRanges()}this._initEvents();if(y.options.initialContent){if(y.options.autoClearinitialContent){var w=y.execCommand;y.execCommand=function(){y.fireEvent("firstBeforeExecCommand");w.apply(y,arguments)};this.setDefaultContent(this.options.initialContent)}else{this.setContent(this.options.initialContent,true)}}for(var x=this.iframe.parentNode;!e.isBody(x);x=x.parentNode){if(x.tagName=="FORM"){e.on(x,"submit",function(){var A=document.getElementById("ueditor_textarea_"+y.options.textarea);if(!A){A=document.createElement("textarea");A.setAttribute("name",y.options.textarea);A.id="ueditor_textarea_"+y.options.textarea;A.style.display="none";this.appendChild(A)}A.value=y.getContent()});break}}if(e.isEmptyNode(y.body)){this.body.innerHTML="<p>"+(i.ie?"":"<br/>")+"</p>"}if(y.options.focus){setTimeout(function(){y.focus();!y.options.autoClearinitialContent&&y._selectionChange()})}if(!this.container){this.container=this.iframe.parentNode}if(y.options.fullscreen&&y.ui){y.ui.setFullScreen(true)}this.fireEvent("ready");if(!i.ie){e.on(y.window,"blur",function(){y._bakRange=y.selection.getRange();y.selection.getNative().removeAllRanges()})}if(i.gecko&&i.version<=10902){y.body.contentEditable=false;setTimeout(function(){y.body.contentEditable=true},100);setInterval(function(){y.body.style.height=y.iframe.offsetHeight-20+"px"},100)}},sync:function(x){var v=this,u;function w(z){var y=document.getElementById("ueditor_textarea_"+v.options.textarea);if(!y){y=document.createElement("textarea");y.setAttribute("name",v.options.textarea);y.id="ueditor_textarea_"+v.options.textarea;y.style.display="none";z.appendChild(y)}y.value=v.getContent()}if(x){u=document.getElementById(x);u&&w(u)}else{for(u=v.iframe.parentNode;!e.isBody(u);u=u.parentNode){if(u.tagName=="FORM"){w(u);break}}}},setHeight:function(u){if(u!==parseInt(this.iframe.parentNode.style.height)){this.iframe.parentNode.style.height=u+"px"}if(i.ie&&i.version==9){this.document.body.style.height=u-20+"px"}},getContent:function(x){this.fireEvent("beforegetcontent",x);var v=new RegExp(e.fillChar,"g"),u=this.document.body.innerHTML.replace(v,"").replace(/>[\t\r\n]*?</g,"><");this.fireEvent("aftergetcontent",x);if(this.serialize){var w=this.serialize.parseHTML(u);w=this.serialize.transformOutput(w);u=this.serialize.toHTML(w)}return u},getContentTxt:function(){var u=new RegExp(e.fillChar,"g");return this.body[i.ie?"innerText":"textContent"].replace(u,"")},setContent:function(A,y){var C=this,B=n.extend({a:1,A:1},a.$inline,true),z;A=A.replace(/^[ \t\r\n]*?</,"<").replace(/>[ \t\r\n]*?$/,">").replace(/>[\t\r\n]*?</g,"><").replace(/[\s\/]?(\w+)?>[ \t\r\n]*?<\/?(\w+)/gi,function(F,E,G){if(E){z=G}else{E=z}return !B[E]&&!B[G]?F.replace(/>[ \t\r\n]*?</,"><"):F});C.fireEvent("beforesetcontent");var D=this.serialize;if(D){var x=D.parseHTML(A);x=D.transformInput(x);x=D.filter(x);A=D.toHTML(x)}this.document.body.innerHTML=A.replace(new RegExp("[\r"+e.fillChar+"]*","g"),"");if(i.ie&&i.version<7&&C.options.relativePath){s(this.document.body)}if(C.options.enterTag=="p"){var v=this.body.firstChild,u=C.document.createElement("p"),w;if(!v||v.nodeType==1&&a.$cdata[v.tagName]){this.body.innerHTML="<p>"+(i.ie?"":"<br/>")+"</p>"+this.body.innerHTML}else{while(v){if(v.nodeType==3||v.nodeType==1&&a.p[v.tagName]){w=v.nextSibling;u.appendChild(v);v=w;if(!v){C.body.appendChild(u)}}else{if(u.firstChild){C.body.insertBefore(u,v);u=C.document.createElement("p")}v=v.nextSibling}}}}C.adjustTable&&C.adjustTable(C.body);C.fireEvent("aftersetcontent");C.fireEvent("contentchange");!y&&C._selectionChange();C._bakRange=C._bakIERange=null;if(i.gecko){C.selection.getNative().removeAllRanges()}},focus:function(){this.selection.getRange().select(true)},_initEvents:function(){var v=this,z=v.document,y=v.window;v._proxyDomEvent=n.bind(v._proxyDomEvent,v);e.on(z,["click","contextmenu","mousedown","keydown","keyup","keypress","mouseup","mouseover","mouseout","selectstart"],v._proxyDomEvent);e.on(y,["focus","blur"],v._proxyDomEvent);e.on(z,["mouseup","keydown"],function(A){if(A.type=="keydown"&&(A.ctrlKey||A.metaKey||A.shiftKey||A.altKey)){return}if(A.button==2){return}v._selectionChange(250,A)});var u=0,w=i.ie?v.body:v.document,x;e.on(w,"dragstart",function(){u=1});e.on(w,i.webkit?"dragover":"drop",function(){return i.webkit?function(){clearTimeout(x);x=setTimeout(function(){if(!u){var E=v.selection,A=E.getRange();if(A){var B=A.getCommonAncestor();if(B&&v.serialize){var D=v.serialize,C=D.filter(D.transformInput(D.parseHTML(D.word(B.innerHTML))));B.innerHTML=D.toHTML(C)}}}u=0},200)}:function(A){if(!u){A.preventDefault?A.preventDefault():(A.returnValue=false)}u=0}}())},_proxyDomEvent:function(u){return this.fireEvent(u.type.replace(/^on/,""),u)},_selectionChange:function(x,u){var A=this;if(!A.selection.isFocus()){return}var z=false;var y,w;if(i.ie&&i.version<9&&u&&u.type=="mouseup"){var v=this.selection.getRange();if(!v.collapsed){z=true;y=u.clientX;w=u.clientY}}clearTimeout(r);r=setTimeout(function(){if(!A.selection.getNative()){return}var C;if(z&&A.selection.getNative().type=="None"){C=A.document.body.createTextRange();try{C.moveToPoint(y,w)}catch(B){C=null}}var D;if(C){D=A.selection.getIERange;A.selection.getIERange=function(){return C}}A.selection.cache();if(D){A.selection.getIERange=D}if(A.selection._cachedRange&&A.selection._cachedStartElement){A.fireEvent("beforeselectionchange");A.fireEvent("selectionchange",!!u);A.fireEvent("afterselectionchange");A.selection.clear()}},x||50)},_callCmdFn:function(y,v){var u=v[0].toLowerCase(),x,w;w=(x=this.commands[u])&&x[y]||(x=UE.commands[u])&&x[y];if(x&&!w&&y=="queryCommandState"){return false}else{if(w){return w.apply(this,v)}}},execCommand:function(v){v=v.toLowerCase();var w=this,u,x=w.commands[v]||UE.commands[v];if(!x||!x.execCommand){return}if(!x.notNeedUndo&&!w.__hasEnterExecCommand){w.__hasEnterExecCommand=true;if(w.queryCommandState(v)!=-1){w.fireEvent("beforeexeccommand",v);u=this._callCmdFn("execCommand",arguments);w.fireEvent("afterexeccommand",v)}w.__hasEnterExecCommand=false}else{u=this._callCmdFn("execCommand",arguments)}w._selectionChange();return u},queryCommandState:function(u){return this._callCmdFn("queryCommandState",arguments)},queryCommandValue:function(u){return this._callCmdFn("queryCommandValue",arguments)},hasContents:function(u){if(u){for(var w=0,v;v=u[w++];){if(this.document.getElementsByTagName(v).length>0){return true}}}if(!e.isEmptyBlock(this.body)){return true}return false},reset:function(){this.fireEvent("reset")},setDefaultContent:function(){function u(){var w=this;if(w.document.getElementById("initContent")){w.document.body.innerHTML="<p>"+(b?"":"<br/>")+"</p>";var v=w.selection.getRange();w.removeListener("firstBeforeExecCommand",u);w.removeListener("focus",u);setTimeout(function(){v.setStart(w.document.body.firstChild,0).collapse(true).select(true);w._selectionChange()})}}return function(v){var w=this;w.document.body.innerHTML='<p id="initContent">'+v+"</p>";if(i.ie&&i.version<7&&w.options.relativePath){s(w.document.body)}w.addListener("firstBeforeExecCommand",u);w.addListener("focus",u)}}()};n.inherits(q,h)})();UE.ajax=function(){return{request:function(t,v){var z=r(),w=false,u={method:"POST",timeout:5000,async:true,data:{},onsuccess:function(){},onerror:function(){}};if(typeof t==="object"){v=t;t=v.url}if(!z||!t){return}var y=v?n.extend(u,v):u;var B=q(y);if(!n.isEmptyObject(y.data)){B+=(B?"&":"")+q(y.data)}var A=setTimeout(function(){if(z.readyState!=4){w=true;z.abort();clearTimeout(A)}},y.timeout);var s=y.method.toUpperCase();var x=t+(t.indexOf("?")==-1?"?":"&")+(s=="POST"?"":B)+"&noCache="+ +new Date;z.open(s,x,y.async);z.onreadystatechange=function(){if(z.readyState==4){if(!w&&z.status==200){y.onsuccess(z)}else{y.onerror(z)}}};if(s=="POST"){z.setRequestHeader("Content-Type","application/x-www-form-urlencoded");z.send(B)}else{z.send(null)}}};function q(t){var u=[];for(var s in t){if(s=="method"||s=="timeout"||s=="async"){continue}if(!((typeof t[s]).toLowerCase()=="function"||(typeof t[s]).toLowerCase()=="object")){u.push(encodeURIComponent(s)+"="+encodeURIComponent(t[s]))}}return u.join("&")}function r(){var s=null;if(window.XMLHttpRequest){s=new XMLHttpRequest()}else{try{s=new ActiveXObject("Msxml2.XMLHTTP")}catch(t){try{s=new ActiveXObject("Microsoft.XMLHTTP")}catch(t){}}}return s}}();UE.plugins.keystrokes=function(){var u=this,q=0,t=e.keys,r={B:"strong",I:"em",FONT:"span"},s=[0,10,12,16,18,24,32,48],v={OL:["decimal","lower-alpha","lower-roman","upper-alpha","upper-roman"],UL:["circle","disc","square"]};u.addListener("keydown",function(x,K){var C=K.keyCode||K.which;if(this.selectAll){this.selectAll=false;if((C==8||C==46)){u.undoManger&&u.undoManger.save();u.body.innerHTML="<p>"+(i.ie?"":"<br/>")+"</p>";new g.Range(u.document).setStart(u.body.firstChild,0).setCursor(false,true);u.undoManger&&u.undoManger.save();i.ie&&u._selectionChange();e.preventDefault(K);return}}if(C==8){var H=u.selection.getRange(),R,z,y;if(H.collapsed){z=H.startContainer;if(e.isWhitespace(z)){z=z.parentNode}if(e.isEmptyNode(z)&&z===u.body.firstChild){if(z.tagName!="P"){p=u.document.createElement("p");u.body.insertBefore(p,z);e.fillNode(u.document,p);H.setStart(p,0).setCursor(false,true);e.remove(z)}e.preventDefault(K);return}}if(H.collapsed&&H.startContainer.nodeType==3&&H.startContainer.nodeValue.replace(new RegExp(e.fillChar,"g"),"").length==0){H.setStartBefore(H.startContainer).collapse(true)}if(z=H.getClosedNode()){u.undoManger&&u.undoManger.save();H.setStartBefore(z);e.remove(z);H.setCursor();u.undoManger&&u.undoManger.save();e.preventDefault(K);return}if(!i.ie){z=e.findParentByTagName(H.startContainer,"table",true);y=e.findParentByTagName(H.endContainer,"table",true);if(z&&!y||!z&&y||z!==y){K.preventDefault();return}if(i.webkit&&H.collapsed&&z){R=H.cloneRange().txtToElmBoundary();z=R.startContainer;if(e.isBlockElm(z)&&z.nodeType==1&&!a.$tableContent[z.tagName]&&!e.getChildCount(z,function(S){return S.nodeType==1?S.tagName!=="BR":1})){R.setStartBefore(z).setCursor();e.remove(z,true);K.preventDefault();return}}}if(u.undoManger){if(!H.collapsed){u.undoManger.save();q=1}}}if(C==9){H=u.selection.getRange();u.undoManger&&u.undoManger.save();for(var P=0,I="";P<u.options.tabSize;P++){I+=u.options.tabNode}var O=u.document.createElement("span");O.innerHTML=I;if(H.collapsed){var F=e.findParentByTagName(H.startContainer,"li",true);if(F&&e.isStartInblock(H)){w=H.createBookmark();var N=F.parentNode,Q=u.document.createElement(N.tagName);var A=n.indexOf(v[Q.tagName],e.getComputedStyle(N,"list-style-type"));A=A+1==v[Q.tagName].length?0:A+1;e.setStyle(Q,"list-style-type",v[Q.tagName][A]);N.insertBefore(Q,F);Q.appendChild(F);H.moveToBookmark(w).select()}else{H.insertNode(O.cloneNode(true).firstChild).setCursor(true)}}else{z=e.findParentByTagName(H.startContainer,"table",true);y=e.findParentByTagName(H.endContainer,"table",true);if(z||y){K.preventDefault?K.preventDefault():(K.returnValue=false);return}z=e.findParentByTagName(H.startContainer,["ol","ul"],true);y=e.findParentByTagName(H.endContainer,["ol","ul"],true);if(z&&y&&z===y){var w=H.createBookmark();z=e.findParentByTagName(H.startContainer,"li",true);y=e.findParentByTagName(H.endContainer,"li",true);if(z===z.parentNode.firstChild){var G=u.document.createElement(z.parentNode.tagName);z.parentNode.parentNode.insertBefore(G,z.parentNode);G.appendChild(z.parentNode)}else{N=z.parentNode,Q=u.document.createElement(N.tagName);A=n.indexOf(v[Q.tagName],e.getComputedStyle(N,"list-style-type"));A=A+1==v[Q.tagName].length?0:A+1;e.setStyle(Q,"list-style-type",v[Q.tagName][A]);z.parentNode.insertBefore(Q,z);var E;while(z!==y){E=z.nextSibling;Q.appendChild(z);z=E}Q.appendChild(y)}H.moveToBookmark(w).select()}else{if(z||y){K.preventDefault?K.preventDefault():(K.returnValue=false);return}z=e.findParent(H.startContainer,J);y=e.findParent(H.endContainer,J);if(z&&y&&z===y){H.deleteContents();H.insertNode(O.cloneNode(true).firstChild).setCursor(true)}else{var B=H.createBookmark(),J=function(S){return e.isBlockElm(S)};H.enlarge(true);var M=H.createBookmark(),L=e.getNextDomNode(M.start,false,J);while(L&&!(e.getPosition(L,M.end)&e.POSITION_FOLLOWING)){L.insertBefore(O.cloneNode(true).firstChild,L.firstChild);L=e.getNextDomNode(L,false,J)}H.moveToBookmark(M).moveToBookmark(B).select()}}}u.undoManger&&u.undoManger.save();K.preventDefault?K.preventDefault():(K.returnValue=false)}if(i.gecko&&C==46){H=u.selection.getRange();if(H.collapsed){z=H.startContainer;if(e.isEmptyBlock(z)){var D=z.parentNode;while(e.getChildCount(D)==1&&!e.isBody(D)){z=D;D=D.parentNode}if(z===D.lastChild){K.preventDefault()}return}}}});u.addListener("keyup",function(F,I){var M=I.keyCode||I.which;if(!i.gecko&&!t[M]&&!I.ctrlKey&&!I.metaKey&&!I.shiftKey&&!I.altKey){D=u.selection.getRange();if(D.collapsed){var x=D.startContainer,y=0;while(!e.isBlockElm(x)){if(x.nodeType==1&&n.indexOf(["FONT","B","I"],x.tagName)!=-1){var z=u.document.createElement(r[x.tagName]);if(x.tagName=="FONT"){z.style.cssText=(x.getAttribute("size")?"font-size:"+(s[x.getAttribute("size")]||12)+"px":"")+";"+(x.getAttribute("color")?"color:"+x.getAttribute("color"):"")+";"+(x.getAttribute("face")?"font-family:"+x.getAttribute("face"):"")+";"+x.style.cssText}while(x.firstChild){z.appendChild(x.firstChild)}x.parentNode.insertBefore(z,x);e.remove(x);if(!y){D.setEnd(z,z.childNodes.length).collapse(true)}x=z;y=1}x=x.parentNode}y&&D.select()}}if(M==8){if(i.gecko){for(var B=0,J,L=e.getElementsByTagName(this.body,"li");J=L[B++];){if(e.isEmptyNode(J)&&!J.previousSibling){var K=J.parentNode;e.remove(J);if(e.isEmptyNode(K)){e.remove(K)}}}}var D,x,H,A=this.currentSelectedArr;if(A&&A.length>0){for(var B=0,w;w=A[B++];){w.innerHTML=i.ie?(i.version<9?"&#65279":""):"<br/>"}D=new g.Range(this.document);D.setStart(A[0],0).setCursor();if(q){u.undoManger.save();q=0}if(i.webkit){I.preventDefault()}return}D=u.selection.getRange();x=D.startContainer;if(e.isWhitespace(x)){x=x.parentNode}var E=0;while(x.nodeType==1&&e.isEmptyNode(x)&&a.$removeEmpty[x.tagName]){E=1;H=x.parentNode;e.remove(x);x=H}if(E&&x.nodeType==1&&e.isEmptyNode(x)){if(i.ie){var G=D.document.createElement("span");x.appendChild(G);D.setStart(x,0).setCursor();J=e.findParentByTagName(x,"li",true);if(J){var C=J.nextSibling;while(C){if(e.isEmptyBlock(C)){J=C;C=C.nextSibling;e.remove(J);continue}break}}}else{x.innerHTML="<br/>";D.setStart(x,0).setCursor(false,true)}setTimeout(function(){if(i.ie){e.remove(G)}if(q){u.undoManger.save();q=0}},0)}else{if(q){u.undoManger.save();q=0}}}})};UE.plugins.fiximgclick=function(){var q=this;if(i.webkit){q.addListener("click",function(s,t){if(t.target.tagName=="IMG"){var r=new g.Range(q.document);r.selectNode(t.target).select()}})}};UE.commands["delete"]={execCommand:function(){var v=this.selection.getRange(),t=0,y=0,x=this;if(this.selectAll){x.body.innerHTML="<p>"+(i.ie?"&nbsp;":"<br/>")+"</p>";v.setStart(x.body.firstChild,0).setCursor(false,true);x.selectAll=false;return}if(x.currentSelectedArr&&x.currentSelectedArr.length>0){for(var u=0,A;A=x.currentSelectedArr[u++];){if(A.style.display!="none"){A.innerHTML=i.ie?e.fillChar:"<br/>"}}v.setStart(x.currentSelectedArr[0],0).setCursor();return}if(v.collapsed){return}v.txtToElmBoundary();while(!v.startOffset&&!e.isBody(v.startContainer)&&!a.$tableContent[v.startContainer.tagName]){t=1;v.setStartBefore(v.startContainer)}while(!e.isBody(v.endContainer)&&!a.$tableContent[v.endContainer.tagName]){var r,z=v.endContainer,w=v.endOffset;r=z.childNodes[w];if(!r||e.isBr(r)&&z.lastChild===r){v.setEndAfter(z);continue}break}if(t){var q=x.document.createElement("span");q.innerHTML="start";q.id="_baidu_cut_start";v.insertNode(q).setStartBefore(q)}if(y){var s=x.document.createElement("span");s.innerHTML="end";s.id="_baidu_cut_end";v.cloneRange().collapse(false).insertNode(s);v.setEndAfter(s)}v.deleteContents();if(e.isBody(v.startContainer)&&e.isEmptyBlock(x.body)){x.body.innerHTML="<p>"+(i.ie?"":"<br/>")+"</p>";v.setStart(x.body.firstChild,0).collapse(true)}else{if(!i.ie&&e.isEmptyBlock(v.startContainer)){v.startContainer.innerHTML="<br/>"}}v.select(true)},queryCommandState:function(){if(this.currentSelectedArr&&this.currentSelectedArr.length>0){return 0}return this.highlight||this.selection.getRange().collapsed?-1:0}};UE.plugins.shortcutkeys=function(){var r=this,q=n.extend({"ctrl+66":"Bold","ctrl+90":"Undo","ctrl+89":"Redo","ctrl+73":"Italic","ctrl+85":"Underline","ctrl+shift+67":"removeformat","ctrl+shift+76":"justify:left","ctrl+shift+82":"justify:right","ctrl+65":"selectAll"},r.options.shortcutkeys);r.addListener("keydown",function(t,w){var v=w.keyCode||w.which,u;for(var s in q){if(/^(ctrl)(\+shift)?\+(\d+)$/.test(s.toLowerCase())||/^(\d+)$/.test(s)){if(((RegExp.$1=="ctrl"?(w.ctrlKey||w.metaKey):0)&&(RegExp.$2!=""?w[RegExp.$2.slice(1)+"Key"]:1)&&v==RegExp.$3)||v==RegExp.$1){u=q[s].split(":");r.execCommand(u[0],u[1]);e.preventDefault(w)}}}})};var c=c||{};c.editor=c.editor||{};c.editor.ui={};(function(){var t=c.editor.browser,s=c.editor.dom.domUtils;var w="$EDITORUI";var v=window[w]={};var q="ID"+w;var y=0;var r=c.editor.ui.uiUtils={uid:function(z){return(z?z[q]||(z[q]=++y):++y)},hook:function(z,B){var A;if(z&&z._callbacks){A=z}else{A=function(){var F;if(z){F=z.apply(this,arguments)}var E=A._callbacks;var C=E.length;while(C--){var D=E[C].apply(this,arguments);if(F===undefined){F=D}}return F};A._callbacks=[]}A._callbacks.push(B);return A},createElementByHtml:function(z){var A=document.createElement("div");A.innerHTML=z;A=A.firstChild;A.parentNode.removeChild(A);return A},getViewportElement:function(){return(t.ie&&t.quirks)?document.body:document.documentElement},getClientRect:function(z){var C=z.getBoundingClientRect();var A={left:Math.round(C.left),top:Math.round(C.top),height:Math.round(C.bottom-C.top),width:Math.round(C.right-C.left)};var B;while((B=z.ownerDocument)!==document&&(z=s.getWindow(B).frameElement)){C=z.getBoundingClientRect();A.left+=C.left;A.top+=C.top}A.bottom=A.top+A.height;A.right=A.left+A.width;return A},getViewportRect:function(){var A=r.getViewportElement();var B=(window.innerWidth||A.clientWidth)|0;var z=(window.innerHeight||A.clientHeight)|0;return{left:0,top:0,height:z,width:B,bottom:z,right:B}},setViewportOffset:function(z,C){var A;var B=r.getFixedLayer();if(z.parentNode===B){z.style.left=C.left+"px";z.style.top=C.top+"px"}else{s.setViewportOffset(z,C)}},getEventOffset:function(z){var A=z.target||z.srcElement;var B=r.getClientRect(A);var C=r.getViewportOffsetByEvent(z);return{left:C.left-B.left,top:C.top-B.top}},getViewportOffsetByEvent:function(A){var B=A.target||A.srcElement;var z=s.getWindow(B).frameElement;var D={left:A.clientX,top:A.clientY};if(z&&B.ownerDocument!==document){var C=r.getClientRect(z);D.left+=C.left;D.top+=C.top}return D},setGlobal:function(A,z){v[A]=z;return w+'["'+A+'"]'},unsetGlobal:function(z){delete v[z]},copyAttributes:function(D,C){var A=C.attributes;var z=A.length;while(z--){var B=A[z];if(B.nodeName!="style"&&B.nodeName!="class"&&(!t.ie||B.specified)){D.setAttribute(B.nodeName,B.nodeValue)}}if(C.className){D.className+=" "+C.className}if(C.style.cssText){D.style.cssText+=";"+C.style.cssText}},removeStyle:function(A,z){if(A.style.removeProperty){A.style.removeProperty(z)}else{if(A.style.removeAttribute){A.style.removeAttribute(z)}else{throw""}}},contains:function(A,z){return A&&z&&(A===z?false:(A.contains?A.contains(z):A.compareDocumentPosition(z)&16))},startDrag:function(H,D,F){var F=F||document;var C=H.clientX;var B=H.clientY;function A(J){var I=J.clientX-C;var K=J.clientY-B;D.ondragmove(I,K);if(J.stopPropagation){J.stopPropagation()}else{J.cancelBubble=true}}if(F.addEventListener){function G(I){F.removeEventListener("mousemove",A,true);F.removeEventListener("mouseup",A,true);D.ondragstop()}F.addEventListener("mousemove",A,true);F.addEventListener("mouseup",G,true);H.preventDefault()}else{var E=H.srcElement;E.setCapture();function z(){E.releaseCapture();E.detachEvent("onmousemove",A);E.detachEvent("onmouseup",z);E.detachEvent("onlosecaptrue",z);D.ondragstop()}E.attachEvent("onmousemove",A);E.attachEvent("onmouseup",z);E.attachEvent("onlosecaptrue",z);H.returnValue=false}D.ondragstart()},getFixedLayer:function(){var z=document.getElementById("edui_fixedlayer");if(z==null){z=document.createElement("div");z.id="edui_fixedlayer";document.body.appendChild(z);if(t.ie&&t.version<=8){z.style.position="absolute";x();setTimeout(u)}else{z.style.position="fixed"}z.style.left="0";z.style.top="0";z.style.width="0";z.style.height="0"}return z},makeUnselectable:function(A){if(t.opera||(t.ie&&t.version<9)){A.unselectable="on";if(A.hasChildNodes()){for(var z=0;z<A.childNodes.length;z++){if(A.childNodes[z].nodeType==1){r.makeUnselectable(A.childNodes[z])}}}}else{if(A.style.MozUserSelect!==undefined){A.style.MozUserSelect="none"}else{if(A.style.WebkitUserSelect!==undefined){A.style.WebkitUserSelect="none"}else{if(A.style.KhtmlUserSelect!==undefined){A.style.KhtmlUserSelect="none"}}}}}};function u(){var z=document.getElementById("edui_fixedlayer");r.setViewportOffset(z,{left:0,top:0})}function x(z){s.on(window,"scroll",u);s.on(window,"resize",c.editor.utils.defer(u,0,true))}})();(function(){var q=c.editor.utils,r=c.editor.ui.uiUtils,s=c.editor.EventBase,t=c.editor.ui.UIBase=function(){};t.prototype={className:"",uiName:"",initOptions:function(v){var w=this;for(var u in v){w[u]=v[u]}this.id=this.id||"edui"+r.uid()},initUIBase:function(){this._globalKey=q.unhtml(r.setGlobal(this.id,this))},render:function(v){var u=this.renderHtml();var w=r.createElementByHtml(u);var x=this.getDom();if(x!=null){x.parentNode.replaceChild(w,x);r.copyAttributes(w,x)}else{if(typeof v=="string"){v=document.getElementById(v)}v=v||r.getFixedLayer();v.appendChild(w)}this.postRender()},getDom:function(u){if(!u){return document.getElementById(this.id)}else{return document.getElementById(this.id+"_"+u)}},postRender:function(){this.fireEvent("postrender")},getHtmlTpl:function(){return""},formatHtml:function(u){var v="edui-"+this.uiName;return(u.replace(/##/g,this.id).replace(/%%-/g,this.uiName?v+"-":"").replace(/%%/g,(this.uiName?v:"")+" "+this.className).replace(/\$\$/g,this._globalKey))},renderHtml:function(){return this.formatHtml(this.getHtmlTpl())},dispose:function(){var u=this.getDom();if(u){c.editor.dom.domUtils.remove(u)}r.unsetGlobal(this.id)}};q.inherits(t,s)})();(function(){var q=c.editor.utils,r=c.editor.ui.UIBase,s=c.editor.ui.Separator=function(t){this.initOptions(t);this.initSeparator()};s.prototype={uiName:"separator",initSeparator:function(){this.initUIBase()},getHtmlTpl:function(){return'<div id="##" class="edui-box %%"></div>'}};q.inherits(s,r)})();(function(){var r=c.editor.utils,q=c.editor.dom.domUtils,t=c.editor.ui.UIBase,s=c.editor.ui.uiUtils;var u=c.editor.ui.Mask=function(v){this.initOptions(v);this.initUIBase()};u.prototype={getHtmlTpl:function(){return'<div id="##" class="edui-mask %%" onmousedown="return $$._onMouseDown(event, this);"></div>'},postRender:function(){var v=this;q.on(window,"resize",function(){setTimeout(function(){if(!v.isHidden()){v._fill()}})})},show:function(v){this._fill();this.getDom().style.display="";this.getDom().style.zIndex=v},hide:function(){this.getDom().style.display="none";this.getDom().style.zIndex=""},isHidden:function(){return this.getDom().style.display=="none"},_onMouseDown:function(){return false},_fill:function(){var v=this.getDom();var w=s.getViewportRect();v.style.width=w.width+"px";v.style.height=w.height+"px"}};r.inherits(u,t)})();(function(){var s=c.editor.utils,u=c.editor.ui.uiUtils,q=c.editor.dom.domUtils,x=c.editor.ui.UIBase,w=c.editor.ui.Popup=function(y){this.initOptions(y);this.initPopup()};var r=[];function v(A){var B=[];for(var z=0;z<r.length;z++){var y=r[z];if(!y.isHidden()){if(y.queryAutoHide(A)!==false){y.hide()}}}}w.postHide=v;var t=["edui-anchor-topleft","edui-anchor-topright","edui-anchor-bottomleft","edui-anchor-bottomright"];w.prototype={SHADOW_RADIUS:5,content:null,_hidden:false,autoRender:true,canSideLeft:true,canSideUp:true,initPopup:function(){this.initUIBase();r.push(this)},getHtmlTpl:function(){return'<div id="##" class="edui-popup %%"> <div id="##_body" class="edui-popup-body"> <iframe style="position:absolute;z-index:-1;left:0;top:0;background-color: white;" frameborder="0" width="100%" height="100%" src="javascript:"></iframe> <div class="edui-shadow"></div> <div id="##_content" class="edui-popup-content">'+this.getContentHtmlTpl()+"  </div> </div></div>"},getContentHtmlTpl:function(){if(typeof this.content=="string"){return this.content}return this.content.renderHtml()},_UIBase_postRender:x.prototype.postRender,postRender:function(){if(this.content instanceof x){this.content.postRender()}this.fireEvent("postRenderAfter");this.hide(true);this._UIBase_postRender()},_doAutoRender:function(){if(!this.getDom()&&this.autoRender){this.render()}},mesureSize:function(){var y=this.getDom("content");return u.getClientRect(y)},fitSize:function(){var y=this.getDom("body");y.style.width="";y.style.height="";var z=this.mesureSize();y.style.width=z.width+"px";y.style.height=z.height+"px";return z},showAnchor:function(z,y){this.showAnchorRect(u.getClientRect(z),y)},showAnchorRect:function(F,C,D){this._doAutoRender();var A=u.getViewportRect();this._show();var z=this.fitSize();var G,B,y,E;if(C){G=this.canSideLeft&&(F.right+z.width>A.right&&F.left>z.width);B=this.canSideUp&&(F.top+z.height>A.bottom&&F.bottom>z.height);y=(G?F.left-z.width:F.right);E=(B?F.bottom-z.height:F.top)}else{G=this.canSideLeft&&(F.right+z.width>A.right&&F.left>z.width);B=this.canSideUp&&(F.top+z.height>A.bottom&&F.bottom>z.height);y=(G?F.right-z.width:F.left);E=(B?F.top-z.height:F.bottom)}var H=this.getDom();u.setViewportOffset(H,{left:y,top:E});q.removeClasses(H,t);H.className+=" "+t[(B?1:0)*2+(G?1:0)];if(this.editor){H.style.zIndex=this.editor.container.style.zIndex*1+10;c.editor.ui.uiUtils.getFixedLayer().style.zIndex=H.style.zIndex-1}},showAt:function(B){var A=B.left;var z=B.top;var y={left:A,top:z,right:A,bottom:z,height:0,width:0};this.showAnchorRect(y,false,true)},_show:function(){if(this._hidden){var y=this.getDom();y.style.display="";this._hidden=false;this.fireEvent("show")}},isHidden:function(){return this._hidden},show:function(){this._doAutoRender();this._show()},hide:function(y){if(!this._hidden&&this.getDom()){this.getDom().style.display="none";this._hidden=true;if(!y){this.fireEvent("hide")}}},queryAutoHide:function(y){return !y||!u.contains(this.getDom(),y)}};s.inherits(w,x);q.on(document,"mousedown",function(y){var z=y.target||y.srcElement;v(z)});q.on(window,"scroll",function(){v()})})();(function(){var q=c.editor.utils,s=c.editor.ui.UIBase,r=c.editor.ui.ColorPicker=function(v){this.initOptions(v);this.noColorText=this.noColorText||"";this.initUIBase()};r.prototype={getHtmlTpl:function(){return u(this.noColorText)},_onTableClick:function(v){var x=v.target||v.srcElement;var w=x.getAttribute("data-color");if(w){this.fireEvent("pickcolor",w)}},_onTableOver:function(v){var x=v.target||v.srcElement;var w=x.getAttribute("data-color");if(w){this.getDom("preview").style.backgroundColor=w}},_onTableOut:function(){this.getDom("preview").style.backgroundColor=""},_onPickNoColor:function(){this.fireEvent("picknocolor")}};q.inherits(r,s);var t=("ffffff,000000,eeece1,1f497d,4f81bd,c0504d,9bbb59,8064a2,4bacc6,f79646,f2f2f2,7f7f7f,ddd9c3,c6d9f0,dbe5f1,f2dcdb,ebf1dd,e5e0ec,dbeef3,fdeada,d8d8d8,595959,c4bd97,8db3e2,b8cce4,e5b9b7,d7e3bc,ccc1d9,b7dde8,fbd5b5,bfbfbf,3f3f3f,938953,548dd4,95b3d7,d99694,c3d69b,b2a2c7,92cddc,fac08f,a5a5a5,262626,494429,17365d,366092,953734,76923c,5f497a,31859b,e36c09,7f7f7f,0c0c0c,1d1b10,0f243e,244061,632423,4f6128,3f3151,205867,974806,c00000,ff0000,ffc000,ffff00,92d050,00b050,00b0f0,0070c0,002060,7030a0,").split(",");function u(v){var x='<div id="##" class="edui-colorpicker %%"><div class="edui-colorpicker-topbar edui-clearfix"><div unselectable="on" id="##_preview" class="edui-colorpicker-preview"></div><div unselectable="on" class="edui-colorpicker-nocolor" onclick="$$._onPickNoColor(event, this);">'+v+'</div></div><table  class="edui-box" style="border-collapse: collapse;" onmouseover="$$._onTableOver(event, this);" onmouseout="$$._onTableOut(event, this);" onclick="return $$._onTableClick(event, this);" cellspacing="0" cellpadding="0"><tr style="border-bottom: 1px solid #ddd;font-size: 13px;line-height: 25px;color:#366092;padding-top: 2px"><td colspan="10"></td> </tr><tr class="edui-colorpicker-tablefirstrow" >';for(var w=0;w<t.length;w++){if(w&&w%10===0){x+="</tr>"+(w==60?'<tr style="border-bottom: 1px solid #ddd;font-size: 13px;line-height: 25px;color:#366092;"><td colspan="10"></td></tr>':"")+"<tr"+(w==60?' class="edui-colorpicker-tablefirstrow"':"")+">"}x+=w<70?'<td style="padding: 0 2px;"><a hidefocus title="'+t[w]+'" onclick="return false;" href="javascript:" unselectable="on" class="edui-box edui-colorpicker-colorcell" data-color="#'+t[w]+'" style="background-color:#'+t[w]+";border:solid #ccc;"+(w<10||w>=60?"border-width:1px;":w>=10&&w<20?"border-width:1px 1px 0 1px;":"border-width:0 1px 0 1px;")+'"></a></td>':""}x+="</tr></table></div>";return x}})();(function(){var q=c.editor.utils,r=c.editor.ui.uiUtils,s=c.editor.ui.UIBase;var t=c.editor.ui.TablePicker=function(u){this.initOptions(u);this.initTablePicker()};t.prototype={defaultNumRows:10,defaultNumCols:10,maxNumRows:20,maxNumCols:20,numRows:10,numCols:10,lengthOfCellSide:22,initTablePicker:function(){this.initUIBase()},getHtmlTpl:function(){return'<div id="##" class="edui-tablepicker %%"><div class="edui-tablepicker-body"><div class="edui-infoarea"><span id="##_label" class="edui-label"></span><span class="edui-clickable" onclick="$$._onMore();"></span></div><div class="edui-pickarea" onmousemove="$$._onMouseMove(event, this);" onmouseover="$$._onMouseOver(event, this);" onmouseout="$$._onMouseOut(event, this);" onclick="$$._onClick(event, this);"><div id="##_overlay" class="edui-overlay"></div></div></div></div>'},_UIBase_render:s.prototype.render,render:function(u){this._UIBase_render(u);this.getDom("label").innerHTML="0 x 0"},_track:function(y,x){var v=this.getDom("overlay").style;var w=this.lengthOfCellSide;v.width=y*w+"px";v.height=x*w+"px";var u=this.getDom("label");u.innerHTML=y+" x "+x+"";this.numCols=y;this.numRows=x},_onMouseOver:function(v,w){var u=v.relatedTarget||v.fromElement;if(!r.contains(w,u)&&w!==u){this.getDom("label").innerHTML="0 x 0";this.getDom("overlay").style.visibility=""}},_onMouseOut:function(v,w){var u=v.relatedTarget||v.toElement;if(!r.contains(w,u)&&w!==u){this.getDom("label").innerHTML="0 x 0";this.getDom("overlay").style.visibility="hidden"}},_onMouseMove:function(u,w){var v=this.getDom("overlay").style;var A=r.getEventOffset(u);var y=this.lengthOfCellSide;var z=Math.ceil(A.left/y);var x=Math.ceil(A.top/y);this._track(z,x)},_onClick:function(){this.fireEvent("picktable",this.numCols,this.numRows)},_onMore:function(){this.fireEvent("more")}};q.inherits(t,s)})();(function(){var s=c.editor.browser,q=c.editor.dom.domUtils,r=c.editor.ui.uiUtils;var t='onmousedown="$$.Stateful_onMouseDown(event, this);" onmouseup="$$.Stateful_onMouseUp(event, this);"'+(s.ie?(' onmouseenter="$$.Stateful_onMouseEnter(event, this);" onmouseleave="$$.Stateful_onMouseLeave(event, this);"'):(' onmouseover="$$.Stateful_onMouseOver(event, this);" onmouseout="$$.Stateful_onMouseOut(event, this);"'));c.editor.ui.Stateful={alwalysHoverable:false,Stateful_init:function(){this._Stateful_dGetHtmlTpl=this.getHtmlTpl;this.getHtmlTpl=this.Stateful_getHtmlTpl},Stateful_getHtmlTpl:function(){var u=this._Stateful_dGetHtmlTpl();return u.replace(/stateful/g,function(){return t})},Stateful_onMouseEnter:function(u,v){if(!this.isDisabled()||this.alwalysHoverable){this.addState("hover");this.fireEvent("over")}},Stateful_onMouseLeave:function(u,v){if(!this.isDisabled()||this.alwalysHoverable){this.removeState("hover");this.removeState("active");this.fireEvent("out")}},Stateful_onMouseOver:function(v,w){var u=v.relatedTarget;if(!r.contains(w,u)&&w!==u){this.Stateful_onMouseEnter(v,w)}},Stateful_onMouseOut:function(v,w){var u=v.relatedTarget;if(!r.contains(w,u)&&w!==u){this.Stateful_onMouseLeave(v,w)}},Stateful_onMouseDown:function(u,v){if(!this.isDisabled()){this.addState("active")}},Stateful_onMouseUp:function(u,v){if(!this.isDisabled()){this.removeState("active")}},Stateful_postRender:function(){if(this.disabled&&!this.hasState("disabled")){this.addState("disabled")}},hasState:function(u){return q.hasClass(this.getStateDom(),"edui-state-"+u)},addState:function(u){if(!this.hasState(u)){this.getStateDom().className+=" edui-state-"+u}},removeState:function(u){if(this.hasState(u)){q.removeClasses(this.getStateDom(),["edui-state-"+u])}},getStateDom:function(){return this.getDom("state")},isChecked:function(){return this.hasState("checked")},setChecked:function(u){if(!this.isDisabled()&&u){this.addState("checked")}else{this.removeState("checked")}},isDisabled:function(){return this.hasState("disabled")},setDisabled:function(u){if(u){this.removeState("hover");this.removeState("checked");this.removeState("active");this.addState("disabled")}else{this.removeState("disabled")}}}})();(function(){var r=c.editor.utils,t=c.editor.ui.UIBase,s=c.editor.ui.Stateful,q=c.editor.ui.Button=function(u){this.initOptions(u);this.initButton()};q.prototype={uiName:"button",label:"",title:"",showIcon:true,showText:true,initButton:function(){this.initUIBase();this.Stateful_init()},getHtmlTpl:function(){return'<div id="##" class="edui-box %%"><div id="##_state" stateful><div class="%%-wrap"><div id="##_body" unselectable="on" '+(this.title?'title="'+this.title+'"':"")+' class="%%-body" onmousedown="return false;" onclick="return $$._onClick();">'+(this.showIcon?'<div class="edui-box edui-icon"></div>':"")+(this.showText?'<div class="edui-box edui-label">'+this.label+"</div>":"")+"</div></div></div></div>"},postRender:function(){this.Stateful_postRender()},_onClick:function(){if(!this.isDisabled()){this.fireEvent("click")}}};r.inherits(q,t);r.extend(q.prototype,s)})();(function(){var s=c.editor.utils,u=c.editor.ui.uiUtils,q=c.editor.dom.domUtils,v=c.editor.ui.UIBase,t=c.editor.ui.Stateful,r=c.editor.ui.SplitButton=function(w){this.initOptions(w);this.initSplitButton()};r.prototype={popup:null,uiName:"splitbutton",title:"",initSplitButton:function(){this.initUIBase();this.Stateful_init();var x=this;if(this.popup!=null){var w=this.popup;this.popup=null;this.setPopup(w)}},_UIBase_postRender:v.prototype.postRender,postRender:function(){this.Stateful_postRender();this._UIBase_postRender()},setPopup:function(w){if(this.popup===w){return}if(this.popup!=null){this.popup.dispose()}w.addListener("show",s.bind(this._onPopupShow,this));w.addListener("hide",s.bind(this._onPopupHide,this));w.addListener("postrender",s.bind(function(){w.getDom("body").appendChild(u.createElementByHtml('<div id="'+this.popup.id+'_bordereraser" class="edui-bordereraser edui-background" style="width:'+(u.getClientRect(this.getDom()).width-2)+'px"></div>'));w.getDom().className+=" "+this.className},this));this.popup=w},_onPopupShow:function(){this.addState("opened")},_onPopupHide:function(){this.removeState("opened")},getHtmlTpl:function(){return'<div id="##" class="edui-box %%"><div '+(this.title?'title="'+this.title+'"':"")+' id="##_state" stateful><div class="%%-body"><div id="##_button_body" class="edui-box edui-button-body" onclick="$$._onButtonClick(event, this);"><div class="edui-box edui-icon"></div></div><div class="edui-box edui-splitborder"></div><div class="edui-box edui-arrow" onclick="$$._onArrowClick();"></div></div></div></div>'},showPopup:function(){var w=u.getClientRect(this.getDom());w.top-=this.popup.SHADOW_RADIUS;w.height+=this.popup.SHADOW_RADIUS;this.popup.showAnchorRect(w)},_onArrowClick:function(x,w){if(!this.isDisabled()){this.showPopup()}},_onButtonClick:function(){if(!this.isDisabled()){this.fireEvent("buttonclick")}}};s.inherits(r,v);s.extend(r.prototype,t,true)})();(function(){var r=c.editor.utils,s=c.editor.ui.uiUtils,t=c.editor.ui.ColorPicker,v=c.editor.ui.Popup,q=c.editor.ui.SplitButton,u=c.editor.ui.ColorButton=function(w){this.initOptions(w);this.initColorButton()};u.prototype={initColorButton:function(){var w=this;this.popup=new v({content:new t({noColorText:"",onpickcolor:function(y,x){w._onPickColor(x)},onpicknocolor:function(y,x){w._onPickNoColor(x)}}),editor:w.editor});this.initSplitButton()},_SplitButton_postRender:q.prototype.postRender,postRender:function(){this._SplitButton_postRender();this.getDom("button_body").appendChild(s.createElementByHtml('<div id="'+this.id+'_colorlump" class="edui-colorlump"></div>'));this.getDom().className+=" edui-colorbutton"},setColor:function(w){this.getDom("colorlump").style.backgroundColor=w;this.color=w},_onPickColor:function(w){if(this.fireEvent("pickcolor",w)!==false){this.setColor(w);this.popup.hide()}},_onPickNoColor:function(w){if(this.fireEvent("picknocolor")!==false){this.popup.hide()}}};r.inherits(u,q)})();(function(){var r=c.editor.utils,s=c.editor.ui.Popup,t=c.editor.ui.TablePicker,q=c.editor.ui.SplitButton,u=c.editor.ui.TableButton=function(v){this.initOptions(v);this.initTableButton()};u.prototype={initTableButton:function(){var v=this;this.popup=new s({content:new t({onpicktable:function(w,y,x){v._onPickTable(y,x)},onmore:function(){v.popup.hide();v.fireEvent("more")}}),editor:v.editor});this.initSplitButton()},_onPickTable:function(w,v){if(this.fireEvent("picktable",w,v)!==false){this.popup.hide()}}};r.inherits(u,q)})();(function(){var q=c.editor.utils,r=c.editor.ui.UIBase;var s=c.editor.ui.AutoTypeSetPicker=function(t){this.initOptions(t);this.initAutoTypeSetPicker()};s.prototype={initAutoTypeSetPicker:function(){this.initUIBase()},getHtmlTpl:function(){var v=this.editor.options,y=v.autotypeset;for(var x=0,w=[],t,u=v.listMap.lineheight;t=u[x++];){w.push('<option value="'+t+'" '+(y.lineHeight==t?"checked":"")+">"+t+"</option>")}return'<div id="##" class="edui-autotypesetpicker %%"><div class="edui-autotypesetpicker-body"><table ><tr><td colspan="2"><input type="checkbox" name="mergeEmptyline" '+(y.mergeEmptyline?"checked":"")+'></td><td colspan="2"><input type="checkbox" name="removeEmptyline" '+(y.removeEmptyline?"checked":"")+'></td></tr><tr><td colspan="2"><input type="checkbox" name="removeClass" '+(y.removeClass?"checked":"")+'></td><td colspan="2"><input type="checkbox" name="indent" '+(y.indent?"checked":"")+'>2</td></tr><tr><td colspan="2"><input type="checkbox" name="textAlign" '+(y.textAlign?"checked":"")+'></td><td colspan="2" id="textAlignValue"><input type="radio" name="textAlignValue" value="left" '+((y.textAlign&&y.textAlign=="left")?"checked":"")+'><input type="radio" name="textAlignValue" value="center" '+((y.textAlign&&y.textAlign=="center")?"checked":"")+'><input type="radio" name="textAlignValue" value="right" '+((y.textAlign&&y.textAlign=="right")?"checked":"")+'> </tr><tr><td colspan="2"><input type="checkbox" name="imageBlockLine" '+(y.imageBlockLine?"checked":"")+'></td><td colspan="2" id="imageBlockLineValue"><input type="radio" name="imageBlockLineValue" value="none" '+((y.imageBlockLine&&y.imageBlockLine=="none")?"checked":"")+'><input type="radio" name="imageBlockLineValue" value="left" '+((y.imageBlockLine&&y.imageBlockLine=="left")?"checked":"")+'><input type="radio" name="imageBlockLineValue" value="center" '+((y.imageBlockLine&&y.imageBlockLine=="center")?"checked":"")+'><input type="radio" name="imageBlockLineValue" value="right" '+((y.imageBlockLine&&y.imageBlockLine=="right")?"checked":"")+'></tr><tr><td colspan="2"><input type="checkbox" name="clearFontSize" '+(y.clearFontSize?"checked":"")+'></td><td colspan="2"><input type="checkbox" name="clearFontFamily" '+(y.clearFontFamily?"checked":"")+'></td></tr><tr><td colspan="4"><input type="checkbox" name="removeEmptyNode" '+(y.removeEmptyNode?"checked":"")+'>html</td></tr><tr><td colspan="4"><input type="checkbox" name="pasteFilter" '+(y.pasteFilter?"checked":"")+'> ()</td></tr><tr><td colspan="4" align="right"><button ></button></td></tr></table></div></div>'},_UIBase_render:r.prototype.render};q.inherits(s,r)})();(function(){var r=c.editor.utils,t=c.editor.ui.Popup,u=c.editor.ui.AutoTypeSetPicker,q=c.editor.ui.SplitButton,v=c.editor.ui.AutoTypeSetButton=function(w){this.initOptions(w);this.initAutoTypeSetButton()};function s(F){var x=F.editor.options.autotypeset,J=F.getDom(),D=e.getElementsByTagName(J,"input");for(var A=D.length-1,I;I=D[A--];){if(I.getAttribute("type")=="checkbox"){var G=I.getAttribute("name");x[G]&&delete x[G];if(I.checked){var B=document.getElementById(G+"Value");if(B){if(/input/ig.test(B.tagName)){x[G]=B.value}else{var w=B.getElementsByTagName("input");for(var y=w.length-1,H;H=w[y--];){if(H.checked){x[G]=H.value;break}}}}else{x[G]=true}}}}var E=e.getElementsByTagName(J,"select");for(var A=0,z;z=E[A++];){var C=z.getAttribute("name");x[C]=x[C]?z.value:""}F.editor.options.autotypeset=x}v.prototype={initAutoTypeSetButton:function(){var x=this;this.popup=new t({content:new u({editor:x.editor}),editor:x.editor,hide:function(){if(!this._hidden&&this.getDom()){s(this);this.getDom().style.display="none";this._hidden=true;this.fireEvent("hide")}}});var w=0;this.popup.addListener("postRenderAfter",function(){var z=this;if(w){return}var y=this.getDom(),A=y.getElementsByTagName("button")[0];A.onclick=function(){s(z);x.editor.execCommand("autotypeset")};w=1});this.initSplitButton()}};r.inherits(v,q)})();(function(){var q=c.editor.utils,r=c.editor.ui.uiUtils,t=c.editor.ui.UIBase,s=c.editor.ui.Toolbar=function(u){this.initOptions(u);this.initToolbar()};s.prototype={items:null,initToolbar:function(){this.items=this.items||[];this.initUIBase()},add:function(u){this.items.push(u)},getHtmlTpl:function(){var v=[];for(var u=0;u<this.items.length;u++){v[u]=this.items[u].renderHtml()}return'<div id="##" class="edui-toolbar %%" onselectstart="return false;" onmousedown="return $$._onMouseDown(event, this);">'+v.join("")+"</div>"},postRender:function(){var v=this.getDom();for(var u=0;u<this.items.length;u++){this.items[u].postRender()}r.makeUnselectable(v)},_onMouseDown:function(){return false}};q.inherits(s,t)})();(function(){var x=c.editor.utils,t=c.editor.dom.domUtils,r=c.editor.ui.uiUtils,s=c.editor.ui.UIBase,y=c.editor.ui.Popup,q=c.editor.ui.Stateful,u=c.editor.ui.Menu=function(z){this.initOptions(z);this.initMenu()};var v={renderHtml:function(){return'<div class="edui-menuitem edui-menuseparator"><div class="edui-menuseparator-inner"></div></div>'},postRender:function(){},queryAutoHide:function(){return true}};u.prototype={items:null,uiName:"menu",initMenu:function(){this.items=this.items||[];this.initPopup();this.initItems()},initItems:function(){for(var z=0;z<this.items.length;z++){var A=this.items[z];if(A=="-"){this.items[z]=this.getSeparator()}else{if(!(A instanceof w)){this.items[z]=this.createItem(A)}}}},getSeparator:function(){return v},createItem:function(z){return new w(z)},_Popup_getContentHtmlTpl:y.prototype.getContentHtmlTpl,getContentHtmlTpl:function(){if(this.items.length==0){return this._Popup_getContentHtmlTpl()}var B=[];for(var z=0;z<this.items.length;z++){var A=this.items[z];B[z]=A.renderHtml()}return('<div class="%%-body">'+B.join("")+"</div>")},_Popup_postRender:y.prototype.postRender,postRender:function(){var B=this;for(var z=0;z<this.items.length;z++){var A=this.items[z];A.ownerMenu=this;A.postRender()}t.on(this.getDom(),"mouseover",function(D){D=D||event;var C=D.relatedTarget||D.fromElement;var E=B.getDom();if(!r.contains(E,C)&&E!==C){B.fireEvent("over")}});this._Popup_postRender()},queryAutoHide:function(A){if(A){if(r.contains(this.getDom(),A)){return false}for(var z=0;z<this.items.length;z++){var B=this.items[z];if(B.queryAutoHide(A)===false){return false}}}},clearItems:function(){for(var z=0;z<this.items.length;z++){var A=this.items[z];clearTimeout(A._showingTimer);clearTimeout(A._closingTimer);if(A.subMenu){A.subMenu.destroy()}}this.items=[]},destroy:function(){if(this.getDom()){t.remove(this.getDom())}this.clearItems()},dispose:function(){this.destroy()}};x.inherits(u,y);var w=c.editor.ui.MenuItem=function(z){this.initOptions(z);this.initUIBase();this.Stateful_init();if(this.subMenu&&!(this.subMenu instanceof u)){this.subMenu=new u(this.subMenu)}};w.prototype={label:"",subMenu:null,ownerMenu:null,uiName:"menuitem",alwalysHoverable:true,getHtmlTpl:function(){return'<div id="##" class="%%" stateful onclick="$$._onClick(event, this);"><div class="%%-body">'+this.renderLabelHtml()+"</div></div>"},postRender:function(){var z=this;this.addListener("over",function(){z.ownerMenu.fireEvent("submenuover",z);if(z.subMenu){z.delayShowSubMenu()}});if(this.subMenu){this.getDom().className+=" edui-hassubmenu";this.subMenu.render();this.addListener("out",function(){z.delayHideSubMenu()});this.subMenu.addListener("over",function(){clearTimeout(z._closingTimer);z._closingTimer=null;z.addState("opened")});this.ownerMenu.addListener("hide",function(){z.hideSubMenu()});this.ownerMenu.addListener("submenuover",function(B,A){if(A!==z){z.delayHideSubMenu()}});this.subMenu._bakQueryAutoHide=this.subMenu.queryAutoHide;this.subMenu.queryAutoHide=function(A){if(A&&r.contains(z.getDom(),A)){return false}return this._bakQueryAutoHide(A)}}this.getDom().style.tabIndex="-1";r.makeUnselectable(this.getDom());this.Stateful_postRender()},delayShowSubMenu:function(){var z=this;if(!z.isDisabled()){z.addState("opened");clearTimeout(z._showingTimer);clearTimeout(z._closingTimer);z._closingTimer=null;z._showingTimer=setTimeout(function(){z.showSubMenu()},250)}},delayHideSubMenu:function(){var z=this;if(!z.isDisabled()){z.removeState("opened");clearTimeout(z._showingTimer);if(!z._closingTimer){z._closingTimer=setTimeout(function(){if(!z.hasState("opened")){z.hideSubMenu()}z._closingTimer=null},400)}}},renderLabelHtml:function(){return'<div class="edui-arrow"></div><div class="edui-box edui-icon"></div><div class="edui-box edui-label %%-label">'+(this.label||"")+"</div>"},getStateDom:function(){return this.getDom()},queryAutoHide:function(z){if(this.subMenu&&this.hasState("opened")){return this.subMenu.queryAutoHide(z)}},_onClick:function(z,A){if(this.hasState("disabled")){return}if(this.fireEvent("click",z,A)!==false){if(this.subMenu){this.showSubMenu()}else{y.postHide()}}},showSubMenu:function(){var z=r.getClientRect(this.getDom());z.right-=5;z.left+=2;z.width-=7;z.top-=4;z.bottom+=4;z.height+=8;this.subMenu.showAnchorRect(z,true,true)},hideSubMenu:function(){this.subMenu.hide()}};x.inherits(w,s);x.extend(w.prototype,q,true)})();(function(){var r=c.editor.utils,t=c.editor.ui.uiUtils,u=c.editor.ui.Menu,q=c.editor.ui.SplitButton,s=c.editor.ui.Combox=function(v){this.initOptions(v);this.initCombox()};s.prototype={uiName:"combox",initCombox:function(){var x=this;this.items=this.items||[];for(var v=0;v<this.items.length;v++){var w=this.items[v];w.uiName="listitem";w.index=v;w.onclick=function(){x.selectByIndex(this.index)}}this.popup=new u({items:this.items,uiName:"list",editor:this.editor});this.initSplitButton()},_SplitButton_postRender:q.prototype.postRender,postRender:function(){this._SplitButton_postRender();this.setLabel(this.label||"");this.setValue(this.initValue||"")},showPopup:function(){var v=t.getClientRect(this.getDom());v.top+=1;v.bottom-=1;v.height-=2;this.popup.showAnchorRect(v)},getValue:function(){return this.value},setValue:function(w){var v=this.indexByValue(w);if(v!=-1){this.selectedIndex=v;this.setLabel(this.items[v].label);this.value=this.items[v].value}else{this.selectedIndex=-1;this.setLabel(this.getLabelForUnknowValue(w));this.value=w}},setLabel:function(v){this.getDom("button_body").innerHTML=v;this.label=v},getLabelForUnknowValue:function(v){return v},indexByValue:function(w){for(var v=0;v<this.items.length;v++){if(w==this.items[v].value){return v}}return -1},getItem:function(v){return this.items[v]},selectByIndex:function(v){if(v<this.items.length&&this.fireEvent("select",v)!==false){this.selectedIndex=v;this.value=this.items[v].value;this.setLabel(this.items[v].label)}}};r.inherits(s,q)})();(function(){var x=c.editor.utils,t=c.editor.dom.domUtils,q=c.editor.ui.uiUtils,u=c.editor.ui.Mask,r=c.editor.ui.UIBase,v=c.editor.ui.Button,w=c.editor.ui.Dialog=function(z){this.initOptions(z);this.initDialog()};var s;var y;w.prototype={draggable:false,uiName:"dialog",initDialog:function(){var A=this;this.initUIBase();this.modalMask=(s||(s=new u({className:"edui-dialog-modalmask"})));this.dragMask=(y||(y=new u({className:"edui-dialog-dragmask"})));this.closeButton=new v({className:"edui-dialog-closebutton",title:"",onclick:function(){A.close(false)}});if(this.buttons){for(var z=0;z<this.buttons.length;z++){if(!(this.buttons[z] instanceof v)){this.buttons[z]=new v(this.buttons[z])}}}},fitSize:function(){var z=this.getDom("body");var A=this.mesureSize();z.style.width=A.width+"px";z.style.height=A.height+"px";return A},safeSetOffset:function(F){var B=this;var z=B.getDom();var E=q.getViewportRect();var A=q.getClientRect(z);var D=F.left;if(D+A.width>E.right){D=E.right-A.width}var C=F.top;if(C+A.height>E.bottom){C=E.bottom-A.height}z.style.left=Math.max(D,0)+"px";z.style.top=Math.max(C,0)+"px"},showAtCenter:function(){this.getDom().style.display="";var E=q.getViewportRect();var z=this.fitSize();var D=this.getDom("titlebar").offsetHeight|0;var C=E.width/2-z.width/2;var B=E.height/2-(z.height-D)/2-D;var A=this.getDom();this.safeSetOffset({left:Math.max(C|0,0),top:Math.max(B|0,0)});if(!t.hasClass(A,"edui-state-centered")){A.className+=" edui-state-centered"}this._show()},getContentHtml:function(){var z="";if(typeof this.content=="string"){z=this.content}else{if(this.iframeUrl){z='<iframe id="'+this.id+'_iframe" class="%%-iframe" height="100%" width="100%" frameborder="0" src="'+this.iframeUrl+'"></iframe>'}}return z},getHtmlTpl:function(){var A="";if(this.buttons){var B=[];for(var z=0;z<this.buttons.length;z++){B[z]=this.buttons[z].renderHtml()}A='<div class="%%-foot"><div id="##_buttons" class="%%-buttons">'+B.join("")+"</div></div>"}return'<div id="##" class="%%"><div class="%%-wrap"><div id="##_body" class="%%-body"><div class="%%-shadow"></div><div id="##_titlebar" class="%%-titlebar"><div class="%%-draghandle" onmousedown="$$._onTitlebarMouseDown(event, this);"><span class="%%-caption">'+(this.title||"")+"</span></div>"+this.closeButton.renderHtml()+'</div><div id="##_content" class="%%-content">'+(this.autoReset?"":this.getContentHtml())+"</div>"+A+"</div></div></div>"},postRender:function(){if(!this.modalMask.getDom()){this.modalMask.render();this.modalMask.hide()}if(!this.dragMask.getDom()){this.dragMask.render();this.dragMask.hide()}var A=this;this.addListener("show",function(){A.modalMask.show(this.getDom().style.zIndex-2)});this.addListener("hide",function(){A.modalMask.hide()});if(this.buttons){for(var z=0;z<this.buttons.length;z++){this.buttons[z].postRender()}}t.on(window,"resize",function(){setTimeout(function(){if(!A.isHidden()){A.safeSetOffset(q.getClientRect(A.getDom()))}})});this._hide()},mesureSize:function(){var z=this.getDom("body");var A=q.getClientRect(this.getDom("content")).width;var B=z.style;B.width=A;return q.getClientRect(z)},_onTitlebarMouseDown:function(z,A){if(this.draggable){var C;var D=q.getViewportRect();var B=this;q.startDrag(z,{ondragstart:function(){C=q.getClientRect(B.getDom());B.dragMask.show(B.getDom().style.zIndex-1)},ondragmove:function(E,H){var G=C.left+E;var F=C.top+H;B.safeSetOffset({left:G,top:F})},ondragstop:function(){t.removeClasses(B.getDom(),["edui-state-centered"]);B.dragMask.hide()}})}},reset:function(){this.getDom("content").innerHTML=this.getContentHtml()},_show:function(){if(this._hidden){this.getDom().style.display="";this.editor.container.style.zIndex&&(this.getDom().style.zIndex=this.editor.container.style.zIndex*1+10);this._hidden=false;this.fireEvent("show");c.editor.ui.uiUtils.getFixedLayer().style.zIndex=this.getDom().style.zIndex-4}},isHidden:function(){return this._hidden},_hide:function(){if(!this._hidden){this.getDom().style.display="none";this.getDom().style.zIndex="";this._hidden=true;this.fireEvent("hide")}},open:function(){if(this.autoReset){this.reset()}this.showAtCenter();if(this.iframeUrl){try{this.getDom("iframe").focus()}catch(z){}}},_onCloseButtonClick:function(z,A){this.close(false)},close:function(z){if(this.fireEvent("close",z)!==false){this._hide()}}};x.inherits(w,r)})();(function(){var r=c.editor.utils,s=c.editor.ui.Menu,q=c.editor.ui.SplitButton,t=c.editor.ui.MenuButton=function(u){this.initOptions(u);this.initMenuButton()};t.prototype={initMenuButton:function(){var u=this;this.uiName="menubutton";this.popup=new s({items:u.items,className:u.className,editor:u.editor});this.popup.addListener("show",function(){var w=this;for(var v=0;v<w.items.length;v++){w.items[v].removeState("checked");if(w.items[v].value==u._value){w.items[v].addState("checked");this.value=u._value}}});this.initSplitButton()},setValue:function(u){this._value=u}};r.inherits(t,q)})();(function(){var r=c.editor.browser.ie;var y=c.editor.utils;var x=c.editor.ui;var v=x.Dialog;x.Dialog=function(A){var B=new v(A);B.addListener("hide",function(){if(B.editor){var D=B.editor;try{D.focus()}catch(C){}}});return B};var u,t;var w=["Undo","Redo","FormatMatch","Bold","Italic","Underline","StrikeThrough","Subscript","Superscript","Source","Indent","Outdent","BlockQuote","PastePlain","PageBreak","SelectAll","Print","Preview","Horizontal","RemoveFormat","Time","Date","Unlink","InsertParagraphBeforeTable","InsertRow","InsertCol","MergeRight","MergeDown","DeleteRow","DeleteCol","SplittoRows","SplittoCols","SplittoCells","MergeCells","DeleteTable"];u=w.length;while(u--){t=w[u];x[t]=function(A){return function(B,D){D=D||B.options.labelMap[A.toLowerCase()]||"";var C=new x.Button({className:"edui-for-"+A.toLowerCase(),title:D,onclick:function(){B.execCommand(A)},showText:false});B.addListener("selectionchange",function(F,E,H){var G=B.queryCommandState(A.toLowerCase());if(G==-1){C.setDisabled(true);C.setChecked(false)}else{if(!H){C.setDisabled(false);C.setChecked(G)}}});return C}}(t)}x.SnapScreen=function(C,F){var E="SnapScreen";F=F||C.options.labelMap[E.toLowerCase()]||"";var D=new x.Button({className:"edui-for-"+E.toLowerCase(),title:F,onclick:function(){C.execCommand(E)}});if(r){var B=C.options.iframeUrlMap.snapscreen;B=C.ui.mapUrl(B);F=F||C.options.labelMap.snapscreen||"";var A=new x.Dialog({iframeUrl:B,autoReset:true,draggable:true,editor:C,className:"edui-for-snapscreen",title:F,buttons:[{className:"edui-okbutton",label:"",onclick:function(){A.close(true)}},{className:"edui-cancelbutton",label:"",onclick:function(){A.close(false)}}],onok:function(){},oncancel:function(){},onclose:function(H,G){if(G){return this.onok()}else{return this.oncancel()}}});A.render();C.snapscreenInstall=A}C.addListener("selectionchange",function(){var G=C.queryCommandState("snapscreen");D.setDisabled(G==-1)});return D};x.ClearDoc=function(A,D){var C="ClearDoc";D=D||A.options.labelMap[C.toLowerCase()]||"";var B=new x.Button({className:"edui-for-"+C.toLowerCase(),title:D,onclick:function(){if(confirm("")){A.execCommand("cleardoc")}}});A.addListener("selectionchange",function(){var E=A.queryCommandState("cleardoc");B.setDisabled(E==-1)});return B};x.Justify=function(B,A,D){A=(A||"left").toLowerCase();D=D||B.options.labelMap["justify"+A.toLowerCase()]||"";var C=new x.Button({className:"edui-for-justify"+A.toLowerCase(),title:D,onclick:function(){B.execCommand("Justify",A)}});B.addListener("selectionchange",function(F,E,I){var H=B.queryCommandState("Justify");C.setDisabled(H==-1);var G=B.queryCommandValue("Justify");C.setChecked(G==A&&!I)});return C};x.JustifyLeft=function(A,B){return x.Justify(A,"left",B)};x.JustifyCenter=function(A,B){return x.Justify(A,"center",B)};x.JustifyRight=function(A,B){return x.Justify(A,"right",B)};x.JustifyJustify=function(A,B){return x.Justify(A,"justify",B)};x.ImageFloat=function(B,A,D){A=(A||"none").toLowerCase();D=D||B.options.labelMap["image"+A.toLowerCase()]||"";var C=new x.Button({className:"edui-for-image"+A.toLowerCase(),title:D,onclick:function(){B.execCommand("imagefloat",A)}});B.addListener("selectionchange",function(E){var F=B.queryCommandState("imagefloat");C.setDisabled(F==-1);var F=B.queryCommandValue("imagefloat");C.setChecked(F==A)});return C};x.ImageNone=function(A,B){return x.ImageFloat(A,B)};x.ImageLeft=function(A,B){return x.ImageFloat(A,"left",B)};x.ImageRight=function(A,B){return x.ImageFloat(A,"right",B)};x.ImageCenter=function(A,B){return x.ImageFloat(A,"center",B)};x.Directionality=function(B,A,D){A=(A||"left").toLowerCase();D=D||B.options.labelMap["directionality"+A.toLowerCase()]||"";var C=new x.Button({className:"edui-for-directionality"+A.toLowerCase(),title:D,onclick:function(){B.execCommand("directionality",A)},type:A});B.addListener("selectionchange",function(F,E,I){var H=B.queryCommandState("directionality");C.setDisabled(H==-1);var G=B.queryCommandValue("directionality");C.setChecked(G==C.type&&!I)});return C};x.DirectionalityLtr=function(A,B){return new x.Directionality(A,"ltr",B)};x.DirectionalityRtl=function(A,B){return new x.Directionality(A,"rtl",B)};var z=["BackColor","ForeColor"];u=z.length;while(u--){t=z[u];x[t]=function(A){return function(B,D){D=D||B.options.labelMap[A.toLowerCase()]||"";var C=new x.ColorButton({className:"edui-for-"+A.toLowerCase(),color:"default",title:D,editor:B,onpickcolor:function(F,E){B.execCommand(A,E)},onpicknocolor:function(){B.execCommand(A,"default");this.setColor("transparent");this.color="default"},onbuttonclick:function(){B.execCommand(A,this.color)}});B.addListener("selectionchange",function(){var E=B.queryCommandState(A);if(E==-1){C.setDisabled(true)}else{C.setDisabled(false)}});return C}}(t)}var q=["SearchReplace","Help","Spechars"];u=q.length;while(u--){t=q[u];x[t]=function(A){A=A.toLowerCase();return function(D,C,F){C=C||D.options.iframeUrlMap[A.toLowerCase()]||"about:blank";C=D.ui.mapUrl(C);F=F||D.options.labelMap[A.toLowerCase()]||"";var B=new x.Dialog({iframeUrl:C,autoReset:true,draggable:true,editor:D,className:"edui-for-"+A,title:F,onok:function(){},oncancel:function(){},onclose:function(H,G){if(G){return this.onok()}else{return this.oncancel()}}});B.render();var E=new x.Button({className:"edui-for-"+A,title:F,onclick:function(){B.open()}});D.addListener("selectionchange",function(){var G=D.queryCommandState(A);if(G==-1){E.setDisabled(true)}else{E.setDisabled(false)}});return E}}(t)}var s=["Attachment","Anchor","Link","InsertImage","Map","GMap","InsertVideo","TableSuper","HighlightCode","InsertFrame","EditTd"];u=s.length;while(u--){t=s[u];x[t]=function(A){A=A.toLowerCase();return function(D,C,F){C=C||D.options.iframeUrlMap[A.toLowerCase()]||"about:blank";C=D.ui.mapUrl(C);F=F||D.options.labelMap[A.toLowerCase()]||"";var B=new x.Dialog({iframeUrl:C,autoReset:true,draggable:true,editor:D,className:"edui-for-"+A,title:F,buttons:[{className:"edui-okbutton",label:"",onclick:function(){B.close(true)}},{className:"edui-cancelbutton",label:"",onclick:function(){B.close(false)}}],onok:function(){},oncancel:function(){},onclose:function(H,G){if(G){return this.onok()}else{return this.oncancel()}}});B.render();var E=new x.Button({className:"edui-for-"+A,title:F,onclick:function(){B.open()}});D.addListener("selectionchange",function(){var G=D.queryCommandState(A);if(G==-1){E.setDisabled(true)}else{E.setChecked(G);E.setDisabled(false)}});return E}}(t)}x.WordImage=function(A){var B=new x.Button({className:"edui-for-wordimage",title:"",onclick:function(){A.execCommand("wordimage","word_img");A.ui._dialogs.wordImageDialog.open()}});A.addListener("selectionchange",function(){var C=A.queryCommandState("wordimage","word_img");if(C==-1){B.setDisabled(true)}else{B.setDisabled(false);B.setChecked(C)}});return B};x.FontFamily=function(C,D,I){D=D||C.options.listMap.fontfamily||[];I=I||C.options.labelMap.fontfamily||"";var E=[];for(var B=0;B<D.length;B++){var A=D[B];var G=C.options.fontMap[A];var J='"'+A+'"';var H=new RegExp(A,"i");if(G){J='"'+G.join('","')+'"';H=new RegExp("(?:\\|)"+G.join("|")+"(?:\\|)","i")}E.push({label:A,value:J,regex:H,renderLabelHtml:function(){return'<div class="edui-label %%-label" style="font-family:'+y.unhtml(this.value)+'">'+(this.label||"")+"</div>"}})}var F=new x.Combox({editor:C,items:E,onselect:function(L,K){C.execCommand("FontFamily",this.items[K].value)},onbuttonclick:function(){this.showPopup()},title:I,initValue:C.options.ComboxInitial.FONT_FAMILY,className:"edui-for-fontfamily",indexByValue:function(M){if(M){M="|"+M.replace(/,/g,"|").replace(/"/g,"")+"|";M.replace(/\s*|\s*/g,"|");for(var K=0;K<this.items.length;K++){var L=this.items[K];if(L.regex.test(M)){return K}}}return -1}});C.addListener("selectionchange",function(L,K,O){if(!O){var N=C.queryCommandState("FontFamily");if(N==-1){F.setDisabled(true)}else{F.setDisabled(false);var M=C.queryCommandValue("FontFamily");M&&(M=M.replace(/['"]/g,"").split(",")[0]);F.setValue(M)}}});return F};x.FontSize=function(D,F,G){F=F||D.options.listMap.fontsize||[];G=G||D.options.labelMap.fontsize||"";var A=[];for(var C=0;C<F.length;C++){var B=F[C]+"px";A.push({label:B,value:B,renderLabelHtml:function(){return'<div class="edui-label %%-label" style="font-size:'+this.value+'">'+(this.label||"")+"</div>"}})}var E=new x.Combox({editor:D,items:A,title:G,initValue:D.options.ComboxInitial.FONT_SIZE,onselect:function(I,H){D.execCommand("FontSize",this.items[H].value)},onbuttonclick:function(){this.showPopup()},className:"edui-for-fontsize"});D.addListener("selectionchange",function(I,H,K){if(!K){var J=D.queryCommandState("FontSize");if(J==-1){E.setDisabled(true)}else{E.setDisabled(false);E.setValue(D.queryCommandValue("FontSize"))}}});return E};x.Paragraph=function(B,C,F){C=C||B.options.listMap.paragraph||[];F=F||B.options.labelMap.paragraph||"";var D=[];for(var A=0;A<C.length;A++){var H=C[A].split(":");var I=H[0];var G=H[1];D.push({label:G,value:I,renderLabelHtml:function(){return'<div class="edui-label %%-label"><span class="edui-for-'+this.value+'">'+(this.label||"")+"</span></div>"}})}var E=new x.Combox({editor:B,items:D,title:F,initValue:B.options.ComboxInitial.PARAGRAPH,className:"edui-for-paragraph",onselect:function(K,J){B.execCommand("Paragraph",this.items[J].value)},onbuttonclick:function(){this.showPopup()}});B.addListener("selectionchange",function(L,K,O){if(!O){var N=B.queryCommandState("Paragraph");if(N==-1){E.setDisabled(true)}else{E.setDisabled(false);var M=B.queryCommandValue("Paragraph");var J=E.indexByValue(M);if(J!=-1){E.setValue(M)}else{E.setValue(E.initValue)}}}});return E};x.CustomStyle=function(D,F,G){F=F||D.options.listMap.customstyle||[];G=G||D.options.labelMap.customstyle||"";for(var C=0,A=[],B;B=F[C++];){(function(H){A.push({label:H.label,value:H,renderLabelHtml:function(){return'<div class="edui-label %%-label"><'+H.tag+" "+(H.className?' class="'+H.className+'"':"")+(H.style?' style="'+H.style+'"':"")+">"+H.label+"</"+H.tag+"></div>"}})})(B)}var E=new x.Combox({editor:D,items:A,title:G,initValue:D.options.ComboxInitial.CUSTOMSTYLE,className:"edui-for-customstyle",onselect:function(I,H){D.execCommand("customstyle",this.items[H].value)},onbuttonclick:function(){this.showPopup()},indexByValue:function(J){for(var H=0,I;I=this.items[H++];){if(I.label==J){return H-1}}return -1}});D.addListener("selectionchange",function(J,I,M){if(!M){var L=D.queryCommandState("customstyle");if(L==-1){E.setDisabled(true)}else{E.setDisabled(false);var K=D.queryCommandValue("customstyle");var H=E.indexByValue(K);if(H!=-1){E.setValue(K)}else{E.setValue(E.initValue)}}}});return E};x.InsertTable=function(C,B,E){B=B||C.options.iframeUrlMap.inserttable||"about:blank";B=C.ui.mapUrl(B);E=E||C.options.labelMap.inserttable||"";var A=new x.Dialog({iframeUrl:B,autoReset:true,draggable:true,editor:C,className:"edui-for-inserttable",title:E,buttons:[{className:"edui-okbutton",label:"",onclick:function(){A.close(true)}},{className:"edui-cancelbutton",label:"",onclick:function(){A.close(false)}}],onok:function(){},oncancel:function(){},onclose:function(G,F){if(F){return this.onok()}else{return this.oncancel()}}});A.render();C.tableDialog=A;var D=new x.TableButton({editor:C,title:E,className:"edui-for-inserttable",onpicktable:function(F,H,G){C.execCommand("InsertTable",{numRows:G,numCols:H})},onmore:function(){A.open()},onbuttonclick:function(){A.open()}});C.addListener("selectionchange",function(){var F=C.queryCommandState("inserttable");if(F==-1){D.setDisabled(true)}else{D.setDisabled(false)}});return D};x.AutoTypeSet=function(B,A,D){D=D||B.options.labelMap.autotypeset||"";var C=new x.AutoTypeSetButton({editor:B,title:D,className:"edui-for-autotypeset",onbuttonclick:function(){B.execCommand("autotypeset")}});B.addListener("selectionchange",function(){C.setDisabled(B.queryCommandState("autotypeset")==-1)});return C};x.LineHeight=function(D,F){for(var C=0,B,A=[];B=D.options.listMap.lineheight[C++];){A.push({label:B=="1"?"":B,value:B,onclick:function(){D.execCommand("lineheight",this.value)}})}var E=new x.MenuButton({editor:D,className:"edui-for-lineheight",title:F||D.options.labelMap.lineheight||"",items:A,onbuttonclick:function(){var G=D.queryCommandValue("LineHeight")||this.value;D.execCommand("LineHeight",G)}});D.addListener("selectionchange",function(){var H=D.queryCommandState("LineHeight");if(H==-1){E.setDisabled(true)}else{E.setDisabled(false);var G=D.queryCommandValue("LineHeight");G&&E.setValue((G+"").replace(/cm/,""));E.setChecked(H)}});return E};x.RowSpacingTop=function(D,F){for(var C=0,B,A=[];B=D.options.listMap.rowspacing[C++];){A.push({label:B,value:B,onclick:function(){D.execCommand("rowspacing",this.value,"top")}})}var E=new x.MenuButton({editor:D,className:"edui-for-rowspacingtop",title:F||D.options.labelMap.rowspacingtop||"",items:A,onbuttonclick:function(){var G=D.queryCommandValue("rowspacing","top")||this.value;D.execCommand("rowspacing",G,"top")}});D.addListener("selectionchange",function(){var H=D.queryCommandState("rowspacing","top");if(H==-1){E.setDisabled(true)}else{E.setDisabled(false);var G=D.queryCommandValue("rowspacing","top");G&&E.setValue((G+"").replace(/%/,""));E.setChecked(H)}});return E};x.RowSpacingBottom=function(D,F){for(var C=0,B,A=[];B=D.options.listMap.rowspacing[C++];){A.push({label:B,value:B,onclick:function(){D.execCommand("rowspacing",this.value,"bottom")}})}var E=new x.MenuButton({editor:D,className:"edui-for-rowspacingbottom",title:F||D.options.labelMap.rowspacingbottom||"",items:A,onbuttonclick:function(){var G=D.queryCommandValue("rowspacing","bottom")||this.value;D.execCommand("rowspacing",G,"bottom")}});D.addListener("selectionchange",function(){var H=D.queryCommandState("rowspacing","bottom");if(H==-1){E.setDisabled(true)}else{E.setDisabled(false);var G=D.queryCommandValue("rowspacing","bottom");G&&E.setValue((G+"").replace(/%/,""));E.setChecked(H)}});return E};x.InsertOrderedList=function(A,C){C=C||A.options.labelMap.insertorderedlist||"";var D=function(){A.execCommand("InsertOrderedList",this.value)};var B=new x.MenuButton({editor:A,className:"edui-for-insertorderedlist",title:C,items:[{label:"1,2,3...",value:"decimal",onclick:D},{label:"a,b,c ...",value:"lower-alpha",onclick:D},{label:"i,ii,iii...",value:"lower-roman",onclick:D},{label:"A,B,C",value:"upper-alpha",onclick:D},{label:"I,II,III...",value:"upper-roman",onclick:D}],onbuttonclick:function(){var E=A.queryCommandValue("InsertOrderedList")||this.value;A.execCommand("InsertOrderedList",E)}});A.addListener("selectionchange",function(){var F=A.queryCommandState("InsertOrderedList");if(F==-1){B.setDisabled(true)}else{B.setDisabled(false);var E=A.queryCommandValue("InsertOrderedList");B.setValue(E);B.setChecked(F)}});return B};x.InsertUnorderedList=function(A,C){C=C||A.options.labelMap.insertunorderedlist||"";var D=function(){A.execCommand("InsertUnorderedList",this.value)};var B=new x.MenuButton({editor:A,className:"edui-for-insertunorderedlist",title:C,items:[{label:" ",value:"circle",onclick:D},{label:" ",value:"disc",onclick:D},{label:" ",value:"square",onclick:D}],onbuttonclick:function(){var E=A.queryCommandValue("InsertUnorderedList")||this.value;A.execCommand("InsertUnorderedList",E)}});A.addListener("selectionchange",function(){var F=A.queryCommandState("InsertUnorderedList");if(F==-1){B.setDisabled(true)}else{B.setDisabled(false);var E=A.queryCommandValue("InsertUnorderedList");B.setValue(E);B.setChecked(F)}});return B};x.FullScreen=function(A,C){C=C||A.options.labelMap.fullscreen||"";var B=new x.Button({className:"edui-for-fullscreen",title:C,onclick:function(){if(A.ui){A.ui.setFullScreen(!A.ui.isFullScreen())}this.setChecked(A.ui.isFullScreen())}});A.addListener("selectionchange",function(){var D=A.queryCommandState("fullscreen");B.setDisabled(D==-1);B.setChecked(A.ui.isFullScreen())});return B};x.Emotion=function(B,A,D){D=D||B.options.labelMap.emotion||"";A=A||B.options.iframeUrlMap.emotion||"about:blank";A=B.ui.mapUrl(A);var C=new x.MultiMenuPop({title:D,editor:B,className:"edui-for-emotion",iframeUrl:A});B.addListener("selectionchange",function(){var E=B.queryCommandState("emotion");if(E==-1){C.setDisabled(true)}else{C.setDisabled(false)}});return C}})();(function(){var q=c.editor.utils,s=c.editor.ui.uiUtils,t=c.editor.ui.UIBase;function r(u){this.initOptions(u);this.initEditorUI()}r.prototype={uiName:"editor",initEditorUI:function(){this.editor.ui=this;this._dialogs={};this.initUIBase();this._initToolbars();var D=this.editor,z=D.options.iframeUrlMap;D.addListener("ready",function(){c.editor.dom.domUtils.on(D.window,"scroll",function(){c.editor.ui.Popup.postHide()});if(D.options.elementPathEnabled){D.ui.getDom("elementpath").innerHTML='<div class="edui-editor-breadcrumb">path:</div>'}if(D.options.wordCount){D.ui.getDom("wordcount").innerHTML=""}if(!D.selection.isFocus()){return}D.fireEvent("selectionchange",false,true)});D.addListener("mousedown",function(I,H){var J=H.target||H.srcElement;c.editor.ui.Popup.postHide(J)});D.addListener("contextmenu",function(I,H){c.editor.ui.Popup.postHide()});var E=this;D.addListener("selectionchange",function(){if(!D.selection.isFocus()){return}E._updateElementPath();E._wordCount()});D.addListener("sourcemodechanged",function(H,I){if(D.options.elementPathEnabled){if(I){E.disableElementPath()}else{E.enableElementPath()}}if(D.options.wordCount){if(I){E.disableWordCount()}else{E.enableWordCount()}}});var G=new c.editor.ui.Dialog({iframeUrl:z?D.ui.mapUrl(z.link):"",autoReset:true,draggable:true,editor:D,className:"edui-for-link",title:"",buttons:[{className:"edui-okbutton",label:"",onclick:function(){G.close(true)}},{className:"edui-cancelbutton",label:"",onclick:function(){G.close(false)}}],onok:function(){},oncancel:function(){},onclose:function(I,H){if(H){return this.onok()}else{return this.oncancel()}}});G.render();var A=new c.editor.ui.Dialog({iframeUrl:z?D.ui.mapUrl(z.insertimage):"",autoReset:true,draggable:true,editor:D,className:"edui-for-insertimage",title:"",buttons:[{className:"edui-okbutton",label:"",onclick:function(){A.close(true)}},{className:"edui-cancelbutton",label:"",onclick:function(){A.close(false)}}],onok:function(){},oncancel:function(){},onclose:function(I,H){if(H){return this.onok()}else{return this.oncancel()}}});A.render();var B=new c.editor.ui.Dialog({iframeUrl:z?D.ui.mapUrl(z.anchor):"",autoReset:true,draggable:true,editor:D,className:"edui-for-anchor",title:"",buttons:[{className:"edui-okbutton",label:"",onclick:function(){B.close(true)}},{className:"edui-cancelbutton",label:"",onclick:function(){B.close(false)}}],onok:function(){},oncancel:function(){},onclose:function(I,H){if(H){return this.onok()}else{return this.oncancel()}}});B.render();var y=new c.editor.ui.Dialog({iframeUrl:z?D.ui.mapUrl(z.insertvideo):"",autoReset:true,draggable:true,editor:D,className:"edui-for-insertvideo",title:"",buttons:[{className:"edui-okbutton",label:"",onclick:function(){y.close(true)}},{className:"edui-cancelbutton",label:"",onclick:function(){y.close(false)}}],onok:function(){},oncancel:function(){},onclose:function(I,H){if(H){return this.onok()}else{return this.oncancel()}}});y.render();var w=new c.editor.ui.Dialog({iframeUrl:z?D.ui.mapUrl(z.wordimage):"",autoReset:true,draggable:true,editor:D,className:"edui-for-wordimage",title:"",buttons:[{className:"edui-okbutton",label:"",onclick:function(){w.close(true)}},{className:"edui-cancelbutton",label:"",onclick:function(){w.close(false)}}],onok:function(){},oncancel:function(){},onclose:function(I,H){if(H){return this.onok()}else{return this.oncancel()}}});w.render();E._dialogs.wordImageDialog=w;var v=new c.editor.ui.Dialog({iframeUrl:z?E.mapUrl(z.edittd):"about:blank",autoReset:true,draggable:true,editor:D,className:"edui-for-edittd",title:"",buttons:[{className:"edui-okbutton",label:"",onclick:function(){v.close(true)}},{className:"edui-cancelbutton",label:"",onclick:function(){v.close(false)}}],onok:function(){},oncancel:function(){},onclose:function(I,H){if(H){return this.onok()}else{return this.oncancel()}}});v.render();E._dialogs.tdDialog=v;var x=new c.editor.ui.Dialog({iframeUrl:z?D.ui.mapUrl(z.map):"",autoReset:true,draggable:true,editor:D,className:"edui-for-map",title:"",buttons:[{className:"edui-okbutton",label:"",onclick:function(){x.close(true)}},{className:"edui-cancelbutton",label:"",onclick:function(){x.close(false)}}],onok:function(){},oncancel:function(){},onclose:function(I,H){if(H){return this.onok()}else{return this.oncancel()}}});x.render();var C=new c.editor.ui.Dialog({iframeUrl:z?D.ui.mapUrl(z.gmap):"",autoReset:true,draggable:true,editor:D,className:"edui-for-gmap",title:"Google",buttons:[{className:"edui-okbutton",label:"",onclick:function(){C.close(true)}},{className:"edui-cancelbutton",label:"",onclick:function(){C.close(false)}}],onok:function(){},oncancel:function(){},onclose:function(I,H){if(H){return this.onok()}else{return this.oncancel()}}});C.render();var u=new c.editor.ui.Popup({editor:D,content:"",className:"edui-bubble",_onEditButtonClick:function(){this.hide();G.open()},_onImgEditButtonClick:function(){this.hide();var I=D.selection.getRange().getClosedNode();var H=c.editor.dom.domUtils.findParentByTagName(I,"img",true);if(H&&H.className.indexOf("edui-faked-video")!=-1){y.open()}else{if(H&&H.src.indexOf("http://api.map.baidu.com")!=-1){x.open()}else{if(H&&H.src.indexOf("http://maps.google.com/maps/api/staticmap")!=-1){C.open()}else{if(H&&H.getAttribute("anchorname")){B.open()}else{if(H&&H.getAttribute("word_img")){D.word_img=[H.getAttribute("word_img")];D.ui._dialogs.wordImageDialog.open()}else{A.open()}}}}}},_getImg:function(){var H=D.selection.getRange().getClosedNode();if(H&&(H.nodeName=="img"||H.nodeName=="IMG")){return H}return null},_onImgSetFloat:function(I){if(this._getImg()){D.execCommand("imagefloat",I);var H=this._getImg();if(H){this.showAnchor(H)}}},_setIframeAlign:function(H){var I=u.anchorEl;var J=I.cloneNode(true);switch(H){case -2:J.setAttribute("align","");break;case -1:J.setAttribute("align","left");break;case 1:J.setAttribute("align","right");break;case 2:J.setAttribute("align","middle");break}I.parentNode.insertBefore(J,I);c.editor.dom.domUtils.remove(I);u.anchorEl=J;u.showAnchor(u.anchorEl)},_updateIframe:function(){D._iframe=u.anchorEl;F.open();u.hide()},_onRemoveButtonClick:function(){var I=D.selection.getRange().getClosedNode();var H=c.editor.dom.domUtils.findParentByTagName(I,"img",true);if(H&&H.getAttribute("anchorname")){D.execCommand("anchor")}else{D.execCommand("unlink")}this.hide()},queryAutoHide:function(H){if(H&&H.ownerDocument==D.document){if(H.tagName.toLowerCase()=="img"||c.editor.dom.domUtils.findParentByTagName(H,"a",true)){return H!==u.anchorEl}}return c.editor.ui.Popup.prototype.queryAutoHide.call(this,H)}});u.render();var F=new c.editor.ui.Dialog({iframeUrl:z?D.ui.mapUrl(z.insertframe):"",autoReset:true,draggable:true,editor:D,className:"edui-for-insertframe",title:"iframe",buttons:[{className:"edui-okbutton",label:"",onclick:function(){F.close(true)}},{className:"edui-cancelbutton",label:"",onclick:function(){F.close(false)}}],onok:function(){},oncancel:function(){},onclose:function(I,H){if(H){return this.onok()}else{return this.oncancel()}}});F.render();D.addListener("mouseover",function(J,H){H=H||window.event;var K=H.target||H.srcElement;if(/iframe/ig.test(K.tagName)&&D.options.imagePopup){var I=u.formatHtml('<nobr>: <span onclick=$$._setIframeAlign(-2) class="edui-clickable"></span>&nbsp;&nbsp;<span onclick=$$._setIframeAlign(-1) class="edui-clickable"></span>&nbsp;&nbsp;<span onclick=$$._setIframeAlign(1) class="edui-clickable"></span>&nbsp;&nbsp;<span onclick=$$._setIframeAlign(2) class="edui-clickable"></span> <span onclick="$$._updateIframe( this);" class="edui-clickable"></span></nobr>');if(I){u.getDom("content").innerHTML=I;u.anchorEl=K;u.showAnchor(u.anchorEl)}else{u.hide()}}});D.addListener("selectionchange",function(M,K){if(!K){return}var L="";var I=D.selection.getRange().getClosedNode();if(I!=null&&I.tagName.toLowerCase()=="img"){if(I.getAttribute("anchorname")){L+=u.formatHtml('<nobr>: <span onclick=$$._onImgEditButtonClick(event) class="edui-clickable"></span>&nbsp;&nbsp;<span onclick=$$._onRemoveButtonClick(event) class="edui-clickable"></span></nobr>')}else{if(D.options.imagePopup){L+=u.formatHtml('<nobr>: <span onclick=$$._onImgSetFloat("none") class="edui-clickable"></span>&nbsp;&nbsp;<span onclick=$$._onImgSetFloat("left") class="edui-clickable"></span>&nbsp;&nbsp;<span onclick=$$._onImgSetFloat("right") class="edui-clickable"></span>&nbsp;&nbsp;<span onclick=$$._onImgSetFloat("center") class="edui-clickable"></span> <span onclick="$$._onImgEditButtonClick(event, this);" class="edui-clickable"></span></nobr>')}}}var N;if(D.selection.getRange().collapsed){N=D.queryCommandValue("link")}else{N=D.selection.getStart()}N=c.editor.dom.domUtils.findParentByTagName(N,"a",true);var J;if(N!=null&&(J=(N.getAttribute("data_ue_src")||N.getAttribute("href",2)))!=null){var H=J;if(J.length>30){H=J.substring(0,20)+"..."}if(L){L+='<div style="height:5px;"></div>'}L+=u.formatHtml('<nobr>: <a target="_blank" href="'+J+'" title="'+J+'" >'+H+'</a> <span class="edui-clickable" onclick="$$._onEditButtonClick(event, this);"></span> <span class="edui-clickable" onclick="$$._onRemoveButtonClick(event, this);"> </span></nobr>');u.showAnchor(N)}if(L){u.getDom("content").innerHTML=L;u.anchorEl=I||N;u.showAnchor(u.anchorEl)}else{u.hide()}})},_initToolbars:function(){var A=this.editor;var C=this.toolbars||[];var w=[];for(var z=0;z<C.length;z++){var B=C[z];var x=new c.editor.ui.Toolbar();for(var y=0;y<B.length;y++){var u=B[y];var v=null;if(typeof u=="string"){if(u=="|"){u="Separator"}if(c.editor.ui[u]){v=new c.editor.ui[u](A)}if(u=="FullScreen"){if(w&&w[0]){w[0].items.splice(0,0,v)}else{x.items.splice(0,0,v)}continue}}else{v=u}if(v){x.add(v)}}w[z]=x}this.toolbars=w},getHtmlTpl:function(){return'<div id="##" class="%%"><div id="##_toolbarbox" class="%%-toolbarbox"><div id="##_toolbarboxouter" class="%%-toolbarboxouter"><div class="%%-toolbarboxinner">'+this.renderToolbarBoxHtml()+'</div></div><div id="##_toolbarmsg" class="%%-toolbarmsg" style="display:none;"><div id = "##_upload_dialog" class="%%-toolbarmsg-upload" onclick="$$.showWordImageDialog();"></div><div class="%%-toolbarmsg-close" onclick="$$.hideToolbarMsg();">x</div><div id="##_toolbarmsg_label" class="%%-toolbarmsg-label"></div><div style="height:0;overflow:hidden;clear:both;"></div></div></div><div id="##_iframeholder" class="%%-iframeholder"></div><div id="##_bottombar" class="%%-bottomContainer"><table><tr><td id="##_elementpath" class="%%-bottombar"></td><td id="##_wordcount" class="%%-wordcount"></td></tr></table></div></div>'},showWordImageDialog:function(){this.editor.execCommand("wordimage","word_img");this._dialogs.wordImageDialog.open()},renderToolbarBoxHtml:function(){var v=[];for(var u=0;u<this.toolbars.length;u++){v.push(this.toolbars[u].renderHtml())}return v.join("")},setFullScreen:function(x){if(this._fullscreen!=x){this._fullscreen=x;this.editor.fireEvent("beforefullscreenchange",x);var w=this.editor;if(c.editor.browser.gecko){var u=w.selection.getRange().createBookmark()}if(x){this._bakHtmlOverflow=document.documentElement.style.overflow;this._bakBodyOverflow=document.body.style.overflow;this._bakAutoHeight=this.editor.autoHeightEnabled;this._bakScrollTop=Math.max(document.documentElement.scrollTop,document.body.scrollTop);if(this._bakAutoHeight){w.autoHeightEnabled=false;this.editor.disableAutoHeight()}document.documentElement.style.overflow="hidden";document.body.style.overflow="hidden";this._bakCssText=this.getDom().style.cssText;this._bakCssText1=this.getDom("iframeholder").style.cssText;this._updateFullScreen()}else{this.getDom().style.cssText=this._bakCssText;this.getDom("iframeholder").style.cssText=this._bakCssText1;if(this._bakAutoHeight){w.autoHeightEnabled=true;this.editor.enableAutoHeight()}document.documentElement.style.overflow=this._bakHtmlOverflow;document.body.style.overflow=this._bakBodyOverflow;window.scrollTo(0,this._bakScrollTop)}if(c.editor.browser.gecko){var v=document.createElement("input");document.body.appendChild(v);w.body.contentEditable=false;setTimeout(function(){v.focus();setTimeout(function(){w.body.contentEditable=true;w.selection.getRange().moveToBookmark(u).select(true);c.editor.dom.domUtils.remove(v);x&&window.scroll(0,0)})})}this.editor.fireEvent("fullscreenchanged",x);this.triggerLayout()}},_wordCount:function(){var u=this.getDom("wordcount");if(!this.editor.options.wordCount){u.style.display="none";return}u.innerHTML=this.editor.queryCommandValue("wordcount")},disableWordCount:function(){var u=this.getDom("wordcount");u.innerHTML="";u.style.display="none";this.wordcount=false},enableWordCount:function(){var u=this.getDom("wordcount");u.style.display="";this.wordcount=true;this._wordCount()},_updateFullScreen:function(){if(this._fullscreen){var u=s.getViewportRect();this.getDom().style.cssText="border:0;position:absolute;left:0;top:0;width:"+u.width+"px;height:"+u.height+"px;z-index:"+(this.getDom().style.zIndex*1+100);s.setViewportOffset(this.getDom(),{left:0,top:0});this.editor.setHeight(u.height-this.getDom("toolbarbox").offsetHeight-this.getDom("bottombar").offsetHeight)}},_updateElementPath:function(){var u=this.getDom("elementpath"),x;if(this.elementPathEnabled&&(x=this.editor.queryCommandValue("elementpath"))){var y=[];for(var w=0,v;v=x[w];w++){y[w]=this.formatHtml('<span unselectable="on" onclick="$$.editor.execCommand(&quot;elementpath&quot;, &quot;'+w+'&quot;);">'+v+"</span>")}u.innerHTML='<div class="edui-editor-breadcrumb" onmousedown="return false;">path: '+y.join(" &gt; ")+"</div>"}else{u.style.display="none"}},disableElementPath:function(){var u=this.getDom("elementpath");u.innerHTML="";u.style.display="none";this.elementPathEnabled=false},enableElementPath:function(){var u=this.getDom("elementpath");u.style.display="";this.elementPathEnabled=true;this._updateElementPath()},isFullScreen:function(){return this._fullscreen},postRender:function(){t.prototype.postRender.call(this);for(var w=0;w<this.toolbars.length;w++){this.toolbars[w].postRender()}var x=this;var v,u=c.editor.dom.domUtils,y=function(){clearTimeout(v);v=setTimeout(function(){x._updateFullScreen()})};u.on(window,"resize",y);x.addListener("destroy",function(){u.un(window,"resize",y);clearTimeout(v)})},showToolbarMsg:function(x,v){this.getDom("toolbarmsg_label").innerHTML=x;this.getDom("toolbarmsg").style.display="";if(!v){var u=this.getDom("upload_dialog");u.style.display="none"}},hideToolbarMsg:function(){this.getDom("toolbarmsg").style.display="none"},mapUrl:function(u){return u.replace("~/",this.editor.options.UEDITOR_HOME_URL||"")},triggerLayout:function(){var u=this.getDom();if(u.style.zoom=="1"){u.style.zoom="100%"}else{u.style.zoom="1"}}};q.inherits(r,c.editor.ui.UIBase);c.editor.ui.Editor=function(u){var w=new c.editor.Editor(u);w.options.editor=w;new r(w.options);var v=w.render;w.render=function(z){if(z){if(z.constructor===String){z=document.getElementById(z)}z&&z.getAttribute("name")&&(w.options.textarea=z.getAttribute("name"));if(z&&/script|textarea/ig.test(z.tagName)){var y=document.createElement("div");z.parentNode.insertBefore(y,z);w.options.initialContent=z.value||z.innerHTML;z.id&&(y.id=z.id);z.className&&(y.className=z.className);z.style.cssText&&(y.style.cssText=z.style.cssText);z.parentNode.removeChild(z);z=y;z.innerHTML=""}}w.ui.render(z);var x=w.ui.getDom("iframeholder");w.container=w.ui.getDom();w.container.style.zIndex=w.options.zIndex;v.call(w,x)};return w}})();(function(){var s=c.editor.utils,t=c.editor.ui.Popup,r=c.editor.ui.SplitButton,q=c.editor.ui.MultiMenuPop=function(u){this.initOptions(u);this.initMultiMenu()};q.prototype={initMultiMenu:function(){var u=this;this.popup=new t({content:"",editor:u.editor,iframe_rendered:false,onshow:function(){if(!this.iframe_rendered){this.iframe_rendered=true;this.getDom("content").innerHTML='<iframe id="'+u.id+'_iframe" src="'+u.iframeUrl+'" frameborder="0"></iframe>';u.editor.container.style.zIndex&&(this.getDom().style.zIndex=u.editor.container.style.zIndex*1+1)}}});this.onbuttonclick=function(){this.showPopup()};this.initSplitButton()}};s.inherits(q,r)})();(function(){var s=e.isBlockElm,r=["TD","LI","PRE"],q=function(v,t,B,y){var x=v.createBookmark(),C=function(F){return F.nodeType==1?F.tagName.toLowerCase()!="br"&&!e.isBookmarkNode(F):!e.isWhitespace(F)},E;v.enlarge(true);var D=v.createBookmark(),w=e.getNextDomNode(D.start,false,C),A=v.cloneRange(),u;while(w&&!(e.getPosition(w,D.end)&e.POSITION_FOLLOWING)){if(w.nodeType==3||!s(w)){A.setStartBefore(w);while(w&&w!==D.end&&!s(w)){u=w;w=e.getNextDomNode(w,false,null,function(F){return !s(F)})}A.setEndAfter(u);E=v.document.createElement(t);if(B){e.setAttributes(E,B);if(y&&y=="customstyle"&&B.style){E.style.cssText=B.style}}E.appendChild(A.extractContents());if(e.isEmptyNode(E)){e.fillChar(v.document,E)}A.insertNode(E);var z=E.parentNode;if(s(z)&&!e.isBody(E.parentNode)&&n.indexOf(r,z.tagName)==-1){if(!(y&&y=="customstyle")){z.getAttribute("dir")&&E.setAttribute("dir",z.getAttribute("dir"));z.style.cssText&&(E.style.cssText=z.style.cssText+";"+E.style.cssText);z.style.textAlign&&!E.style.textAlign&&(E.style.textAlign=z.style.textAlign);z.style.textIndent&&!E.style.textIndent&&(E.style.textIndent=z.style.textIndent);z.style.padding&&!E.style.padding&&(E.style.padding=z.style.padding)}if(B&&/h\d/i.test(z.tagName)&&!/h\d/i.test(E.tagName)){e.setAttributes(z,B);if(y&&y=="customstyle"&&B.style){z.style.cssText=B.style}e.remove(E,true);E=z}else{e.remove(E.parentNode,true)}}if(n.indexOf(r,z.tagName)!=-1){w=z}else{w=E}w=e.getNextDomNode(w,false,C)}else{w=e.getNextDomNode(w,true,C)}}return v.moveToBookmark(D).moveToBookmark(x)};UE.commands.paragraph={execCommand:function(F,t,E,C){var B=new g.Range(this.document);if(this.currentSelectedArr&&this.currentSelectedArr.length>0){for(var A=0,u;u=this.currentSelectedArr[A++];){if(u.style.display=="none"){continue}if(e.isEmptyNode(u)){var y=this.document.createTextNode("paragraph");u.innerHTML="";u.appendChild(y)}q(B.selectNodeContents(u),t,E,C);if(y){var D=y.parentNode;e.remove(y);if(e.isEmptyNode(D)){e.fillNode(this.document,D)}}}var x=this.currentSelectedArr[0];if(e.isEmptyBlock(x)){B.setStart(x,0).setCursor(false,true)}else{B.selectNode(x).select()}}else{B=this.selection.getRange();if(B.collapsed){var z=this.document.createTextNode("p");B.insertNode(z);if(i.ie){var w=z.previousSibling;if(w&&e.isWhitespace(w)){e.remove(w)}w=z.nextSibling;if(w&&e.isWhitespace(w)){e.remove(w)}}}B=q(B,t,E,C);if(z){B.setStartBefore(z).collapse(true);D=z.parentNode;e.remove(z);if(e.isBlockElm(D)&&e.isEmptyNode(D)){e.fillNode(this.document,D)}}if(i.gecko&&B.collapsed&&B.startContainer.nodeType==1){var v=B.startContainer.childNodes[B.startOffset];if(v&&v.nodeType==1&&v.tagName.toLowerCase()==t){B.setStart(v,0).collapse(true)}}B.select()}return true},queryCommandValue:function(){var t=n.findNode(this.selection.getStartElementPath(),["p","h1","h2","h3","h4","h5","h6"]);return t?t.tagName.toLowerCase():""},queryCommandState:function(){return this.highlight?-1:0}}})();UE.commands.indent={execCommand:function(){var q=this,r=q.queryCommandState("indent")?"0em":q.options.indentValue||"2em";q.execCommand("Paragraph","p",{style:"text-indent:"+r})},queryCommandState:function(){if(this.highlight){return -1}var r=n.findNode(this.selection.getStartElementPath(),["p","h1","h2","h3","h4","h5","h6"]),q=r&&r.style.textIndent?parseInt(r.style.textIndent):"";return q?1:0}};UE.plugins.basestyle=function(){var t={bold:["strong","b"],italic:["em","i"],subscript:["sub"],superscript:["sup"]},s=function(v,u){var w=v.selection.getStartElementPath();return n.findNode(w,u)},r=this;for(var q in t){(function(v,u){r.commands[v]={execCommand:function(x){var w=new g.Range(r.document),C="";if(r.currentSelectedArr&&r.currentSelectedArr.length>0){for(var z=0,y;y=r.currentSelectedArr[z++];){if(y.style.display!="none"){w.selectNodeContents(y).select();!C&&(C=s(this,u));if(x=="superscript"||x=="subscript"){if(!C||C.tagName.toLowerCase()!=x){w.removeInlineStyle(["sub","sup"])}}C?w.removeInlineStyle(u):w.applyInlineStyle(u[0])}}w.selectNodeContents(r.currentSelectedArr[0]).select()}else{w=r.selection.getRange();C=s(this,u);if(w.collapsed){if(C){var B=r.document.createTextNode("");w.insertNode(B).removeInlineStyle(u);w.setStartBefore(B);e.remove(B)}else{var A=w.document.createElement(u[0]);if(x=="superscript"||x=="subscript"){B=r.document.createTextNode("");w.insertNode(B).removeInlineStyle(["sub","sup"]).setStartBefore(B).collapse(true)}w.insertNode(A).setStart(A,0)}w.collapse(true)}else{if(x=="superscript"||x=="subscript"){if(!C||C.tagName.toLowerCase()!=x){w.removeInlineStyle(["sub","sup"])}}C?w.removeInlineStyle(u):w.applyInlineStyle(u[0])}w.select()}return true},queryCommandState:function(){if(this.highlight){return -1}return s(this,u)?1:0}}})(q,t[q])}};UE.commands.removeformat={execCommand:function(C,F,q,A,B){var w=new RegExp("^(?:"+(F||this.options.removeFormatTags).replace(/,/g,"|")+")$","i"),u=q?[]:(A||this.options.removeFormatAttributes).split(","),x=new g.Range(this.document),y,t,z,r=function(G){return G.nodeType==1};function s(J){if(J.nodeType==3||J.tagName.toLowerCase()!="span"){return 0}if(i.ie){var H=J.attributes;if(H.length){for(var I=0,G=H.length;I<G;I++){if(H[I].specified){return 0}}return 1}}return !J.attributes.length}function D(M){var G=M.createBookmark();if(M.collapsed){M.enlarge(true)}if(!B){var H=e.findParentByTagName(M.startContainer,"a",true);if(H){M.setStartBefore(H)}H=e.findParentByTagName(M.endContainer,"a",true);if(H){M.setEndAfter(H)}}y=M.createBookmark();I=y.start;while((z=I.parentNode)&&!e.isBlockElm(z)){e.breakParent(I,z);e.clearEmptySibling(I)}if(y.end){I=y.end;while((z=I.parentNode)&&!e.isBlockElm(z)){e.breakParent(I,z);e.clearEmptySibling(I)}var N=e.getNextDomNode(y.start,false,r),L;while(N){if(N==y.end){break}L=e.getNextDomNode(N,true,r);if(!a.$empty[N.tagName.toLowerCase()]&&!e.isBookmarkNode(N)){if(w.test(N.tagName)){if(q){e.removeStyle(N,q);if(s(N)&&q!="text-decoration"){e.remove(N,true)}}else{e.remove(N,true)}}else{if(!a.$tableContent[N.tagName]&&!a.$list[N.tagName]){e.removeAttributes(N,u);if(s(N)){e.remove(N,true)}}}}N=L}}var O=y.start.parentNode;if(e.isBlockElm(O)&&!a.$tableContent[O.tagName]&&!a.$list[O.tagName]){e.removeAttributes(O,u)}O=y.end.parentNode;if(y.end&&e.isBlockElm(O)&&!a.$tableContent[O.tagName]&&!a.$list[O.tagName]){e.removeAttributes(O,u)}M.moveToBookmark(y).moveToBookmark(G);var I=M.startContainer,K,J=M.collapsed;while(I.nodeType==1&&e.isEmptyNode(I)&&a.$removeEmpty[I.tagName]){K=I.parentNode;M.setStartBefore(I);if(M.startContainer===M.endContainer){M.endOffset--}e.remove(I);I=K}if(!J){I=M.endContainer;while(I.nodeType==1&&e.isEmptyNode(I)&&a.$removeEmpty[I.tagName]){K=I.parentNode;M.setEndBefore(I);e.remove(I);I=K}}}if(this.currentSelectedArr&&this.currentSelectedArr.length){for(var v=0,E;E=this.currentSelectedArr[v++];){x.selectNodeContents(E);D(x)}x.selectNodeContents(this.currentSelectedArr[0]).select()}else{x=this.selection.getRange();D(x);x.select()}},queryCommandState:function(){return this.highlight?-1:0}};(function(){var r={forecolor:"color",backcolor:"background-color",fontsize:"font-size",fontfamily:"font-family",underline:"text-decoration",strikethrough:"text-decoration"};for(var q in r){(function(t,s){UE.commands[t]={execCommand:function(A,x){x=x||(this.queryCommandState(A)?"none":A=="underline"?"underline":"line-through");var w=this,v=this.selection.getRange(),z;if(x=="default"){if(v.collapsed){z=w.document.createTextNode("font");v.insertNode(z).select()}w.execCommand("removeFormat","span,a",s);if(z){v.setStartBefore(z).setCursor();e.remove(z)}}else{if(w.currentSelectedArr&&w.currentSelectedArr.length>0){for(var u=0,C;C=w.currentSelectedArr[u++];){v.selectNodeContents(C);v.applyInlineStyle("span",{style:s+":"+x})}v.selectNodeContents(this.currentSelectedArr[0]).select()}else{if(!v.collapsed){if((t=="underline"||t=="strikethrough")&&w.queryCommandValue(t)){w.execCommand("removeFormat","span,a",s)}v=w.selection.getRange();v.applyInlineStyle("span",{style:s+":"+x}).select()}else{var y=e.findParentByTagName(v.startContainer,"span",true);z=w.document.createTextNode("font");if(y&&!y.children.length&&!y[i.ie?"innerText":"textContent"].replace(o,"").length){v.insertNode(z);if(t=="underline"||t=="strikethrough"){v.selectNode(z).select();w.execCommand("removeFormat","span,a",s,null);y=e.findParentByTagName(z,"span",true);v.setStartBefore(z)}y.style.cssText=y.style.cssText+";"+s+":"+x;v.collapse(true).select()}else{v.insertNode(z);v.selectNode(z).select();y=v.document.createElement("span");if(t=="underline"||t=="strikethrough"){if(e.findParentByTagName(z,"a",true)){v.setStartBefore(z).setCursor();e.remove(z);return}w.execCommand("removeFormat","span,a",s)}y.style.cssText=s+":"+x;z.parentNode.insertBefore(y,z);if(!i.ie||i.ie&&i.version==9){var B=y.parentNode;while(!e.isBlockElm(B)){if(B.tagName=="SPAN"){y.style.cssText=B.style.cssText+y.style.cssText}B=B.parentNode}}v.setStart(y,0).setCursor()}e.remove(z)}}}return true},queryCommandValue:function(v){var u=this.selection.getStart();if(v=="underline"||v=="strikethrough"){var w=u,x;while(w&&!e.isBlockElm(w)&&!e.isBody(w)){if(w.nodeType==1){x=e.getComputedStyle(w,s);if(x!="none"){return x}}w=w.parentNode}return"none"}return e.getComputedStyle(u,s)},queryCommandState:function(u){if(this.highlight){return -1}if(!(u=="underline"||u=="strikethrough")){return 0}return this.queryCommandValue(u)==(u=="underline"?"underline":"line-through")}}})(q,r[q])}})();(function(){var q=function(r){return n.findNode(r.selection.getStartElementPath(),["blockquote"])};UE.commands.blockquote={execCommand:function(B,F){var E=this.selection.getRange(),D=q(this),s=a.blockquote,A=E.createBookmark(),I=this.currentSelectedArr;if(D){if(I&&I.length){e.remove(D,true)}else{var y=E.startContainer,z=e.isBlockElm(y)?y:e.findParent(y,function(L){return e.isBlockElm(L)}),u=E.endContainer,v=e.isBlockElm(u)?u:e.findParent(u,function(L){return e.isBlockElm(L)});z=e.findParentByTagName(z,"li",true)||z;v=e.findParentByTagName(v,"li",true)||v;if(z.tagName=="LI"||z.tagName=="TD"||z===D){e.remove(D,true)}else{e.breakParent(z,D)}if(z!==v){D=e.findParentByTagName(v,"blockquote");if(D){if(v.tagName=="LI"||v.tagName=="TD"){e.remove(D,true)}else{e.breakParent(v,D)}}}var x=e.getElementsByTagName(this.document,"blockquote");for(var J=0,t;t=x[J++];){if(!t.childNodes.length){e.remove(t)}else{if(e.getPosition(t,z)&e.POSITION_FOLLOWING&&e.getPosition(t,v)&e.POSITION_PRECEDING){e.remove(t,true)}}}}}else{var K=E.cloneRange(),G=K.startContainer.nodeType==1?K.startContainer:K.startContainer.parentNode,r=G,H=1;while(1){if(e.isBody(G)){if(r!==G){if(E.collapsed){K.selectNode(r);H=0}else{K.setStartBefore(r)}}else{K.setStart(G,0)}break}if(!s[G.tagName]){if(E.collapsed){K.selectNode(r)}else{K.setStartBefore(r)}break}r=G;G=G.parentNode}if(H){r=G=G=K.endContainer.nodeType==1?K.endContainer:K.endContainer.parentNode;while(1){if(e.isBody(G)){if(r!==G){K.setEndAfter(r)}else{K.setEnd(G,G.childNodes.length)}break}if(!s[G.tagName]){K.setEndAfter(r);break}r=G;G=G.parentNode}}G=E.document.createElement("blockquote");e.setAttributes(G,F);G.appendChild(K.extractContents());K.insertNode(G);var w=e.getElementsByTagName(G,"blockquote");for(var J=0,C;C=w[J++];){if(C.parentNode){e.remove(C,true)}}}E.moveToBookmark(A).select()},queryCommandState:function(){if(this.highlight){return -1}return q(this)?1:0}}})();UE.commands.inserthtml={execCommand:function(u,z){var D=this,A,E,x,G,r,w=D.currentSelectedArr;A=D.selection.getRange();r=A.document.createElement("div");r.style.display="inline";r.innerHTML=n.trim(z);try{D.adjustTable&&D.adjustTable(r)}catch(C){}if(w&&w.length){for(var x=0,q;q=w[x++];){q.className=""}w[0].innerHTML="";A.setStart(w[0],0).collapse(true);D.currentSelectedArr=[]}if(!A.collapsed){A.deleteContents();if(A.startContainer.nodeType==1){var s=A.startContainer.childNodes[A.startOffset],t;if(s&&e.isBlockElm(s)&&(t=s.previousSibling)&&e.isBlockElm(t)){A.setEnd(t,t.childNodes.length).collapse();while(s.firstChild){t.appendChild(s.firstChild)}e.remove(s)}}}var s,F,t,v,B=0;while(s=r.firstChild){A.insertNode(s);if(!B&&s.nodeType==e.NODE_ELEMENT&&e.isBlockElm(s)){F=e.findParent(s,function(H){return e.isBlockElm(H)});if(F&&F.tagName.toLowerCase()!="body"&&!(a[F.tagName][s.nodeName]&&s.parentNode===F)){if(!a[F.tagName][s.nodeName]){t=F}else{v=s.parentNode;while(v!==F){t=v;v=v.parentNode}}e.breakParent(s,t||v);var t=s.previousSibling;e.trimWhiteTextNode(t);if(!t.childNodes.length){e.remove(t)}B=1}}var y=s.nextSibling;if(!r.firstChild&&y&&e.isBlockElm(y)){A.setStart(y,0).collapse(true);break}A.setEndAfter(s).collapse()}s=A.startContainer;if(e.isBlockElm(s)&&e.isEmptyNode(s)){s.innerHTML=i.ie?"":"<br/>"}A.select(true);setTimeout(function(){A=D.selection.getRange();A.scrollToView(D.autoHeightEnabled,D.autoHeightEnabled?e.getXY(D.iframe).y:0)},200)}};UE.commands.horizontal={execCommand:function(r){var t=this;if(t.queryCommandState(r)!==-1){t.execCommand("insertHtml","<hr>");var q=t.selection.getRange(),u=q.startContainer;if(u.nodeType==1&&!u.childNodes[q.startOffset]){var s;if(s=u.childNodes[q.startOffset-1]){if(s.nodeType==1&&s.tagName=="HR"){if(t.options.enterTag=="p"){s=t.document.createElement("p");q.insertNode(s);q.setStart(s,0).setCursor()}else{s=t.document.createElement("br");q.insertNode(s);q.setStartBefore(s).setCursor()}}}}return true}},queryCommandState:function(){return this.highlight||n.findNode(this.selection.getStartElementPath(),["table"])?-1:0}};UE.plugins.list=function(){var q=this,s={TD:1,PRE:1,BLOCKQUOTE:1};function r(x,u,w){var v=x.nextSibling;if(v&&v.nodeType==1&&v.tagName.toLowerCase()==u&&(e.getStyle(v,"list-style-type")||(u=="ol"?"decimal":"disc"))==w){e.moveChild(v,x);if(v.childNodes.length==0){e.remove(v)}}var t=x.previousSibling;if(t&&t.nodeType==1&&t.tagName.toLowerCase()==u&&(e.getStyle(t,"list-style-type")||(u=="ol"?"decimal":"disc"))==w){e.moveChild(x,t)}if(x.childNodes.length==0){e.remove(x)}}q.addListener("keydown",function(C,I){function y(){I.preventDefault?I.preventDefault():(I.returnValue=false);q.undoManger&&q.undoManger.save()}var J=I.keyCode||I.which;if(J==13){var B=q.selection.getRange(),u=e.findParentByTagName(B.startContainer,["ol","ul"],true,function(K){return K.tagName=="TABLE"}),x=e.findParentByTagName(B.endContainer,["ol","ul"],true,function(K){return K.tagName=="TABLE"});if(u&&x&&u===x){if(!B.collapsed){u=e.findParentByTagName(B.startContainer,"li",true);x=e.findParentByTagName(B.endContainer,"li",true);if(u&&x&&u===x){B.deleteContents();G=e.findParentByTagName(B.startContainer,"li",true);if(G&&e.isEmptyBlock(G)){w=G.previousSibling;A=G.nextSibling;t=q.document.createElement("p");e.fillNode(q.document,t);E=G.parentNode;if(w&&A){B.setStart(A,0).collapse(true).select(true);e.remove(G)}else{if(!w&&!A||!w){E.parentNode.insertBefore(t,E)}else{G.parentNode.parentNode.insertBefore(t,E.nextSibling)}e.remove(G);if(!E.firstChild){e.remove(E)}B.setStart(t,0).setCursor()}y();return}}else{var H=B.cloneRange(),v=H.collapse(false).createBookmark();B.deleteContents();H.moveToBookmark(v);var G=e.findParentByTagName(H.startContainer,"li",true),w=G.previousSibling,A=G.nextSibling;if(w){G=w;if(w.firstChild&&e.isBlockElm(w.firstChild)){w=w.firstChild}if(e.isEmptyNode(w)){e.remove(G)}}if(A){G=A;if(A.firstChild&&e.isBlockElm(A.firstChild)){A=A.firstChild}if(e.isEmptyNode(A)){e.remove(G)}}H.select();y();return}}G=e.findParentByTagName(B.startContainer,"li",true);if(G){if(e.isEmptyBlock(G)){v=B.createBookmark();var E=G.parentNode;if(G!==E.lastChild){e.breakParent(G,E)}else{E.parentNode.insertBefore(G,E.nextSibling);if(e.isEmptyNode(E)){e.remove(E)}}if(!a.$list[G.parentNode.tagName]){if(!e.isBlockElm(G.firstChild)){t=q.document.createElement("p");G.parentNode.insertBefore(t,G);while(G.firstChild){t.appendChild(G.firstChild)}e.remove(G)}else{e.remove(G,true)}}B.moveToBookmark(v).select()}else{var z=G.firstChild;if(!z||!e.isBlockElm(z)){var t=q.document.createElement("p");!G.firstChild&&e.fillNode(q.document,t);while(G.firstChild){t.appendChild(G.firstChild)}G.appendChild(t);z=t}var D=q.document.createElement("span");B.insertNode(D);e.breakParent(D,G);var F=D.nextSibling;z=F.firstChild;if(!z){t=q.document.createElement("p");e.fillNode(q.document,t);F.appendChild(t);z=t}if(e.isEmptyNode(z)){z.innerHTML="";e.fillNode(q.document,z)}B.setStart(z,0).collapse(true).shrinkBoundary().select();e.remove(D);w=F.previousSibling;if(w&&e.isEmptyBlock(w)){w.innerHTML="<p></p>";e.fillNode(q.document,w.firstChild)}}y()}}}if(J==8){B=q.selection.getRange();if(B.collapsed&&e.isStartInblock(B)){H=B.cloneRange().trimBoundary();G=e.findParentByTagName(B.startContainer,"li",true);if(G&&e.isStartInblock(H)){if(G&&(w=G.previousSibling)){if(J==46&&G.childNodes.length){return}if(a.$list[w.tagName]){w=w.lastChild}q.undoManger&&q.undoManger.save();z=G.firstChild;if(e.isBlockElm(z)){if(e.isEmptyNode(z)){w.appendChild(z);B.setStart(z,0).setCursor(false,true);while(G.firstChild){w.appendChild(G.firstChild)}}else{u=e.findParentByTagName(B.startContainer,"p",true);if(u&&u!==z){return}D=q.document.createElement("span");B.insertNode(D);e.moveChild(G,w);B.setStartBefore(D).collapse(true).select(true);e.remove(D)}}else{if(e.isEmptyNode(G)){var t=q.document.createElement("p");w.appendChild(t);B.setStart(t,0).setCursor()}else{B.setEnd(w,w.childNodes.length).collapse().select(true);while(G.firstChild){w.appendChild(G.firstChild)}}}e.remove(G);q.undoManger&&q.undoManger.save();e.preventDefault(I);return}if(G&&!G.previousSibling){z=G.firstChild;if(!z||G.lastChild===z&&e.isEmptyNode(e.isBlockElm(z)?z:G)){var t=q.document.createElement("p");G.parentNode.parentNode.insertBefore(t,G.parentNode);e.fillNode(q.document,t);B.setStart(t,0).setCursor();e.remove(!G.nextSibling?G.parentNode:G);q.undoManger&&q.undoManger.save();e.preventDefault(I);return}}}}}});q.commands.insertorderedlist=q.commands.insertunorderedlist={execCommand:function(w,N){if(!N){N=w.toLowerCase()=="insertorderedlist"?"decimal":"disc"}var U=this,G=this.selection.getRange(),H=function(X){return X.nodeType==1?X.tagName.toLowerCase()!="br":!e.isWhitespace(X)},W=w.toLowerCase()=="insertorderedlist"?"ol":"ul",v=U.document.createDocumentFragment();G.adjustmentBoundary().shrinkBoundary();var A=G.createBookmark(true),y=e.findParentByTagName(U.document.getElementById(A.start),"li"),K=0,x=e.findParentByTagName(U.document.getElementById(A.end),"li"),L=0,S,D,O,Q;if(y||x){y&&(S=y.parentNode);if(!A.end){x=y}x&&(D=x.parentNode);if(S===D){while(y!==x){Q=y;y=y.nextSibling;if(!e.isBlockElm(Q.firstChild)){var I=U.document.createElement("p");while(Q.firstChild){I.appendChild(Q.firstChild)}Q.appendChild(I)}v.appendChild(Q)}Q=U.document.createElement("span");S.insertBefore(Q,x);if(!e.isBlockElm(x.firstChild)){I=U.document.createElement("p");while(x.firstChild){I.appendChild(x.firstChild)}x.appendChild(I)}v.appendChild(x);e.breakParent(Q,S);if(e.isEmptyNode(Q.previousSibling)){e.remove(Q.previousSibling)}if(e.isEmptyNode(Q.nextSibling)){e.remove(Q.nextSibling)}var z=e.getComputedStyle(S,"list-style-type")||(w.toLowerCase()=="insertorderedlist"?"decimal":"disc");if(S.tagName.toLowerCase()==W&&z==N){for(var M=0,E,B=U.document.createDocumentFragment();E=v.childNodes[M++];){while(E.firstChild){B.appendChild(E.firstChild)}}Q.parentNode.insertBefore(B,Q)}else{O=U.document.createElement(W);e.setStyle(O,"list-style-type",N);O.appendChild(v);Q.parentNode.insertBefore(O,Q)}e.remove(Q);O&&r(O,W,N);G.moveToBookmark(A).select();return}if(y){while(y){Q=y.nextSibling;var t=U.document.createDocumentFragment(),R=0;while(y.firstChild){if(e.isBlockElm(y.firstChild)){R=1}t.appendChild(y.firstChild)}if(!R){var V=U.document.createElement("p");V.appendChild(t);v.appendChild(V)}else{v.appendChild(t)}e.remove(y);y=Q}S.parentNode.insertBefore(v,S.nextSibling);if(e.isEmptyNode(S)){G.setStartBefore(S);e.remove(S)}else{G.setStartAfter(S)}K=1}if(x){y=D.firstChild;while(y!==x){Q=y.nextSibling;t=U.document.createDocumentFragment();R=0;while(y.firstChild){if(e.isBlockElm(y.firstChild)){R=1}t.appendChild(y.firstChild)}if(!R){V=U.document.createElement("p");V.appendChild(t);v.appendChild(V)}else{v.appendChild(t)}e.remove(y);y=Q}v.appendChild(x.firstChild);e.remove(x);D.parentNode.insertBefore(v,D);G.setEndBefore(D);if(e.isEmptyNode(D)){e.remove(D)}L=1}}if(!K){G.setStartBefore(U.document.getElementById(A.start))}if(A.end&&!L){G.setEndAfter(U.document.getElementById(A.end))}G.enlarge(true,function(X){return s[X.tagName]});v=U.document.createDocumentFragment();var u=G.createBookmark(),J=e.getNextDomNode(u.start,false,H),T=G.cloneRange(),P,C=e.isBlockElm;while(J&&J!==u.end&&(e.getPosition(J,u.end)&e.POSITION_PRECEDING)){if(J.nodeType==3||a.li[J.tagName]){if(J.nodeType==1&&a.$list[J.tagName]){while(J.firstChild){v.appendChild(J.firstChild)}P=e.getNextDomNode(J,false,H);e.remove(J);J=P;continue}P=J;T.setStartBefore(J);while(J&&J!==u.end&&(!C(J)||e.isBookmarkNode(J))){P=J;J=e.getNextDomNode(J,false,null,function(X){return !s[X.tagName]})}if(J&&C(J)){Q=e.getNextDomNode(P,false,H);if(Q&&e.isBookmarkNode(Q)){J=e.getNextDomNode(Q,false,H);P=Q}}T.setEndAfter(P);J=e.getNextDomNode(P,false,H);var F=G.document.createElement("li");F.appendChild(T.extractContents());v.appendChild(F)}else{J=e.getNextDomNode(J,true,H)}}G.moveToBookmark(u).collapse(true);O=U.document.createElement(W);e.setStyle(O,"list-style-type",N);O.appendChild(v);G.insertNode(O);r(O,W,N);G.moveToBookmark(A).select()},queryCommandState:function(t){return this.highlight?-1:n.findNode(this.selection.getStartElementPath(),[t.toLowerCase()=="insertorderedlist"?"ol":"ul"])?1:0},queryCommandValue:function(u){var t=n.findNode(this.selection.getStartElementPath(),[u.toLowerCase()=="insertorderedlist"?"ol":"ul"]);return t?e.getComputedStyle(t,"list-style-type"):null}}};(function(){var q=c.editor.utils,s=c.editor.ui.uiUtils,t=c.editor.ui.UIBase;function r(u){this.initOptions(u);this.initEditorUI()}r.prototype={uiName:"editor",initEditorUI:function(){this.editor.ui=this;this._dialogs={};this.initUIBase();this._initToolbars();var D=this.editor,z=D.options.iframeUrlMap;D.addListener("ready",function(){c.editor.dom.domUtils.on(D.window,"scroll",function(){c.editor.ui.Popup.postHide()});if(D.options.elementPathEnabled){D.ui.getDom("elementpath").innerHTML='<div class="edui-editor-breadcrumb">path:</div>'}if(D.options.wordCount){D.ui.getDom("wordcount").innerHTML=""}if(!D.selection.isFocus()){return}D.fireEvent("selectionchange",false,true)});D.addListener("mousedown",function(I,H){var J=H.target||H.srcElement;c.editor.ui.Popup.postHide(J)});D.addListener("contextmenu",function(I,H){c.editor.ui.Popup.postHide()});var E=this;D.addListener("selectionchange",function(){if(!D.selection.isFocus()){return}E._updateElementPath();E._wordCount()});D.addListener("sourcemodechanged",function(H,I){if(D.options.elementPathEnabled){if(I){E.disableElementPath()}else{E.enableElementPath()}}if(D.options.wordCount){if(I){E.disableWordCount()}else{E.enableWordCount()}}});var G=new c.editor.ui.Dialog({iframeUrl:z?D.ui.mapUrl(z.link):"",autoReset:true,draggable:true,editor:D,className:"edui-for-link",title:"",buttons:[{className:"edui-okbutton",label:"",onclick:function(){G.close(true)}},{className:"edui-cancelbutton",label:"",onclick:function(){G.close(false)}}],onok:function(){},oncancel:function(){},onclose:function(I,H){if(H){return this.onok()}else{return this.oncancel()}}});G.render();var A=new c.editor.ui.Dialog({iframeUrl:z?D.ui.mapUrl(z.insertimage):"",autoReset:true,draggable:true,editor:D,className:"edui-for-insertimage",title:"",buttons:[{className:"edui-okbutton",label:"",onclick:function(){A.close(true)}},{className:"edui-cancelbutton",label:"",onclick:function(){A.close(false)}}],onok:function(){},oncancel:function(){},onclose:function(I,H){if(H){return this.onok()}else{return this.oncancel()}}});A.render();var B=new c.editor.ui.Dialog({iframeUrl:z?D.ui.mapUrl(z.anchor):"",autoReset:true,draggable:true,editor:D,className:"edui-for-anchor",title:"",buttons:[{className:"edui-okbutton",label:"",onclick:function(){B.close(true)}},{className:"edui-cancelbutton",label:"",onclick:function(){B.close(false)}}],onok:function(){},oncancel:function(){},onclose:function(I,H){if(H){return this.onok()}else{return this.oncancel()}}});B.render();var y=new c.editor.ui.Dialog({iframeUrl:z?D.ui.mapUrl(z.insertvideo):"",autoReset:true,draggable:true,editor:D,className:"edui-for-insertvideo",title:"",buttons:[{className:"edui-okbutton",label:"",onclick:function(){y.close(true)}},{className:"edui-cancelbutton",label:"",onclick:function(){y.close(false)}}],onok:function(){},oncancel:function(){},onclose:function(I,H){if(H){return this.onok()}else{return this.oncancel()}}});y.render();var w=new c.editor.ui.Dialog({iframeUrl:z?D.ui.mapUrl(z.wordimage):"",autoReset:true,draggable:true,editor:D,className:"edui-for-wordimage",title:"",buttons:[{className:"edui-okbutton",label:"",onclick:function(){w.close(true)}},{className:"edui-cancelbutton",label:"",onclick:function(){w.close(false)}}],onok:function(){},oncancel:function(){},onclose:function(I,H){if(H){return this.onok()}else{return this.oncancel()}}});w.render();E._dialogs.wordImageDialog=w;var v=new c.editor.ui.Dialog({iframeUrl:z?E.mapUrl(z.edittd):"about:blank",autoReset:true,draggable:true,editor:D,className:"edui-for-edittd",title:"",buttons:[{className:"edui-okbutton",label:"",onclick:function(){v.close(true)}},{className:"edui-cancelbutton",label:"",onclick:function(){v.close(false)}}],onok:function(){},oncancel:function(){},onclose:function(I,H){if(H){return this.onok()}else{return this.oncancel()}}});v.render();E._dialogs.tdDialog=v;var x=new c.editor.ui.Dialog({iframeUrl:z?D.ui.mapUrl(z.map):"",autoReset:true,draggable:true,editor:D,className:"edui-for-map",title:"",buttons:[{className:"edui-okbutton",label:"",onclick:function(){x.close(true)}},{className:"edui-cancelbutton",label:"",onclick:function(){x.close(false)}}],onok:function(){},oncancel:function(){},onclose:function(I,H){if(H){return this.onok()}else{return this.oncancel()}}});x.render();var C=new c.editor.ui.Dialog({iframeUrl:z?D.ui.mapUrl(z.gmap):"",autoReset:true,draggable:true,editor:D,className:"edui-for-gmap",title:"Google",buttons:[{className:"edui-okbutton",label:"",onclick:function(){C.close(true)}},{className:"edui-cancelbutton",label:"",onclick:function(){C.close(false)}}],onok:function(){},oncancel:function(){},onclose:function(I,H){if(H){return this.onok()}else{return this.oncancel()}}});C.render();var u=new c.editor.ui.Popup({editor:D,content:"",className:"edui-bubble",_onEditButtonClick:function(){this.hide();G.open()},_onImgEditButtonClick:function(){this.hide();var I=D.selection.getRange().getClosedNode();var H=c.editor.dom.domUtils.findParentByTagName(I,"img",true);if(H&&H.className.indexOf("edui-faked-video")!=-1){y.open()}else{if(H&&H.src.indexOf("http://api.map.baidu.com")!=-1){x.open()}else{if(H&&H.src.indexOf("http://maps.google.com/maps/api/staticmap")!=-1){C.open()}else{if(H&&H.getAttribute("anchorname")){B.open()}else{if(H&&H.getAttribute("word_img")){D.word_img=[H.getAttribute("word_img")];D.ui._dialogs.wordImageDialog.open()}else{A.open()}}}}}},_getImg:function(){var H=D.selection.getRange().getClosedNode();if(H&&(H.nodeName=="img"||H.nodeName=="IMG")){return H}return null},_onImgSetFloat:function(I){if(this._getImg()){D.execCommand("imagefloat",I);var H=this._getImg();if(H){this.showAnchor(H)}}},_setIframeAlign:function(H){var I=u.anchorEl;var J=I.cloneNode(true);switch(H){case -2:J.setAttribute("align","");break;case -1:J.setAttribute("align","left");break;case 1:J.setAttribute("align","right");break;case 2:J.setAttribute("align","middle");break}I.parentNode.insertBefore(J,I);c.editor.dom.domUtils.remove(I);u.anchorEl=J;u.showAnchor(u.anchorEl)},_updateIframe:function(){D._iframe=u.anchorEl;F.open();u.hide()},_onRemoveButtonClick:function(){var I=D.selection.getRange().getClosedNode();var H=c.editor.dom.domUtils.findParentByTagName(I,"img",true);if(H&&H.getAttribute("anchorname")){D.execCommand("anchor")}else{D.execCommand("unlink")}this.hide()},queryAutoHide:function(H){if(H&&H.ownerDocument==D.document){if(H.tagName.toLowerCase()=="img"||c.editor.dom.domUtils.findParentByTagName(H,"a",true)){return H!==u.anchorEl}}return c.editor.ui.Popup.prototype.queryAutoHide.call(this,H)}});u.render();var F=new c.editor.ui.Dialog({iframeUrl:z?D.ui.mapUrl(z.insertframe):"",autoReset:true,draggable:true,editor:D,className:"edui-for-insertframe",title:"iframe",buttons:[{className:"edui-okbutton",label:"",onclick:function(){F.close(true)}},{className:"edui-cancelbutton",label:"",onclick:function(){F.close(false)}}],onok:function(){},oncancel:function(){},onclose:function(I,H){if(H){return this.onok()}else{return this.oncancel()}}});F.render();D.addListener("mouseover",function(J,H){H=H||window.event;var K=H.target||H.srcElement;if(/iframe/ig.test(K.tagName)&&D.options.imagePopup){var I=u.formatHtml('<nobr>: <span onclick=$$._setIframeAlign(-2) class="edui-clickable"></span>&nbsp;&nbsp;<span onclick=$$._setIframeAlign(-1) class="edui-clickable"></span>&nbsp;&nbsp;<span onclick=$$._setIframeAlign(1) class="edui-clickable"></span>&nbsp;&nbsp;<span onclick=$$._setIframeAlign(2) class="edui-clickable"></span> <span onclick="$$._updateIframe( this);" class="edui-clickable"></span></nobr>');if(I){u.getDom("content").innerHTML=I;u.anchorEl=K;u.showAnchor(u.anchorEl)}else{u.hide()}}});D.addListener("selectionchange",function(M,K){if(!K){return}var L="";var I=D.selection.getRange().getClosedNode();if(I!=null&&I.tagName.toLowerCase()=="img"){if(I.getAttribute("anchorname")){L+=u.formatHtml('<nobr>: <span onclick=$$._onImgEditButtonClick(event) class="edui-clickable"></span>&nbsp;&nbsp;<span onclick=$$._onRemoveButtonClick(event) class="edui-clickable"></span></nobr>')}else{if(D.options.imagePopup){L+=u.formatHtml('<nobr>: <span onclick=$$._onImgSetFloat("none") class="edui-clickable"></span>&nbsp;&nbsp;<span onclick=$$._onImgSetFloat("left") class="edui-clickable"></span>&nbsp;&nbsp;<span onclick=$$._onImgSetFloat("right") class="edui-clickable"></span>&nbsp;&nbsp;<span onclick=$$._onImgSetFloat("center") class="edui-clickable"></span> <span onclick="$$._onImgEditButtonClick(event, this);" class="edui-clickable"></span></nobr>')}}}var N;if(D.selection.getRange().collapsed){N=D.queryCommandValue("link")}else{N=D.selection.getStart()}N=c.editor.dom.domUtils.findParentByTagName(N,"a",true);var J;if(N!=null&&(J=(N.getAttribute("data_ue_src")||N.getAttribute("href",2)))!=null){var H=J;if(J.length>30){H=J.substring(0,20)+"..."}if(L){L+='<div style="height:5px;"></div>'}L+=u.formatHtml('<nobr>: <a target="_blank" href="'+J+'" title="'+J+'" >'+H+'</a> <span class="edui-clickable" onclick="$$._onEditButtonClick(event, this);"></span> <span class="edui-clickable" onclick="$$._onRemoveButtonClick(event, this);"> </span></nobr>');u.showAnchor(N)}if(L){u.getDom("content").innerHTML=L;u.anchorEl=I||N;u.showAnchor(u.anchorEl)}else{u.hide()}})},_initToolbars:function(){var A=this.editor;var C=this.toolbars||[];var w=[];for(var z=0;z<C.length;z++){var B=C[z];var x=new c.editor.ui.Toolbar();for(var y=0;y<B.length;y++){var u=B[y];var v=null;if(typeof u=="string"){if(u=="|"){u="Separator"}if(c.editor.ui[u]){v=new c.editor.ui[u](A)}if(u=="FullScreen"){if(w&&w[0]){w[0].items.splice(0,0,v)}else{x.items.splice(0,0,v)}continue}}else{v=u}if(v){x.add(v)}}w[z]=x}this.toolbars=w},getHtmlTpl:function(){return'<div id="##" class="%%"><div id="##_toolbarbox" class="%%-toolbarbox"><div id="##_toolbarboxouter" class="%%-toolbarboxouter"><div class="%%-toolbarboxinner">'+this.renderToolbarBoxHtml()+'</div></div><div id="##_toolbarmsg" class="%%-toolbarmsg" style="display:none;"><div id = "##_upload_dialog" class="%%-toolbarmsg-upload" onclick="$$.showWordImageDialog();"></div><div class="%%-toolbarmsg-close" onclick="$$.hideToolbarMsg();">x</div><div id="##_toolbarmsg_label" class="%%-toolbarmsg-label"></div><div style="height:0;overflow:hidden;clear:both;"></div></div></div><div id="##_iframeholder" class="%%-iframeholder"></div><div id="##_bottombar" class="%%-bottomContainer"><table><tr><td id="##_elementpath" class="%%-bottombar"></td><td id="##_wordcount" class="%%-wordcount"></td></tr></table></div></div>'},showWordImageDialog:function(){this.editor.execCommand("wordimage","word_img");this._dialogs.wordImageDialog.open()},renderToolbarBoxHtml:function(){var v=[];for(var u=0;u<this.toolbars.length;u++){v.push(this.toolbars[u].renderHtml())}return v.join("")},setFullScreen:function(x){if(this._fullscreen!=x){this._fullscreen=x;this.editor.fireEvent("beforefullscreenchange",x);var w=this.editor;if(c.editor.browser.gecko){var u=w.selection.getRange().createBookmark()}if(x){this._bakHtmlOverflow=document.documentElement.style.overflow;this._bakBodyOverflow=document.body.style.overflow;this._bakAutoHeight=this.editor.autoHeightEnabled;this._bakScrollTop=Math.max(document.documentElement.scrollTop,document.body.scrollTop);if(this._bakAutoHeight){w.autoHeightEnabled=false;this.editor.disableAutoHeight()}document.documentElement.style.overflow="hidden";document.body.style.overflow="hidden";this._bakCssText=this.getDom().style.cssText;this._bakCssText1=this.getDom("iframeholder").style.cssText;this._updateFullScreen()}else{this.getDom().style.cssText=this._bakCssText;this.getDom("iframeholder").style.cssText=this._bakCssText1;if(this._bakAutoHeight){w.autoHeightEnabled=true;this.editor.enableAutoHeight()}document.documentElement.style.overflow=this._bakHtmlOverflow;document.body.style.overflow=this._bakBodyOverflow;window.scrollTo(0,this._bakScrollTop)}if(c.editor.browser.gecko){var v=document.createElement("input");document.body.appendChild(v);w.body.contentEditable=false;setTimeout(function(){v.focus();setTimeout(function(){w.body.contentEditable=true;w.selection.getRange().moveToBookmark(u).select(true);c.editor.dom.domUtils.remove(v);x&&window.scroll(0,0)})})}this.editor.fireEvent("fullscreenchanged",x);this.triggerLayout()}},_wordCount:function(){var u=this.getDom("wordcount");if(!this.editor.options.wordCount){u.style.display="none";return}u.innerHTML=this.editor.queryCommandValue("wordcount")},disableWordCount:function(){var u=this.getDom("wordcount");u.innerHTML="";u.style.display="none";this.wordcount=false},enableWordCount:function(){var u=this.getDom("wordcount");u.style.display="";this.wordcount=true;this._wordCount()},_updateFullScreen:function(){if(this._fullscreen){var u=s.getViewportRect();this.getDom().style.cssText="border:0;position:absolute;left:0;top:0;width:"+u.width+"px;height:"+u.height+"px;z-index:"+(this.getDom().style.zIndex*1+100);s.setViewportOffset(this.getDom(),{left:0,top:0});this.editor.setHeight(u.height-this.getDom("toolbarbox").offsetHeight-this.getDom("bottombar").offsetHeight)}},_updateElementPath:function(){var u=this.getDom("elementpath"),x;if(this.elementPathEnabled&&(x=this.editor.queryCommandValue("elementpath"))){var y=[];for(var w=0,v;v=x[w];w++){y[w]=this.formatHtml('<span unselectable="on" onclick="$$.editor.execCommand(&quot;elementpath&quot;, &quot;'+w+'&quot;);">'+v+"</span>")}u.innerHTML='<div class="edui-editor-breadcrumb" onmousedown="return false;">path: '+y.join(" &gt; ")+"</div>"}else{u.style.display="none"}},disableElementPath:function(){var u=this.getDom("elementpath");u.innerHTML="";u.style.display="none";this.elementPathEnabled=false},enableElementPath:function(){var u=this.getDom("elementpath");u.style.display="";this.elementPathEnabled=true;this._updateElementPath()},isFullScreen:function(){return this._fullscreen},postRender:function(){t.prototype.postRender.call(this);for(var w=0;w<this.toolbars.length;w++){this.toolbars[w].postRender()}var x=this;var v,u=c.editor.dom.domUtils,y=function(){clearTimeout(v);v=setTimeout(function(){x._updateFullScreen()})};u.on(window,"resize",y);x.addListener("destroy",function(){u.un(window,"resize",y);clearTimeout(v)})},showToolbarMsg:function(x,v){this.getDom("toolbarmsg_label").innerHTML=x;this.getDom("toolbarmsg").style.display="";if(!v){var u=this.getDom("upload_dialog");u.style.display="none"}},hideToolbarMsg:function(){this.getDom("toolbarmsg").style.display="none"},mapUrl:function(u){return u.replace("~/",this.editor.options.UEDITOR_HOME_URL||"")},triggerLayout:function(){var u=this.getDom();if(u.style.zoom=="1"){u.style.zoom="100%"}else{u.style.zoom="1"}}};q.inherits(r,c.editor.ui.UIBase);c.editor.ui.Editor=function(u){var w=new c.editor.Editor(u);w.options.editor=w;new r(w.options);var v=w.render;w.render=function(z){if(z){if(z.constructor===String){z=document.getElementById(z)}z&&z.getAttribute("name")&&(w.options.textarea=z.getAttribute("name"));if(z&&/script|textarea/ig.test(z.tagName)){var y=document.createElement("div");z.parentNode.insertBefore(y,z);w.options.initialContent=z.value||z.innerHTML;z.id&&(y.id=z.id);z.className&&(y.className=z.className);z.style.cssText&&(y.style.cssText=z.style.cssText);z.parentNode.removeChild(z);z=y;z.innerHTML=""}}w.ui.render(z);var x=w.ui.getDom("iframeholder");w.container=w.ui.getDom();w.container.style.zIndex=w.options.zIndex;v.call(w,x)};return w}})();UE.plugins.undo=function(){var w=this,y=w.options.maxUndoCount,v=w.options.maxInputCount,t=new RegExp(e.fillChar+"|</hr>","gi"),q=/\b(?:href|src|name)="[^"]*?"/gi;function s(){this.list=[];this.index=0;this.hasUndo=false;this.hasRedo=false;this.undo=function(){if(this.hasUndo){var B=this.getScene(),A=this.list[this.index];if(A.content.replace(q,"")!=B.content.replace(q,"")){this.save()}if(!this.list[this.index-1]&&this.list.length==1){this.reset();return}while(this.list[this.index].content==this.list[this.index-1].content){this.index--;if(this.index==0){return this.restore(0)}}this.restore(--this.index)}};this.redo=function(){if(this.hasRedo){while(this.list[this.index].content==this.list[this.index+1].content){this.index++;if(this.index==this.list.length-1){return this.restore(this.index)}}this.restore(++this.index)}};this.restore=function(){var E=this.list[this.index];w.document.body.innerHTML=E.bookcontent.replace(t,"");if(i.ie){for(var B=0,D,F=w.document.getElementsByTagName("p");D=F[B++];){if(D.innerHTML==""){e.fillNode(w.document,D)}}}var A=new g.Range(w.document);A.moveToBookmark({start:"_baidu_bookmark_start_",end:"_baidu_bookmark_end_",id:true});if(i.ie&&i.version==9&&A.collapsed&&e.isBlockElm(A.startContainer)&&e.isEmptyNode(A.startContainer)){e.fillNode(A.document,A.startContainer)}A.select(!i.gecko);setTimeout(function(){A.scrollToView(w.autoHeightEnabled,w.autoHeightEnabled?e.getXY(w.iframe).y:0)},200);this.update();if(w.currentSelectedArr){w.currentSelectedArr=[];var C=w.document.getElementsByTagName("td");for(var B=0,G;G=C[B++];){if(G.className==w.options.selectedTdClass){w.currentSelectedArr.push(G)}}}this.clearKey();w.fireEvent("reset",true);w.fireEvent("contentchange")};this.getScene=function(){var B=w.selection.getRange(),A=w.body.innerHTML.replace(t,"");B.shrinkBoundary();i.ie&&(A=A.replace(/>&nbsp;</g,"><").replace(/\s*</g,"").replace(/>\s*/g,">"));var D=B.createBookmark(true,true),C=w.body.innerHTML.replace(t,"");B.moveToBookmark(D).select(true);return{bookcontent:C,content:A}};this.save=function(){var B=this.getScene(),A=this.list[this.index];if(A&&A.content==B.content&&A.bookcontent==B.bookcontent){return}this.list=this.list.slice(0,this.index+1);this.list.push(B);if(this.list.length>y){this.list.shift()}this.index=this.list.length-1;this.clearKey();this.update();w.fireEvent("contentchange")};this.update=function(){this.hasRedo=this.list[this.index+1]?true:false;this.hasUndo=this.list[this.index-1]||this.list.length==1?true:false};this.reset=function(){this.list=[];this.index=0;this.hasUndo=false;this.hasRedo=false;this.clearKey()};this.clearKey=function(){u=0;r=null}}w.undoManger=new s();function x(){this.undoManger.save()}w.addListener("beforeexeccommand",x);w.addListener("afterexeccommand",x);w.addListener("reset",function(B,A){if(!A){w.undoManger.reset()}});w.commands.redo=w.commands.undo={execCommand:function(A){w.undoManger[A]()},queryCommandState:function(A){return w.undoManger["has"+(A.toLowerCase()=="undo"?"Undo":"Redo")]?0:-1},notNeedUndo:1};var z={16:1,17:1,18:1,37:1,38:1,39:1,40:1,13:1},u=0,r;w.addListener("keydown",function(B,A){var C=A.keyCode||A.which;if(!z[C]&&!A.ctrlKey&&!A.metaKey&&!A.shiftKey&&!A.altKey){if(w.undoManger.list.length==0||((C==8||C==46)&&r!=C)){w.undoManger.save();r=C;return}if(w.undoManger.list.length==2&&w.undoManger.index==0&&u==0){w.undoManger.list.splice(1,1);w.undoManger.update()}r=C;u++;if(u>v){setTimeout(function(){w.undoManger.save()},0)}}})};UE.plugins.serialize=function(){var E=i.ie,u=i.version;function K(M){return/pt/.test(M)?M.replace(/([\d.]+)pt/g,function(N){return Math.round(parseFloat(N)*96/72)+"px"}):M}var L=this,x=a.$empty,F=function(){var O=/<(?:(?:\/([^>]+)>)|(?:!--([\S|\s]*?)-->)|(?:([^\s\/>]+)\s*((?:(?:"[^"]*")|(?:'[^']*')|[^"'<>])*)\/?>))/g,M=/([\w\-:.]+)(?:(?:\s*=\s*(?:(?:"([^"]*)")|(?:'([^']*)')|([^\s>]+)))|(?=\s|$))/g,P={checked:1,compact:1,declare:1,defer:1,disabled:1,ismap:1,multiple:1,nohref:1,noresize:1,noshade:1,nowrap:1,readonly:1,selected:1},S={script:1,style:1},N={li:{"$":"ul",ul:1,ol:1},dd:{"$":"dl",dl:1},dt:{"$":"dl",dl:1},option:{"$":"select",select:1},td:{"$":"tr",tr:1},th:{"$":"tr",tr:1},tr:{"$":"tbody",tbody:1,thead:1,tfoot:1,table:1},tbody:{"$":"table",table:1,colgroup:1},thead:{"$":"table",table:1},tfoot:{"$":"table",table:1},col:{"$":"colgroup",colgroup:1}};var Q={table:"td",tbody:"td",thead:"td",tfoot:"td",tr:"td",colgroup:"col",ul:"li",ol:"li",dl:"dd",select:"option"};function R(W,aa){var X,Y=0,U,af;O.exec("");while((X=O.exec(W))){var ad=X.index;if(ad>Y){var ag=W.slice(Y,ad);if(af){af.push(ag)}else{aa.onText(ag)}}Y=O.lastIndex;if((U=X[1])){U=U.toLowerCase();if(af&&U==af._tag_name){aa.onCDATA(af.join(""));af=null}if(!af){aa.onTagClose(U);continue}}if(af){af.push(X[0]);continue}if((U=X[3])){if(/="/.test(U)){continue}U=U.toLowerCase();var ae=X[4],T,V={},ac=ae&&ae.slice(-1)=="/";if(ae){M.exec("");while((T=M.exec(ae))){var ab=T[1].toLowerCase(),Z=T[2]||T[3]||T[4]||"";if(!Z&&P[ab]){Z=ab}if(ab=="style"){if(E&&u<=6){Z=Z.replace(/(?!;)\s*([\w-]+):/g,function(ah,ai){return ai.toLowerCase()+":"})}}if(Z){V[ab]=Z.replace(/:\s*/g,":")}}}aa.onTagOpen(U,V,ac);if(!af&&S[U]){af=[];af._tag_name=U}continue}if((U=X[2])){aa.onComment(U)}}if(W.length>Y){aa.onText(W.slice(Y,W.length))}}return function(W,X){var U={type:"fragment",parent:null,children:[]};var V=U;function Z(aa){aa.parent=V;V.children.push(aa)}function Y(ab,aa){var ac=ab;if(N[ac.tag]){while(N[V.tag]&&N[V.tag][ac.tag]){V=V.parent}if(V.tag==ac.tag){V=V.parent}while(N[ac.tag]){if(N[ac.tag][V.tag]){break}ac=ac.parent={type:"element",tag:N[ac.tag]["$"],attributes:{},children:[ac]}}}if(X){while(a[ac.tag]&&!(V.tag=="span"?n.extend(a.strong,{a:1,A:1}):(a[V.tag]||a.div))[ac.tag]){if(T(V)){continue}if(!V.parent){break}V=V.parent}}ac.parent=V;V.children.push(ac);if(aa){V=ab}if(ab.attributes.style){ab.attributes.style=ab.attributes.style.toLowerCase()}return ab}function T(aa){var ab;if(!aa.children.length&&(ab=Q[aa.tag])){Y({type:"element",tag:ab,attributes:{},children:[]},true);return true}return false}R(W,{onText:function(aa){while(!(a[V.tag]||a.div)["#"]){if(T(V)){continue}V=V.parent}Z({type:"text",data:aa})},onComment:function(aa){Z({type:"comment",data:aa})},onCDATA:function(aa){while(!(a[V.tag]||a.div)["#"]){if(T(V)){continue}V=V.parent}Z({type:"cdata",data:aa})},onTagOpen:function(aa,ac,ab){ab=ab||x[aa];Y({type:"element",tag:aa,attributes:ac,closed:ab,children:[]},!ab)},onTagClose:function(aa){var ab=V;while(ab&&aa!=ab.tag){ab=ab.parent}if(ab){for(var ac=V;ac!==ab.parent;ac=ac.parent){T(ac)}V=ab.parent}else{if(!(a.$removeEmpty[aa]||a.$removeEmptyBlock[aa]||aa=="embed")){ab={type:"element",tag:aa,attributes:{},children:[]};Y(ab,true);T(ab);V=ab.parent}}}});while(V!==U){T(V);V=V.parent}return U}}();var B=function(){var N={"<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"};function M(O){return N[O]}return function(O){O=O+"";return O?O.replace(/[<>"']/g,M):""}}();var D=function(){function N(V,U){var T=V.children;var W=[];for(var S=0,R;R=T[S];S++){W.push(D(R,U))}return W.join("")}function O(S){var U=[];for(var R in S){var T=S[R];if(R=="style"){T=K(T);if(/rgba?\s*\([^)]*\)/.test(T)){T=T.replace(/rgba?\s*\(([^)]*)\)/g,function(V){return n.fixColor("color",V)})}S[R]=n.optCss(T.replace(/windowtext/g,"#000"))}U.push(R+'="'+B(S[R])+'"')}return U.join(" ")}function M(S,R){return R?S.data.replace(/&nbsp;/g," "):B(S.data).replace(/ /g,"&nbsp;")}var Q={div:"p",li:"p",tr:"p",br:"br",p:"p"};function P(V,U){var R=V.tag;if(U&&R=="td"){if(!T){T=""}T+=N(V,U)+"&nbsp;&nbsp;&nbsp;"}else{var S=O(V.attributes);var T="<"+(U&&Q[R]?Q[R]:R)+(S?" "+S:"")+(x[R]?" />":">");if(!x[R]){if(i.ie&&R=="p"&&!V.children.length){T+="&nbsp;"}T+=N(V,U);T+="</"+(U&&Q[R]?Q[R]:R)+">"}}return T}return function(S,R){if(S.type=="fragment"){return N(S,R)}else{if(S.type=="element"){return P(S,R)}else{if(S.type=="text"||S.type=="cdata"){return M(S,a.$notTransContent[S.parent.tag])}else{if(S.type=="comment"){return"<!--"+S.data+"-->"}}}}return""}}();var z=function(){function N(Q){var P=new RegExp(/(class="?Mso|style="[^"]*\bmso\-|w:WordDocument|<v:)/ig);return P.test(Q)}function O(P){P=P.replace(/([\d.]+)([\w]+)?/g,function(Q,S,R){return(Math.round(parseFloat(S))||1)+(R||"px")});return P}function M(P){P=P.replace(/<!--\s*EndFragment\s*-->[\s\S]*$/,"").replace(/^(\r\n|\n|\r)|(\r\n|\n|\r)$/ig,"").replace(/^\s*(&nbsp;)+/ig,"").replace(/(&nbsp;|<br[^>]*>)+\s*$/ig,"").replace(/<!--[\s\S]*?-->/ig,"").replace(/<v:shape [^>]*>[\s\S]*?.<\/v:shape>/gi,function(T){var R=T.match(/width:([ \d.]*p[tx])/i)[1],Q=T.match(/height:([ \d.]*p[tx])/i)[1],S=T.match(/src=\s*"([^"]*)"/i)[1];return'<img width="'+K(R)+'" height="'+K(Q)+'" src="'+S+'" />'}).replace(/v:\w+=["']?[^'"]+["']?/g,"").replace(/<(!|script[^>]*>.*?<\/script(?=[>\s])|\/?(\?xml(:\w+)?|xml|meta|link|style|\w+:\w+)(?=[\s\/>]))[^>]*>/gi,"").replace(/<p [^>]*class="?MsoHeading"?[^>]*>(.*?)<\/p>/gi,"<p><strong>$1</strong></p>").replace(/(lang)\s*=\s*([\'\"]?)[\w-]+\2/ig,"").replace(/<font[^>]*>\s*<\/font>/gi,"").replace(/class\s*=\s*["']?(?:(?:MsoTableGrid)|(?:MsoNormal(Table)?))\s*["']?/gi,"");P=P.replace(/(<[a-z][^>]*)\sstyle=(["'])([^\2]*?)\2/gi,function(W,aa,U,R){var S=[],V=0,Z=R.replace(/^\s+|\s+$/,"").replace(/&quot;/gi,"'").split(/;\s*/g);for(var V=0;V<Z.length;V++){var Y=Z[V];var Q,X,T=Y.split(":");if(T.length==2){Q=T[0].toLowerCase();X=T[1].toLowerCase();switch(Q){case"mso-padding-alt":case"mso-padding-top-alt":case"mso-padding-right-alt":case"mso-padding-bottom-alt":case"mso-padding-left-alt":case"mso-margin-alt":case"mso-margin-top-alt":case"mso-margin-right-alt":case"mso-margin-bottom-alt":case"mso-margin-left-alt":case"mso-table-layout-alt":case"mso-height":case"mso-width":case"mso-vertical-align-alt":if(!/<table/.test(aa)){S[V]=Q.replace(/^mso-|-alt$/g,"")+":"+O(X)}continue;case"horiz-align":S[V]="text-align:"+X;continue;case"vert-align":S[V]="vertical-align:"+X;continue;case"font-color":case"mso-foreground":S[V]="color:"+X;continue;case"mso-background":case"mso-highlight":S[V]="background:"+X;continue;case"mso-default-height":S[V]="min-height:"+O(X);continue;case"mso-default-width":S[V]="min-width:"+O(X);continue;case"mso-padding-between-alt":S[V]="border-collapse:separate;border-spacing:"+O(X);continue;case"text-line-through":if((X=="single")||(X=="double")){S[V]="text-decoration:line-through"}continue;case"mso-zero-height":if(X=="yes"){S[V]="display:none"}continue;case"margin":if(!/[1-9]/.test(T[1])){continue}}if(/^(mso|column|font-emph|lang|layout|line-break|list-image|nav|panose|punct|row|ruby|sep|size|src|tab-|table-border|text-(?:decor|trans)|top-bar|version|vnd|word-break)/.test(Q)){if(!/mso\-list/.test(Q)){continue}}S[V]=Q+":"+T[1]}}if(V>0){return aa+' style="'+S.join(";")+'"'}else{return aa}});P=P.replace(/([ ]+)<\/span>/ig,function(Q,R){return new Array(R.length+1).join("&nbsp;")+"</span>"});return P}return function(P){w=null;I="",A="",G="";if(N(P)){P=M(P)}return P.replace(/>[ \t\r\n]*</g,"><")}}();var s={text:"#text",comment:"#comment",cdata:"#cdata-section",fragment:"#document-fragment"};function J(N){var M;if(N&&N.tag=="p"){if(N.attributes["class"]=="MsoListParagraph"||/mso-list/.test(N.attributes.style)){M=1}else{var O=N.children[0];if(O&&O.tag=="span"&&/Wingdings/i.test(O.attributes.style)){M=1}}}return M}var w,t={decimal:/\d+/,"lower-roman":/^m{0,4}(cm|cd|d?c{0,3})(xc|xl|l?x{0,3})(ix|iv|v?i{0,3})$/,"upper-roman":/^M{0,4}(CM|CD|D?C{0,3})(XC|XL|L?X{0,3})(IX|IV|V?I{0,3})$/,"lower-alpha":/^\(?[a-z]+\)?$/,"upper-alpha":/^\(?[A-Z]+\)?$/},y={disc:/^[l\u00B7\u2002]/,circle:/^[\u006F\u00D8]/,square:/^[\u006E\u25C6]/},I="",A="",G;function v(S,T){if(S.type=="element"&&!S.children.length&&(a.$removeEmpty[S.tag])&&S.tag!="a"){return{type:"fragment",children:[]}}var W=[0,10,12,16,18,24,32,48],V,Y=n.indexOf;switch(S.tag){case"img":if(S.attributes.src&&/^data:/.test(S.attributes.src)){return{type:"fragment",children:[]}}if(S.attributes.src&&/^(?:file)/.test(S.attributes.src)){if(!/(gif|bmp|png|jpg|jpeg)$/.test(S.attributes.src)){return{type:"fragment",children:[]}}S.attributes.word_img=S.attributes.src;S.attributes.src=L.options.UEDITOR_HOME_URL+"themes/default/images/spacer.gif";var X=parseInt(S.attributes.width)<128||parseInt(S.attributes.height)<43;S.attributes.style="background:url("+L.options.UEDITOR_HOME_URL+"themes/default/images/"+(X?"word.gif":"localimage.png")+") no-repeat center center;border:1px solid #ddd";T&&(T.flag=1)}if(i.ie&&i.version<7&&L.options.relativePath){S.attributes.orgSrc=S.attributes.src}S.attributes.data_ue_src=S.attributes.data_ue_src||S.attributes.src;break;case"li":var P=S.children[0];if(!P||P.type!="element"||P.tag!="p"&&a.p[P.tag]){var R={type:"element",tag:"p",attributes:{},parent:S};R.children=P?S.children:[i.ie?{type:"text",data:e.fillChar,parent:R}:{type:"element",tag:"br",attributes:{},closed:true,children:[],parent:R}];S.children=[R]}break;case"table":case"td":q(S);break;case"a":if(S.attributes.anchorname){S.tag="img";S.attributes={"class":"anchorclass",anchorname:S.attributes.name};S.closed=1}S.attributes.href&&(S.attributes.data_ue_src=S.attributes.href);break;case"b":S.tag=S.name="strong";break;case"i":S.tag=S.name="em";break;case"u":S.tag=S.name="span";S.attributes.style=(S.attributes.style||"")+";text-decoration:underline;";break;case"s":case"del":S.tag=S.name="span";S.attributes.style=(S.attributes.style||"")+";text-decoration:line-through;";if(S.children.length==1){P=S.children[0];if(P.tag==S.tag){S.attributes.style+=";"+P.attributes.style;S.children=P.children}}break;case"span":if(/mso-list/.test(S.attributes.style)){if(G!="end"){var ab=S.children[0],O;while(ab.type=="element"){ab=ab.children[0]}for(O in y){if(y[O].test(ab.data)){I="ul";A=O;break}}if(!I){for(O in t){if(t[O].test(ab.data.replace(/\.$/,""))){I="ol";A=O;break}}}if(G){if(ab.data==G){if(I!="ul"){A=""}I="ul"}else{if(I!="ol"){A=""}I="ol"}G="end"}else{G=ab.data}if(I){var Q=S;while(Q&&Q.tag!="ul"&&Q.tag!="ol"){Q=Q.parent}if(Q){Q.tag=I;Q.attributes.style="list-style-type:"+A}}}S={type:"fragment",children:[]};break}var N=S.attributes.style;if(N){N=N.match(/(?:\b(?:color|font-size|background(-color)?|font-family|text-decoration)\b\s*:\s*(&[^;]+;|[^;])+(?=;)?)/gi);if(N){S.attributes.style=N.join(";");if(!S.attributes.style){delete S.attributes.style}}}if(i.gecko&&i.version<=10902&&S.parent){var aa=S.parent;if(aa.tag=="span"&&aa.attributes&&aa.attributes.style){S.attributes.style=aa.attributes.style+";"+S.attributes.style}}if(n.isEmptyObject(S.attributes)){S.type="fragment"}break;case"font":S.tag=S.name="span";V=S.attributes;S.attributes={style:(V.size?"font-size:"+(W[V.size]||12)+"px":"")+";"+(V.color?"color:"+V.color:"")+";"+(V.face?"font-family:"+V.face:"")+";"+(V.style||"")};while(S.parent.tag==S.tag&&S.parent.children.length==1){S.attributes.style&&(S.parent.attributes.style?(S.parent.attributes.style+=";"+S.attributes.style):(S.parent.attributes.style=S.attributes.style));S.parent.children=S.children;S=S.parent}break;case"p":if(S.attributes.align){S.attributes.style=(S.attributes.style||"")+";text-align:"+S.attributes.align+";";delete S.attributes.align}if(J(S)){if(!w){var M={type:"element",tag:"ul",attributes:{},children:[]},U=Y(S.parent.children,S);S.parent.children[U]=M;M.parent=S.parent;M.children[0]=S;S.parent=M;while(1){S=M.parent.children[U+1];if(J(S)){M.children[M.children.length]=S;S.parent=M;M.parent.children.splice(U+1,1)}else{break}}return M}S.tag=S.name="li";if(i.webkit){var Z=S.children[0];while(Z&&Z.type=="element"){Z=Z.children[0]}Z&&(Z.parent.attributes.style=(Z.parent.attributes.style||"")+";mso-list:10")}delete S.attributes["class"];delete S.attributes.style}}return S}function q(N){if(E&&N.attributes.style){var M=N.attributes.style;N.attributes.style=M.replace(/;\s*/g,";");N.attributes.style=N.attributes.style.replace(/^\s*|\s*$/,"")}}function C(M){switch(M.tag){case"table":!M.attributes.style&&delete M.attributes.style;if(E&&M.attributes.style){q(M)}break;case"td":case"th":if(/display\s*:\s*none/i.test(M.attributes.style)){return{type:"fragment",children:[]}}if(E&&!M.children.length){var N={type:"text",data:e.fillChar,parent:M};M.children[0]=N}if(E&&M.attributes.style){q(M)}break;case"img":if(M.attributes.anchorname){M.tag="a";M.attributes={name:M.attributes.anchorname,anchorname:1};M.closed=null}else{if(M.attributes.data_ue_src){M.attributes.src=M.attributes.data_ue_src;delete M.attributes.data_ue_src}}break;case"a":if(M.attributes.data_ue_src){M.attributes.href=M.attributes.data_ue_src;delete M.attributes.data_ue_src}}return M}function r(S,R,M){if(!S.children||!S.children.length){return S}var Q=S.children;for(var P=0;P<Q.length;P++){var O=R(Q[P],M);if(O.type=="fragment"){var N=[P,1];N.push.apply(N,O.children);Q.splice.apply(Q,N);if(!Q.length){S={type:"fragment",children:[]}}P--}else{Q[P]=O}}return S}function H(M){this.rules=M}H.prototype={rules:null,filter:function(O,R,Q){R=R||this.rules;var N=R&&R.whiteList;var M=R&&R.blackList;function P(W,V){W.name=W.type=="element"?W.tag:s[W.type];if(V==null){return r(W,P,W)}if(M&&M[W.name]){Q&&(Q.flag=1);return{type:"fragment",children:[]}}if(N){if(W.type=="element"){if(V.type=="fragment"?N[W.name]:N[W.name]&&N[V.name][W.name]){var U;if((U=N[W.name].$)){var X=W.attributes;var T={};for(var S in U){if(X[S]){T[S]=X[S]}}W.attributes=T}}else{Q&&(Q.flag=1);W.type="fragment";W.name=V.name}}else{}}if(M||N){r(W,P,W)}return W}return P(O,null)},transformInput:function(N,M){function O(P){P=v(P,M);if(P.tag=="ol"||P.tag=="ul"){w=1}P=r(P,O,P);if(P.tag=="ol"||P.tag=="ul"){w=0;I="",A="",G=""}if(P.type=="text"&&P.data.replace(/\s/g,"")==L.options.pageBreakTag){P.type="element";P.name=P.tag="hr";delete P.data;P.attributes={"class":"pagebreak",noshade:"noshade",size:"5",unselectable:"on",style:"moz-user-select:none;-khtml-user-select: none;"};P.children=[]}if(P.type=="text"&&!a.$notTransContent[P.parent.tag]){P.data=P.data.replace(/[\r\t\n]*/g,"")}return P}return O(N)},transformOutput:function(M){function N(O){if(O.tag=="hr"&&O.attributes["class"]=="pagebreak"){delete O.tag;O.type="text";O.data=L.options.pageBreakTag;delete O.children}O=C(O);if(O.tag=="ol"||O.tag=="ul"){w=1}O=r(O,N,O);if(O.tag=="ol"||O.tag=="ul"){w=0}return O}return N(M)},toHTML:D,parseHTML:F,word:z};L.serialize=new H(L.options.serialize);UE.serialize=new H({})};(function(){function q(v){var t=this.document;if(t.getElementById("baidu_pastebin")){return}var s=this.selection.getRange(),r=s.createBookmark(),u=t.createElement("div");u.id="baidu_pastebin";i.webkit&&u.appendChild(t.createTextNode(e.fillChar+e.fillChar));t.body.appendChild(u);r.start.style.display="";u.style.cssText="position:absolute;width:1px;height:1px;overflow:hidden;left:-1000px;white-space:nowrap;top:"+e.getXY(r.start).y+"px";s.selectNodeContents(u).select(true);setTimeout(function(){if(i.webkit){for(var w=0,x=t.querySelectorAll("#baidu_pastebin"),z;z=x[w++];){if(e.isEmptyNode(z)){e.remove(z)}else{u=z;break}}}try{u.parentNode.removeChild(u)}catch(y){}s.moveToBookmark(r).select(true);v(u)},0)}UE.plugins.paste=function(){var v=this;var u={flag:""};var t=v.options.pasteplain;var r={flag:""};v.commands.pasteplain={queryCommandState:function(){return t},execCommand:function(){t=!t|0},notNeedUndo:1};function s(F){var E;if(F.firstChild){var I=e.getElementsByTagName(F,"span");for(var L=0,z;z=I[L++];){if(z.id=="_baidu_cut_start"||z.id=="_baidu_cut_end"){e.remove(z)}}if(i.webkit){var G=F.querySelectorAll("div br");for(var L=0,x;x=G[L++];){var D=x.parentNode;if(D.tagName=="DIV"&&D.childNodes.length==1){D.innerHTML="<p><br/></p>";e.remove(D)}}var K=F.querySelectorAll("#baidu_pastebin");for(var L=0,M;M=K[L++];){var P=v.document.createElement("p");M.parentNode.insertBefore(P,M);while(M.firstChild){P.appendChild(M.firstChild)}e.remove(M)}var w=F.querySelectorAll("meta");for(var L=0,C;C=w[L++];){e.remove(C)}var G=F.querySelectorAll("br");for(L=0;C=G[L++];){if(/^apple-/.test(C)){e.remove(C)}}}if(i.gecko){var H=F.querySelectorAll("[_moz_dirty]");for(L=0;C=H[L++];){C.removeAttribute("_moz_dirty")}}if(!i.ie){var B=F.querySelectorAll("span.apple-style-span");for(var L=0,C;C=B[L++];){e.remove(C,true)}}E=F.innerHTML;var N=v.serialize;if(N){try{var J=N.transformInput(N.parseHTML(N.word(E)),u);J=N.filter(J,t?{whiteList:{p:{br:1,BR:1},br:{"$":{}},div:{br:1,BR:1,"$":{}},li:{"$":{}},tr:{td:1,"$":{}},td:{"$":{}}},blackList:{style:1,script:1,object:1}}:null,!t?r:null);if(i.webkit){var y=J.children.length,A;while((A=J.children[y-1])&&A.tag=="br"){J.children.splice(y-1,1);y=J.children.length}}E=N.toHTML(J,t)}catch(O){}}E={html:E};v.fireEvent("beforepaste",E);v.execCommand("insertHtml",E.html);v.fireEvent("afterpaste")}}v.addListener("ready",function(){e.on(v.body,"cut",function(){var w=v.selection.getRange();if(!w.collapsed&&v.undoManger){v.undoManger.save()}});e.on(v.body,i.ie?"keydown":"paste",function(w){if(i.ie&&(!w.ctrlKey||w.keyCode!="86")){return}q.call(v,function(y){s(y);function x(){v.ui.hideToolbarMsg();v.removeListener("selectionchange",x)}if(r.flag&&v.ui){v.ui.showToolbarMsg(v.options.messages.pasteMsg,u.flag);r.flag="";setTimeout(function(){v.addListener("selectionchange",x)},100)}if(u.flag&&!v.queryCommandState("pasteplain")&&v.ui){v.ui.showToolbarMsg(v.options.messages.pasteWordImgMsg,true);u.flag="";setTimeout(function(){v.addListener("selectionchange",x)},100)}})})})}})();UE.plugins.contextmenu=function(){var s=this,t,q=s.options.contextMenu;if(!q||q.length==0){return}var r=UE.ui.uiUtils;s.addListener("contextmenu",function(A,C){var w=r.getViewportOffsetByEvent(C);s.fireEvent("beforeselectionchange");if(t){t.destroy()}for(var x=0,u,D=[];u=q[x];x++){var B;(function(H){if(H=="-"){if((B=D[D.length-1])&&B!=="-"){D.push("-")}}else{if(H.group){for(var G=0,F,E=[];F=H.subMenu[G];G++){(function(I){if(I=="-"){if((B=E[E.length-1])&&B!=="-"){E.push("-")}}else{if(s.queryCommandState(I.cmdName)!=-1){E.push({label:I.label,className:"edui-for-"+I.cmdName+(I.value||""),onclick:I.exec?function(){I.exec.call(s)}:function(){s.execCommand(I.cmdName,I.value)}})}}})(F)}if(E.length){D.push({label:H.group,className:"edui-for-"+H.icon,subMenu:{items:E,editor:s}})}}else{if(s.queryCommandState(H.cmdName)!=-1){if(H.cmdName=="highlightcode"&&s.queryCommandState(H.cmdName)==0){return}D.push({label:H.label,className:"edui-for-"+(H.icon?H.icon:H.cmdName+(H.value||"")),onclick:H.exec?function(){H.exec.call(s)}:function(){s.execCommand(H.cmdName,H.value)}})}}}})(u)}if(D[D.length-1]=="-"){D.pop()}t=new UE.ui.Menu({items:D,editor:s});t.render();t.showAt(w);e.preventDefault(C);if(i.ie){var v;try{v=s.selection.getNative().createRange()}catch(z){return}if(v.item){var y=new g.Range(s.document);y.selectNode(v.item(0)).select(true,true)}}})};UE.plugins.autoheight=function(){var t=this;t.autoHeightEnabled=t.options.autoHeightEnabled;if(!t.autoHeightEnabled){return}var q,s,r,u=0,v,x;function w(){clearTimeout(x);x=setTimeout(function(){if(t.queryCommandState("source")!=1){if(!s){s=t.document.createElement("span");s.style.cssText="display:block;width:0;margin:0;padding:0;border:0;clear:both;";s.innerHTML="."}r=s.cloneNode(true);t.body.appendChild(r);v=Math.max(e.getXY(r).y+r.offsetHeight,t.options.minFrameHeight);if(v!=u){t.setHeight(v);u=v}e.remove(r)}},50)}t.addListener("destroy",function(){t.removeListener("contentchange",w);t.removeListener("keyup",w);t.removeListener("mouseup",w)});t.enableAutoHeight=function(){if(!t.autoHeightEnabled){return}var y=t.document;t.autoHeightEnabled=true;q=y.body.style.overflowY;y.body.style.overflowY="hidden";t.addListener("contentchange",w);t.addListener("keyup",w);t.addListener("mouseup",w);setTimeout(function(){w()},i.gecko?100:0);t.fireEvent("autoheightchanged",t.autoHeightEnabled)};t.disableAutoHeight=function(){t.body.style.overflowY=q||"";t.removeListener("contentchange",w);t.removeListener("keyup",w);t.removeListener("mouseup",w);t.autoHeightEnabled=false;t.fireEvent("autoheightchanged",t.autoHeightEnabled)};t.addListener("ready",function(){t.enableAutoHeight();var y;e.on(i.ie?t.body:t.document,i.webkit?"dragover":"drop",function(){clearTimeout(y);y=setTimeout(function(){w()},100)})})};UE.plugins.autofloat=function(){var u,v=i.ie&&i.version<=6,x=i.quirks;function z(H){if(!H.ui){alert("autofloatUEditor UI\nautofloat: _src/plugins/autofloat.js");throw ({name:"UI",message:"autofloatUEditor UIautofloat: _src/plugins/autofloat.js"})}u=UE.ui.uiUtils;return 1}function C(){var H=document.body.style;H.backgroundImage='url("about:blank")';H.backgroundAttachment="fixed"}var s=this.options.autoFloatEnabled;if(!s){return}var y=this,D,A=document.createElement("div"),B,r,G,w=true;function F(){var I=e.getXY(B),H=e.getComputedStyle(B,"position"),J=e.getComputedStyle(B,"left");B.style.width=B.offsetWidth+"px";B.style.zIndex=y.options.zIndex*1+1;B.parentNode.insertBefore(A,B);if(v||x){if(B.style.position!="absolute"){B.style.position="absolute"}B.style.top=(document.body.scrollTop||document.documentElement.scrollTop)-r+"px"}else{if(i.ie7Compat&&w){w=false;B.style.left=G(B).left-document.documentElement.getBoundingClientRect().left+2+"px"}if(B.style.position!="fixed"){B.style.position="fixed";B.style.top="0";((H=="absolute"||H=="relative")&&parseFloat(J))&&(B.style.left=I.x+"px")}}}function t(){w=true;if(A.parentNode){A.parentNode.removeChild(A)}B.style.cssText=D}function E(){var H=G(y.container);if(H.top<0&&H.bottom-B.offsetHeight>0){F()}else{t()}}var q=n.defer(function(){E()},i.ie?200:100,true);y.addListener("destroy",function(){e.un(window,["scroll","resize"],E);y.removeListener("keydown",q)});y.addListener("ready",function(){if(z(y)){G=u.getClientRect;B=y.ui.getDom("toolbarbox");r=G(B).top;D=B.style.cssText;A.style.height=B.offsetHeight+"px";if(v){C()}y.addListener("autoheightchanged",function(I,H){if(H){e.on(window,["scroll","resize"],E);y.addListener("keydown",q)}else{e.un(window,["scroll","resize"],E);y.removeListener("keydown",q)}});y.addListener("beforefullscreenchange",function(I,H){if(H){t()}});y.addListener("fullscreenchanged",function(I,H){if(!H){E()}});y.addListener("sourcemodechanged",function(I,H){setTimeout(function(){E()})})}})};UE.plugins.elementpath=function(){var s,q,r=this;r.commands.elementpath={execCommand:function(B,u){var w=q[u],z=r.selection.getRange();r.currentSelectedArr&&e.clearSelectedArr(r.currentSelectedArr);s=u*1;if(a.$tableContent[w.tagName]){switch(w.tagName){case"TD":r.currentSelectedArr=[w];w.className=r.options.selectedTdClass;break;case"TR":var C=w.cells;for(var y=0,v;v=C[y++];){r.currentSelectedArr.push(v);v.className=r.options.selectedTdClass}break;case"TABLE":case"TBODY":var D=w.rows;for(var y=0,A;A=D[y++];){C=A.cells;for(var x=0,t;t=C[x++];){r.currentSelectedArr.push(t);t.className=r.options.selectedTdClass}}}w=r.currentSelectedArr[0];if(e.isEmptyNode(w)){z.setStart(w,0).setCursor()}else{z.selectNodeContents(w).select()}}else{z.selectNode(w).select()}},queryCommandValue:function(){var u=[].concat(this.selection.getStartElementPath()).reverse(),x=[];q=u;for(var w=0,v;v=u[w];w++){if(v.nodeType==3){continue}var t=v.tagName.toLowerCase();if(t=="img"&&v.getAttribute("anchorname")){t="anchor"}x[w]=t;if(s==w){s=-1;break}}return x}}};UE.commands.wordcount={queryCommandValue:function(u,v){var r,q,s;if(v){s=new RegExp("[\r\t\n]","g");q=this.getContentTxt().replace(s,"");return q.length}var w=this.options.wordCount,y=this.options.maximumWords,t=this.options.messages.wordCountMsg,x=this.options.messages.wordOverFlowMsg;if(!w){return""}s=new RegExp("[\r\t\n]","g");q=this.getContentTxt().replace(s,"");r=q.length;if(y-r<0){return"<span style='color:red;direction: none'>"+x+"</span> "}t=t.replace("{#leave}",y-r>=0?y-r:0);t=t.replace("{#count}",r);return t}}})();